source,title,description,datamodel,"providing_technologies","security_domain",category,usecase,mitre,killchain,"detection_searches","investigative_searches","contextual_searches","support_searches",qualifiedSearch
"Splunk ES Content Update - Analytic Stories","Account Monitoring and Controls","A common attack technique is to leverage user accounts to gain unauthorized access to the target's network. This Analytic Story minimizes opportunities for attack by helping you actively manage creation/use/dormancy/deletion--the lifecycle of system and application accounts.",,"Active Directory | Linux | Microsoft Windows | Splunk Enterprise Security | macOS",,"Best Practices",,"Create Account | Initial Access | Persistence | Valid Accounts",,"ESCU - Detect Excessive Account Lockouts From Endpoint - Rule | ESCU - Detect Excessive User Account Lockouts - Rule | ESCU - Identify New User Accounts - Rule | ESCU - Short Lived Windows Accounts - Rule","ESCU - Get Authentication Logs For Endpoint | ESCU - Get Logon Rights Modifications For Endpoint | ESCU - Get Logon Rights Modifications For User | ESCU - Get Notable History | ESCU - Get Notable Info | ESCU - Get Risk Modifiers For Endpoint | ESCU - Get Risk Modifiers For User | ESCU - Get User Information from Identity Table",,"",
"Splunk ES Content Update - Analytic Stories","Apache Struts Vulnerability","Detect and investigate activities--such as unusually long `Content-Type` length suspicious java classes and web servers executing suspicious processes--consistent with attempts to exploit Apache Struts vulnerabilities.",,"Apache | Bluecoat | Bro | Carbon Black Response | CrowdStrike Falcon | Linux | Microsoft Windows | Palo Alto Firewall | Splunk Enterprise Security | Splunk Stream | Sysmon | Tanium | Ziften | macOS",,Vulnerability,,"Defense Evasion | Discovery | Execution | Exploitation of Vulnerability | System Information Discovery","Actions on Objectives | Delivery | Exploitation","ESCU - Suspicious Java Classes - Rule | ESCU - Unusually Long Content-Type Length - Rule | ESCU - Web Servers Executing Suspicious Processes - Rule","ESCU - Get Authentication Logs For Endpoint | ESCU - Get Notable History | ESCU - Get Notable Info | ESCU - Get Risk Modifiers For Endpoint | ESCU - Get Risk Modifiers For User | ESCU - Get User Information from Identity Table | ESCU - Investigate Suspicious Strings in HTTP Header | ESCU - Investigate Web POSTs From src",,"",
"Splunk ES Content Update - Analytic Stories","Asset Tracking","Keep a careful inventory of every asset on your network to make it easier to detect rogue devices. Unauthorized/unmanaged devices could be an indication of malicious behavior that should be investigated further.",,"Bro | Microsoft Windows | Splunk Enterprise Security | Splunk Stream",,"Best Practices",,"Defense Evasion","Actions on Objectives | Delivery | Reconnaissance","ESCU - Detect Unauthorized Assets by MAC address - Rule","ESCU - Get First Occurrence and Last Occurrence of a MAC Address | ESCU - Get Notable History | ESCU - Get Notable Info",,"ESCU - Count of assets by category",
"Splunk ES Content Update - Analytic Stories","AWS Cross Account Activity","Track when a user assumes an IAM role in another AWS account to obtain cross-account access to services and resources in that account. Accessing new roles could be an indication of malicious activity.",,"AWS | Splunk Enterprise Security",,"Cloud Security",,"Credential Access","Actions on Objectives","ESCU - AWS Cross Account Activity From Previously Unseen Account - Rule","ESCU - AWS Investigate User Activities By AccessKeyId | ESCU - AWS Investigate User Activities By Source User | ESCU - Get Notable History",,"ESCU - Previously Seen AWS Cross Account Activity",
"Splunk ES Content Update - Analytic Stories","AWS Cryptomining","Monitor your AWS EC2 instances for activities related to cryptojacking/cryptomining. New instances that originate from previously unseen regions users who launch abnormally high numbers of instances or EC2 instances started by previously unseen users are just a few examples of potentially malicious behavior.",,"AWS | Splunk Enterprise Security",,"Cloud Security",,"Defense Evasion | Execution","Actions on Objectives","ESCU - Abnormally High AWS Instances Launched by User - Rule | ESCU - EC2 Instance Started In Previously Unseen Region - Rule | ESCU - EC2 Instance Started With Previously Unseen AMI - Rule | ESCU - EC2 Instance Started With Previously Unseen Instance Type - Rule | ESCU - EC2 Instance Started With Previously Unseen User - Rule","ESCU - AWS Investigate User Activities By ARN | ESCU - Get EC2 Instance Details by instanceId | ESCU - Get EC2 Launch Details | ESCU - Get Notable History | ESCU - Get Notable Info | ESCU - Get User Information from Identity Table | ESCU - Investigate AWS activities via region name",,"ESCU - Previously Seen AWS Regions | ESCU - Previously Seen EC2 AMIs | ESCU - Previously Seen EC2 Instance Types | ESCU - Previously Seen EC2 Launches By User",
"Splunk ES Content Update - Analytic Stories","AWS Network ACL Activity","Monitor your AWS network infrastructure for bad configurations and malicious activity. Investigative searches help you probe deeper when the facts warrant it.",,"AWS | Bluecoat | Bro | Carbon Black Response | CrowdStrike Falcon | Linux | Microsoft Windows | Palo Alto Firewall | Splunk Enterprise Security | Splunk Stream | Sysmon | Tanium | Ziften | macOS",,"Cloud Security",,"Command and Control | Exfiltration | Persistence","Actions on Objectives | Command and Control","ESCU - AWS Network Access Control List Created with All Open Ports - Rule | ESCU - AWS Network Access Control List Deleted - Rule | ESCU - Detect Spike in Network ACL Activity - Rule | ESCU - Detect Spike in blocked Outbound Traffic from your AWS - Rule","ESCU - AWS Investigate User Activities By ARN | ESCU - AWS Network ACL Details from ID | ESCU - AWS Network Interface details via resourceId | ESCU - Get All AWS Activity From IP Address | ESCU - Get Authentication Logs For Endpoint | ESCU - Get DNS Server History for a host | ESCU - Get DNS traffic ratio | ESCU - Get Notable History | ESCU - Get Notable Info | ESCU - Get Process Info | ESCU - Get Process Information For Port Activity | ESCU - Get Process Responsible For The DNS Traffic | ESCU - Get Risk Modifiers For Endpoint | ESCU - Get Risk Modifiers For User | ESCU - Get User Information from Identity Table",,"ESCU - Baseline of Network ACL Activity by ARN | ESCU - Baseline of blocked outbound traffic from AWS",
"Splunk ES Content Update - Analytic Stories","AWS Suspicious Provisioning Activities","Monitor your AWS provisioning activities for behaviors originating from unfamiliar or unusual locations. These behaviors may indicate that malicious activities are occurring somewhere within your network.",,AWS,,"Cloud Security",,,,"ESCU - AWS Cloud Provisioning From Previously Unseen City - Rule | ESCU - AWS Cloud Provisioning From Previously Unseen Country - Rule | ESCU - AWS Cloud Provisioning From Previously Unseen IP Address - Rule | ESCU - AWS Cloud Provisioning From Previously Unseen Region - Rule","ESCU - Get All AWS Activity From City | ESCU - Get All AWS Activity From Country | ESCU - Get All AWS Activity From IP Address | ESCU - Get All AWS Activity From Region",,"ESCU - Previously Seen AWS Provisioning Activity Sources",
"Splunk ES Content Update - Analytic Stories","AWS User Monitoring","Detect and investigate dormant user accounts for your AWS environment that have become active again. Because inactive and ad-hoc accounts are common attack targets it's critical to enable governance within your environment.",,"AWS | Splunk Enterprise Security",,"Cloud Security",,"Credential Access | Execution","Actions on Objectives","ESCU - Detect API activity from users without MFA - Rule | ESCU - Detect AWS API Activities From Unapproved Accounts - Rule | ESCU - Detect Spike in AWS API Activity - Rule | ESCU - Detect Spike in Security Group Activity - Rule | ESCU - Detect new API calls from user roles - Rule","ESCU - Get Notable History | ESCU - Get Notable Info | ESCU - Investigate AWS User Activities by user field",,"ESCU - Baseline of API Calls per User ARN | ESCU - Baseline of Security Group Activity by ARN | ESCU - Create a list of approved AWS service accounts | ESCU - Previously seen API call per user roles in CloudTrail",
"Splunk ES Content Update - Analytic Stories","Brand Monitoring","Detect and investigate activity that may indicate that an adversary is using faux domains to mislead users into interacting with malicious infrastructure. Monitor DNS email and web traffic for permutations of your brand name.",,"Bluecoat | Bro | Carbon Black Response | CrowdStrike Falcon | Linux | Microsoft Exchange | Microsoft Windows | Palo Alto Firewall | Splunk Enterprise | Splunk Enterprise Security | Splunk Stream | Sysmon | Tanium | Ziften | macOS",,Abuse,,,"Actions on Objectives | Delivery","ESCU - Monitor DNS For Brand Abuse - Rule | ESCU - Monitor Email For Brand Abuse - Rule | ESCU - Monitor Web Traffic For Brand Abuse - Rule","ESCU - Get Authentication Logs For Endpoint | ESCU - Get Email Info | ESCU - Get Emails From Specific Sender | ESCU - Get Notable History | ESCU - Get Notable Info | ESCU - Get Process Responsible For The DNS Traffic | ESCU - Get Risk Modifiers For Endpoint | ESCU - Get Risk Modifiers For User | ESCU - Get User Information from Identity Table | ESCU - Investigate Web Activity From Host",,"ESCU - DNSTwist Domain Names",
"Splunk ES Content Update - Analytic Stories","Cloud Cryptomining","Monitor your cloud compute instances for activities related to cryptojacking/cryptomining. New instances that originate from previously unseen regions users who launch abnormally high numbers of instances or compute instances started by previously unseen users are just a few examples of potentially malicious behavior.",,"AWS | Azure | GCP | Splunk Enterprise Security",,"Cloud Security",,"Defense Evasion | Execution","Actions on Objectives","ESCU - Abnormally High AWS Instances Launched by User - MLTK - Rule | ESCU - Cloud Compute Instance Created By Previously Unseen User - Rule | ESCU - Cloud Compute Instance Created With Previously Unseen Image - Rule | ESCU - Cloud Compute Instance Created With Previously Unseen Instance Type - Rule | ESCU - Cloud Compute Instance Started In Previously Unused Region - Rule","ESCU - AWS Investigate User Activities By ARN | ESCU - Get EC2 Instance Details by instanceId | ESCU - Get EC2 Launch Details | ESCU - Get Notable History | ESCU - Get Notable Info | ESCU - Get User Information from Identity Table | ESCU - Investigate AWS activities via region name | ESCU - Investigate Cloud Compute Instance Activities | ESCU - Investigate User Activities In All Cloud Regions | ESCU - Investigate User Activities In Single Cloud Region",,"ESCU - Baseline of Excessive AWS Instances Launched by User - MLTK | ESCU - Previously Seen Cloud Compute Creations By User | ESCU - Previously Seen Cloud Compute Images | ESCU - Previously Seen Cloud Compute Instance Types | ESCU - Previously Seen Cloud Regions",
"Splunk ES Content Update - Analytic Stories","ColdRoot MacOS RAT","Leverage searches that allow you to detect and investigate unusual activities that relate to the ColdRoot Remote Access Trojan that affects MacOS. An example of some of these activities are changing sensative binaries in the MacOS sub-system detecting process names and executables associated with the RAT detecting when a keyboard tab is installed on a MacOS machine and more.",,"Bluecoat | Bro | Linux | Microsoft Windows | Nessus | OSquery | Palo Alto Firewall | Splunk Enterprise Security | Splunk Stream | macOS",,Malware,,"Collection | Command and Control | Execution | Persistence","Command and Control | Installation","ESCU - Osquery pack - ColdRoot detection - Rule | ESCU - Processes Tapping Keyboard Events - Rule","ESCU - Get Authentication Logs For Endpoint | ESCU - Get Notable History | ESCU - Get Risk Modifiers For Endpoint | ESCU - Get Risk Modifiers For User | ESCU - Get User Information from Identity Table | ESCU - Get Vulnerability Logs For Endpoint | ESCU - Investigate Network Traffic From src_ip | ESCU - Investigate Web Activity From src_ip",,"",
"Splunk ES Content Update - Analytic Stories","Collection and Staging","Monitor for and investigate activities--such as suspicious writes to the Windows Recycling Bin or email servers sending high amounts of traffic to specific hosts for example--that may indicate that an adversary is harvesting and exfiltrating sensitive data.",,"Bro | Carbon Black Response | CrowdStrike Falcon | Linux | Microsoft Windows | Splunk Enterprise Security | Splunk Stream | Sysmon | Tanium | Ziften | macOS",,"Adversary Tactics",,"Collection | Commonly Used Port | Data Staged | Email Collection","Actions on Objectives","ESCU - Email files written outside of the Outlook directory - Rule | ESCU - Email servers sending high volume traffic to hosts - Rule | ESCU - Hosts receiving high volume of network traffic from email server - Rule | ESCU - Suspicious writes to System Volume Information - Rule | ESCU - Suspicious writes to windows Recycle Bin - Rule","ESCU - Get Authentication Logs For Endpoint | ESCU - Get Notable History | ESCU - Get Notable Info | ESCU - Get Parent Process Info | ESCU - Get Process Info | ESCU - Get Risk Modifiers For Endpoint | ESCU - Get Risk Modifiers For User | ESCU - Get User Information from Identity Table",,"",
"Splunk ES Content Update - Analytic Stories","Command and Control","Detect and investigate tactics techniques and procedures leveraged by attackers to establish and operate command and control channels. Implants installed by attackers on compromised endpoints use these channels to receive instructions and send data back to the malicious operators.",,"AWS | Bluecoat | Bro | Carbon Black Response | CrowdStrike Falcon | Linux | Microsoft Windows | Palo Alto Firewall | Splunk Enterprise Security | Splunk Stream | Sysmon | Tanium | Ziften | macOS",,"Adversary Tactics",,"Command and Control | Commonly Used Port | Defense Evasion | Exfiltration | Exfiltration Over Alternative Protocol | Standard Non-Application Layer Protocol","Actions on Objectives | Command and Control | Delivery","ESCU - Clients Connecting to Multiple DNS Servers - Rule | ESCU - DNS Query Length Outliers - MLTK - Rule | ESCU - DNS Query Length With High Standard Deviation - Rule | ESCU - DNS Query Requests Resolved by Unauthorized DNS Servers - Rule | ESCU - Detect Large Outbound ICMP Packets - Rule | ESCU - Detect Long DNS TXT Record Response - Rule | ESCU - Detect Spike in blocked Outbound Traffic from your AWS - Rule | ESCU - Detect hosts connecting to dynamic domain providers - Rule | ESCU - Detection of DNS Tunnels - Rule | ESCU - Excessive DNS Failures - Rule | ESCU - Prohibited Network Traffic Allowed - Rule | ESCU - Protocol or Port Mismatch - Rule | ESCU - TOR Traffic - Rule","ESCU - AWS Investigate User Activities By ARN | ESCU - AWS Network ACL Details from ID | ESCU - AWS Network Interface details via resourceId | ESCU - Get All AWS Activity From IP Address | ESCU - Get Authentication Logs For Endpoint | ESCU - Get DNS Server History for a host | ESCU - Get DNS traffic ratio | ESCU - Get Notable History | ESCU - Get Notable Info | ESCU - Get Parent Process Info | ESCU - Get Process Info | ESCU - Get Process Information For Port Activity | ESCU - Get Process Responsible For The DNS Traffic | ESCU - Get Risk Modifiers For Endpoint | ESCU - Get Risk Modifiers For User | ESCU - Get User Information from Identity Table",,"ESCU - Baseline of DNS Query Length - MLTK | ESCU - Baseline of blocked outbound traffic from AWS",
"Splunk ES Content Update - Analytic Stories","Common Phishing Frameworks","Detect DNS and web requests to fake websites generated by the EvilGinx2 toolkit. These websites are designed to fool unwitting users who have clicked on a malicious link in a phishing email.",,"Bro | Censys | Splunk Stream",,"Adversary Tactics",,"Command and Control | Spearphishing Link","Command and Control | Delivery","ESCU - Detect DNS requests to Phishing Sites leveraging EvilGinx2 - Rule","ESCU - Get Certificate logs for a domain",,"",
"Splunk ES Content Update - Analytic Stories","Container Implantation Monitoring & Investigation","Use the searches in this story to monitor your Kubernetes registry repositories for upload and deployment of potentially vulnerable backdoor or implanted containers. These searches provide information on source users destination path container names and repository names. The searches provide context to address Mitre T1525 which refers to container implantation upload to a company's repository either in Amazon Elastic Container Registry Google Container Registry and Azure Container Registry.",,"AWS | GCP",,"Cloud Security",,Persistence,,"ESCU - GCP GCR container uploaded - Rule | ESCU - New container uploaded to AWS ECR - Rule","ESCU - Investigate AWS ECR container listing activity",,"",
"Splunk ES Content Update - Analytic Stories","Credential Dumping","Uncover activity consistent with credential dumping a technique wherein attackers compromise systems and attempt to obtain and exfiltrate passwords. The threat actors use these pilfered credentials to further escalate privileges and spread throughout a target environment. The included searches in this Analytic Story are designed to identify attempts to credential dumping.",,"Carbon Black Response | CrowdStrike Falcon | Linux | Microsoft Windows | Sysmon | Tanium | Ziften | macOS",,"Adversary Tactics",,"Credential Access | Credential Dumping | Execution | PowerShell | Scripting","Actions on Objectives | Installation","ESCU - Access LSASS Memory for Dump Creation - Rule | ESCU - Attempt To Set Default PowerShell Execution Policy To Unrestricted or Bypass - Rule | ESCU - Attempted Credential Dump From Registry via Reg.exe - Rule | ESCU - Create Remote Thread into LSASS - Rule | ESCU - Creation of Shadow Copy - Rule | ESCU - Creation of Shadow Copy with wmic and powershell - Rule | ESCU - Credential Dumping via Copy Command from Shadow Copy - Rule | ESCU - Credential Dumping via Symlink to Shadow Copy - Rule | ESCU - Detect Credential Dumping through LSASS access - Rule | ESCU - Detect Mimikatz Using Loaded Images - Rule | ESCU - Dump LSASS via comsvcs DLL - Rule | ESCU - Unsigned Image Loaded by LSASS - Rule","ESCU - Investigate Failed Logins for Multiple Destinations | ESCU - Investigate Pass the Hash Attempts | ESCU - Investigate Pass the Ticket Attempts | ESCU - Investigate Previous Unseen User",,"",
"Splunk ES Content Update - Analytic Stories","Data Protection","Fortify your data-protection arsenal--while continuing to ensure data confidentiality and integrity--with searches that monitor for and help you investigate possible signs of data exfiltration.",,"Bro | Carbon Black Response | CrowdStrike Falcon | Linux | Microsoft Windows | Splunk Enterprise Security | Splunk Stream | Sysmon | Tanium | Ziften | macOS",,Abuse,,"Command and Control | Commonly Used Port | Defense Evasion | Exfiltration","Actions on Objectives | Command and Control | Installation","ESCU - Detect USB device insertion - Rule | ESCU - Detect hosts connecting to dynamic domain providers - Rule | ESCU - Detection of DNS Tunnels - Rule","ESCU - Get Authentication Logs For Endpoint | ESCU - Get DNS Server History for a host | ESCU - Get DNS traffic ratio | ESCU - Get Notable History | ESCU - Get Notable Info | ESCU - Get Process Info | ESCU - Get Process Responsible For The DNS Traffic | ESCU - Get Risk Modifiers For Endpoint | ESCU - Get Risk Modifiers For User | ESCU - Get User Information from Identity Table",,"",
"Splunk ES Content Update - Analytic Stories","DHS Report TA18-074A","Monitor for suspicious activities associated with DHS Technical Alert US-CERT TA18-074A. Some of the activities that adversaries used in these compromises included spearfishing attacks malware watering-hole domains many and more.",,"Bluecoat | Bro | Carbon Black Response | CrowdStrike Falcon | Linux | Microsoft Windows | Nessus | Palo Alto Firewall | Splunk Enterprise Security | Splunk Stream | Sysmon | Tanium | Ziften | macOS",,Malware,,"AppInit DLLs | Authentication Package | Command and Control | Command-Line Interface | Commonly Used Port | Credential Access | Defense Evasion | Disabling Security Tools | Execution | Lateral Movement | Modify Existing Service | Modify Registry | New Service | Persistence | PowerShell | Privilege Escalation | Registry Run Keys / Start Folder | Scheduled Task | Scripting | Valid Accounts","Actions on Objectives | Command and Control | Installation","ESCU - Create local admin accounts using net.exe - Rule | ESCU - Detect New Local Admin account - Rule | ESCU - Detect Outbound SMB Traffic - Rule | ESCU - Detect PsExec With accepteula Flag - Rule | ESCU - First time seen command line argument - Rule | ESCU - Malicious PowerShell Process - Execution Policy Bypass - Rule | ESCU - Processes launching netsh - Rule | ESCU - Registry Keys Used For Persistence - Rule | ESCU - SMB Traffic Spike - MLTK - Rule | ESCU - SMB Traffic Spike - Rule | ESCU - Sc.exe Manipulating Windows Services - Rule | ESCU - Scheduled Task Name Used by Dragonfly Threat Actors - Rule | ESCU - Single Letter Process On Endpoint - Rule | ESCU - Suspicious Reg.exe Process - Rule","ESCU - Get Authentication Logs For Endpoint | ESCU - Get Notable History | ESCU - Get Notable Info | ESCU - Get Parent Process Info | ESCU - Get Process File Activity | ESCU - Get Process Info | ESCU - Get Process Information For Port Activity | ESCU - Get Process Registry Activity | ESCU - Get Registry Activities | ESCU - Get Risk Modifiers For Endpoint | ESCU - Get Risk Modifiers For User | ESCU - Get User Information from Identity Table | ESCU - Get Vulnerability Logs For Endpoint | ESCU - Investigate Web Activity From Host",,"ESCU - Baseline of SMB Traffic - MLTK | ESCU - Previously seen command line arguments",
"Splunk ES Content Update - Analytic Stories","Disabling Security Tools","Looks for activities and techniques associated with the disabling of security tools on a Windows system such as suspicious `reg.exe` processes processes launching netsh and many others.",,"Bluecoat | Bro | Carbon Black Response | CrowdStrike Falcon | Linux | Microsoft Windows | Palo Alto Firewall | Splunk Enterprise Security | Splunk Stream | Sysmon | Tanium | Ziften | macOS",,"Adversary Tactics",,"Command-Line Interface | Defense Evasion | Disabling Security Tools | Execution | Modify Existing Service | Modify Registry | New Service | Persistence | Privilege Escalation","Actions on Objectives | Installation","ESCU - Attempt To Add Certificate To Untrusted Store - Rule | ESCU - Attempt To Stop Security Service - Rule | ESCU - Processes launching netsh - Rule | ESCU - Sc.exe Manipulating Windows Services - Rule | ESCU - Suspicious Reg.exe Process - Rule | ESCU - Unload Sysmon Filter Driver - Rule","ESCU - Get Authentication Logs For Endpoint | ESCU - Get Notable History | ESCU - Get Notable Info | ESCU - Get Parent Process Info | ESCU - Get Process Info | ESCU - Get Risk Modifiers For Endpoint | ESCU - Get Risk Modifiers For User | ESCU - Get User Information from Identity Table | ESCU - Investigate Web Activity From Host",,"ESCU - Baseline of SMB Traffic - MLTK | ESCU - Previously seen command line arguments",
"Splunk ES Content Update - Analytic Stories","DNS Amplification Attacks","DNS poses a serious threat as a Denial of Service (DOS) amplifier if it responds to `ANY` queries. This Analytic Story can help you detect attackers who may be abusing your company's DNS infrastructure to launch amplification attacks causing Denial of Service to other victims.",,"Bro | Splunk Enterprise Security | Splunk Stream",,Abuse,,,"Actions on Objectives","ESCU - Large Volume of DNS ANY Queries - Rule","ESCU - Get Notable History | ESCU - Get Notable Info | ESCU - Get Risk Modifiers For Endpoint | ESCU - Get Risk Modifiers For User",,"",
"Splunk ES Content Update - Analytic Stories","DNS Hijacking","Secure your environment against DNS hijacks with searches that help you detect and investigate unauthorized changes to DNS records.",,"Bro | Splunk Stream",,"Adversary Tactics",,"Command and Control | Defense Evasion | Exfiltration | Exfiltration Over Alternative Protocol","Actions on Objectives | Command and Control","ESCU - Clients Connecting to Multiple DNS Servers - Rule | ESCU - DNS Query Requests Resolved by Unauthorized DNS Servers - Rule | ESCU - DNS record changed - Rule | ESCU - Detect hosts connecting to dynamic domain providers - Rule","ESCU - Get DNS Server History for a host",,"ESCU - Discover DNS records",
"Splunk ES Content Update - Analytic Stories","Dynamic DNS","Detect and investigate hosts in your environment that may be communicating with dynamic domain providers. Attackers may leverage these services to help them avoid firewall blocks and blacklists.",,"Bluecoat | Bro | Carbon Black Response | CrowdStrike Falcon | Linux | Microsoft Windows | Palo Alto Firewall | Splunk Enterprise Security | Splunk Stream | Sysmon | Tanium | Ziften | macOS",,Malware,,"Command and Control | Defense Evasion | Exfiltration | Exfiltration Over Command and Control Channel | Web Service","Actions on Objectives | Command and Control","ESCU - Detect hosts connecting to dynamic domain providers - Rule | ESCU - Detect web traffic to dynamic domain providers - Rule","ESCU - Get Authentication Logs For Endpoint | ESCU - Get DNS Server History for a host | ESCU - Get DNS traffic ratio | ESCU - Get Notable History | ESCU - Get Notable Info | ESCU - Get Process Responsible For The DNS Traffic | ESCU - Get Risk Modifiers For Endpoint | ESCU - Get Risk Modifiers For User | ESCU - Get User Information from Identity Table | ESCU - Investigate Web Activity From src_ip",,"",
"Splunk ES Content Update - Analytic Stories","Emotet Malware (DHS Report TA18-201A)","Detect rarely used executables specific registry paths that may confer malware survivability and persistence instances where cmd.exe is used to launch script interpreters and other indicators that the Emotet financial malware has compromised your environment.",,"Bluecoat | Bro | Carbon Black Response | CrowdStrike Falcon | Cuckoo | DeepSight | Linux | Microsoft Exchange | Microsoft Windows | Nessus | Palo Alto Firewall | SMTP | Splunk Enterprise Security | Splunk Stream | Sysmon | Tanium | VirusTotal | Ziften | macOS",,Malware,,"Account Discovery | AppInit DLLs | Authentication Package | Command and Control | Command-Line Interface | Commonly Used Port | Defense Evasion | Discovery | Execution | Lateral Movement | Persistence | Registry Run Keys / Start Folder | Third-party Software","Actions on Objectives | Command and Control | Delivery | Exploitation | Installation","ESCU - Detect Rare Executables - Rule | ESCU - Detect Use of cmd.exe to Launch Script Interpreters - Rule | ESCU - Detection of tools built by NirSoft - Rule | ESCU - Email Attachments With Lots Of Spaces - Rule | ESCU - Prohibited Software On Endpoint - Rule | ESCU - Registry Keys Used For Persistence - Rule | ESCU - SMB Traffic Spike - MLTK - Rule | ESCU - SMB Traffic Spike - Rule | ESCU - Suspicious Email Attachment Extensions - Rule","ESCU - Get Authentication Logs For Endpoint | ESCU - Get Notable History | ESCU - Get Notable Info | ESCU - Get Parent Process Info | ESCU - Get Process Info | ESCU - Get Process Information For Port Activity | ESCU - Get Registry Activities | ESCU - Get Risk Modifiers For Endpoint | ESCU - Get Risk Modifiers For User | ESCU - Get Update Logs For Endpoint | ESCU - Get User Information from Identity Table | ESCU - Get Vulnerability Logs For Endpoint | ESCU - Investigate Web Activity From Host",,"ESCU - Add Prohibited Processes to Enterprise Security | ESCU - Baseline of SMB Traffic - MLTK",
"Splunk ES Content Update - Analytic Stories","Hidden Cobra Malware","Monitor for and investigate activities including the creation or deletion of hidden shares and file writes that may be evidence of infiltration by North Korean government-sponsored cybercriminals. Details of this activity were reported in DHS Report TA-18-149A.",,"Bluecoat | Bro | Carbon Black Response | CrowdStrike Falcon | Linux | Microsoft Windows | Nessus | Palo Alto Firewall | Splunk Enterprise Security | Splunk Stream | Sysmon | Tanium | Ziften | macOS",,Malware,,"Command and Control | Command-Line Interface | Commonly Used Port | Credential Access | Execution | Exfiltration | Lateral Movement | Persistence | Remote Desktop Protocol | Scripting","Actions on Objectives | Command and Control","ESCU - Create or delete windows shares using net.exe - Rule | ESCU - DNS Query Length Outliers - MLTK - Rule | ESCU - DNS Query Length With High Standard Deviation - Rule | ESCU - Detect Outbound SMB Traffic - Rule | ESCU - First time seen command line argument - Rule | ESCU - Remote Desktop Network Traffic - Rule | ESCU - Remote Desktop Process Running On System - Rule | ESCU - SMB Traffic Spike - MLTK - Rule | ESCU - SMB Traffic Spike - Rule | ESCU - Suspicious File Write - Rule","ESCU - Get Authentication Logs For Endpoint | ESCU - Get DNS Server History for a host | ESCU - Get DNS traffic ratio | ESCU - Get Notable History | ESCU - Get Notable Info | ESCU - Get Parent Process Info | ESCU - Get Process Info | ESCU - Get Process Information For Port Activity | ESCU - Get Process Responsible For The DNS Traffic | ESCU - Get Risk Modifiers For Endpoint | ESCU - Get Risk Modifiers For User | ESCU - Get User Information from Identity Table | ESCU - Get Vulnerability Logs For Endpoint | ESCU - Investigate Successful Remote Desktop Authentications | ESCU - Investigate Web Activity From Host",,"ESCU - Baseline of DNS Query Length - MLTK | ESCU - Baseline of SMB Traffic - MLTK | ESCU - Previously seen command line arguments",
"Splunk ES Content Update - Analytic Stories","Host Redirection","Detect evidence of tactics used to redirect traffic from a host to a destination other than the one intended--potentially one that is part of an adversary's attack infrastructure. An example is redirecting communications regarding patches and updates or misleading users into visiting a malicious website.",,"Bro | Carbon Black Response | CrowdStrike Falcon | Linux | Microsoft Windows | Splunk Enterprise Security | Splunk Stream | Sysmon | macOS",,Abuse,,"Command and Control | Defense Evasion | Exfiltration | Exfiltration Over Alternative Protocol","Command and Control","ESCU - Clients Connecting to Multiple DNS Servers - Rule | ESCU - DNS Query Requests Resolved by Unauthorized DNS Servers - Rule | ESCU - Windows hosts file modification - Rule","ESCU - Get Authentication Logs For Endpoint | ESCU - Get DNS Server History for a host | ESCU - Get Notable History | ESCU - Get Notable Info | ESCU - Get Risk Modifiers For Endpoint | ESCU - Get Risk Modifiers For User | ESCU - Get User Information from Identity Table",,"",
"Splunk ES Content Update - Analytic Stories","JBoss Vulnerability","In March of 2016 adversaries were seen using JexBoss--an open-source utility used for testing and exploiting JBoss application servers. These searches help detect evidence of these attacks such as network connections to external resources or web services spawning atypical child processes among others.",,"Apache | Bluecoat | Bro | Nessus | Palo Alto Firewall | Splunk Enterprise Security | Splunk Stream",,Vulnerability,,"Defense Evasion | Discovery | Exploitation of Vulnerability | System Information Discovery","Delivery | Reconnaissance","ESCU - Detect attackers scanning for vulnerable JBoss servers - Rule | ESCU - Detect malicious requests to exploit JBoss servers - Rule","ESCU - Get Notable History | ESCU - Get Notable Info | ESCU - Get Risk Modifiers For Endpoint | ESCU - Get Vulnerability Logs For Endpoint | ESCU - Investigate Web Activity From Host",,"",
"Splunk ES Content Update - Analytic Stories","Kubernetes Scanning Activity","This story addresses detection against Kubernetes cluster fingerprint scan and attack by providing information on items such as source ip user agent cluster names.",,"AWS | GCP | Splunk Enterprise Security",,"Cloud Security",,Discovery,Reconnaissance,"ESCU - Amazon EKS Kubernetes Pod scan detection - Rule | ESCU - Amazon EKS Kubernetes cluster scan detection - Rule | ESCU - GCP Kubernetes cluster scan detection - Rule","ESCU - Amazon EKS Kubernetes activity by src_ip | ESCU - GCP Kubernetes activity by src_ip | ESCU - Get Notable History | ESCU - Get Notable Info | ESCU - Get Risk Modifiers For Endpoint",,"",
"Splunk ES Content Update - Analytic Stories","Lateral Movement","This threat is generated when UBA detects activity from a user (or users) that looks like possible lateral movement in the network.",,"Anti-Virus or Anti-Malware | Network Communication | Email | Windows Security | Host-based IDS | IDS or IPS | Authentication | DLP",,"Lateral Movement","Advanced Threat Detection | Security Monitoring",None,None,"ESCU - Detect Activity Related to Pass the Hash Attacks - Rule | ESCU - Remote Desktop Network Traffic - Rule | ESCU - Remote Desktop Process Running On System - Rule | ESCU - Schtasks scheduling job on remote system - Rule","ESCU - Get Authentication Logs For Endpoint | ESCU - Get Notable History | ESCU - Get Notable Info | ESCU - Get Parent Process Info | ESCU - Get Process Info | ESCU - Get Process Information For Port Activity | ESCU - Get Risk Modifiers For Endpoint | ESCU - Get Risk Modifiers For User | ESCU - Get User Information from Identity Table | ESCU - Investigate Successful Remote Desktop Authentications",,"",
"Splunk ES Content Update - Analytic Stories","Malicious PowerShell","Attackers are finding stealthy ways ""live off the land"" leveraging utilities and tools that come standard on the endpoint--such as PowerShell--to achieve their goals without downloading binary files. These searches can help you detect and investigate PowerShell command-line options that may be indicative of malicious intent.",,"Carbon Black Response | CrowdStrike Falcon | Linux | Microsoft Windows | Splunk Enterprise Security | Sysmon | Tanium | Ziften | macOS",,"Adversary Tactics",,"Execution | PowerShell | Scripting","Actions on Objectives | Command and Control | Installation","ESCU - Attempt To Set Default PowerShell Execution Policy To Unrestricted or Bypass - Rule | ESCU - Malicious PowerShell Process - Connect To Internet With Hidden Window - Rule | ESCU - Malicious PowerShell Process - Encoded Command - Rule | ESCU - Malicious PowerShell Process - Multiple Suspicious Command-Line Arguments - Rule | ESCU - Malicious PowerShell Process With Obfuscation Techniques - Rule","ESCU - Get Authentication Logs For Endpoint | ESCU - Get Notable History | ESCU - Get Notable Info | ESCU - Get Parent Process Info | ESCU - Get Process Info | ESCU - Get Risk Modifiers For Endpoint | ESCU - Get Risk Modifiers For User | ESCU - Get User Information from Identity Table",,"",
"Splunk ES Content Update - Analytic Stories","Monitor Backup Solution","Address common concerns when monitoring your backup processes. These searches can help you reduce risks from ransomware device theft or denial of physical access to a host by backing up data on endpoints.",,"Netbackup | Splunk Enterprise Security",,"Best Practices",,,,"ESCU - Extended Period Without Successful Netbackup Backups - Rule | ESCU - Unsuccessful Netbackup backups - Rule","ESCU - All backup logs for host | ESCU - Get Notable History | ESCU - Get Risk Modifiers For Endpoint | ESCU - Get Risk Modifiers For User",,"ESCU - Monitor Successful Backups | ESCU - Monitor Unsuccessful Backups",
"Splunk ES Content Update - Analytic Stories","Monitor for Unauthorized Software","Identify and investigate prohibited/unauthorized software or processes that may be concealing malicious behavior within your environment.",,"Bluecoat | Bro | Carbon Black Response | CrowdStrike Falcon | Linux | Microsoft Windows | Nessus | Palo Alto Firewall | Splunk Enterprise Security | Splunk Stream | Sysmon | Tanium | Ziften | macOS",,"Best Practices",,Execution,"Actions on Objectives | Command and Control | Installation","ESCU - Prohibited Software On Endpoint - Rule","ESCU - Get Authentication Logs For Endpoint | ESCU - Get Notable History | ESCU - Get Notable Info | ESCU - Get Parent Process Info | ESCU - Get Process Info | ESCU - Get Risk Modifiers For Endpoint | ESCU - Get Risk Modifiers For User | ESCU - Get Update Logs For Endpoint | ESCU - Get User Information from Identity Table | ESCU - Get Vulnerability Logs For Endpoint | ESCU - Investigate Web Activity From Host",,"ESCU - Add Prohibited Processes to Enterprise Security",
"Splunk ES Content Update - Analytic Stories","Monitor for Updates","Monitor your enterprise to ensure that your endpoints are being patched and updated. Adversaries notoriously exploit known vulnerabilities that could be mitigated by applying routine security patches.",,"Microsoft Windows | Splunk Enterprise Security",,"Best Practices",,,,"ESCU - No Windows Updates in a time frame - Rule","ESCU - Get Notable History | ESCU - Get Notable Info | ESCU - Get Risk Modifiers For Endpoint",,"",
"Splunk ES Content Update - Analytic Stories","Netsh Abuse","Detect activities and various techniques associated with the abuse of `netsh.exe` which can disable local firewall settings or set up a remote connection to a host from an infected system.",,"Bluecoat | Bro | Carbon Black Response | CrowdStrike Falcon | Linux | Microsoft Windows | Palo Alto Firewall | Splunk Enterprise Security | Splunk Stream | Sysmon | Tanium | Ziften | macOS",,Abuse,,"Command-Line Interface | Defense Evasion | Disabling Security Tools | Execution | Persistence","Actions on Objectives","ESCU - Processes created by netsh - Rule | ESCU - Processes launching netsh - Rule","ESCU - Get Authentication Logs For Endpoint | ESCU - Get Notable History | ESCU - Get Notable Info | ESCU - Get Parent Process Info | ESCU - Get Process Info | ESCU - Get Risk Modifiers For Endpoint | ESCU - Get Risk Modifiers For User | ESCU - Get User Information from Identity Table | ESCU - Investigate Web Activity From Host",,"ESCU - Baseline of SMB Traffic - MLTK | ESCU - Previously seen command line arguments",
"Splunk ES Content Update - Analytic Stories","Orangeworm Attack Group","Detect activities and various techniques associated with the Orangeworm Attack Group a group that frequently targets the healthcare industry.",,"Bluecoat | Bro | Carbon Black Response | CrowdStrike Falcon | Linux | Microsoft Windows | Palo Alto Firewall | Splunk Enterprise Security | Splunk Stream | Sysmon | Tanium | Ziften | macOS",,Malware,,"Command-Line Interface | Defense Evasion | Disabling Security Tools | Execution | Modify Existing Service | New Service | Persistence | Privilege Escalation | Scripting","Actions on Objectives | Command and Control | Installation","ESCU - First Time Seen Running Windows Service - Rule | ESCU - First time seen command line argument - Rule | ESCU - Sc.exe Manipulating Windows Services - Rule","ESCU - Get Authentication Logs For Endpoint | ESCU - Get Notable History | ESCU - Get Notable Info | ESCU - Get Parent Process Info | ESCU - Get Process Info | ESCU - Get Risk Modifiers For Endpoint | ESCU - Get Risk Modifiers For User | ESCU - Get User Information from Identity Table | ESCU - Investigate Web Activity From Host",,"ESCU - Previously Seen Running Windows Services | ESCU - Previously seen command line arguments",
"Splunk ES Content Update - Analytic Stories","Phishing Payloads","Detect signs of malicious payloads that may indicate that your environment has been breached via a phishing attack.",,"Carbon Black Response | CrowdStrike Falcon | Sysmon | Tanium | Ziften",,"Adversary Tactics",,"Initial Access | Spearphishing Attachment","Actions on Objectives | Installation","ESCU - Detect Oulook.exe writing a .zip file - Rule | ESCU - Suspicious LNK file launching a process - Rule","ESCU - Get Parent Process Info",,"",
"Splunk ES Content Update - Analytic Stories","Possible Backdoor Activity Associated With MUDCARP Espionage Campaigns","Monitor your environment for suspicious behaviors that resemble the techniques employed by the MUDCARP threat group.",,"Bluecoat | Bro | Carbon Black Response | CrowdStrike Falcon | Linux | Microsoft Windows | Palo Alto Firewall | Splunk Enterprise Security | Splunk Stream | Sysmon | Tanium | Ziften | macOS",,"Adversary Tactics",,"AppInit DLLs | Authentication Package | Command-Line Interface | Execution | Persistence | PowerShell | Registry Run Keys / Start Folder | Scripting","Actions on Objectives | Command and Control","ESCU - First time seen command line argument - Rule | ESCU - Malicious PowerShell Process - Connect To Internet With Hidden Window - Rule | ESCU - Registry Keys Used For Persistence - Rule | ESCU - Unusually Long Command Line - MLTK - Rule | ESCU - Unusually Long Command Line - Rule","ESCU - Get Authentication Logs For Endpoint | ESCU - Get Notable History | ESCU - Get Notable Info | ESCU - Get Parent Process Info | ESCU - Get Process Info | ESCU - Get Registry Activities | ESCU - Get Risk Modifiers For Endpoint | ESCU - Get Risk Modifiers For User | ESCU - Get User Information from Identity Table | ESCU - Investigate Web Activity From Host",,"ESCU - Baseline of Command Line Length - MLTK | ESCU - Previously seen command line arguments",
"Splunk ES Content Update - Analytic Stories","Prohibited Traffic Allowed or Protocol Mismatch","Detect instances of prohibited network traffic allowed in the environment as well as protocols running on non-standard ports. Both of these types of behaviors typically violate policy and can be leveraged by attackers.",,"Bluecoat | Bro | Carbon Black Response | CrowdStrike Falcon | Linux | Microsoft Windows | Palo Alto Firewall | Splunk Enterprise Security | Splunk Stream | Sysmon | Tanium | Ziften | macOS",,"Best Practices",,"Command and Control | Commonly Used Port | Defense Evasion | Exfiltration | Exfiltration Over Alternative Protocol","Actions on Objectives | Command and Control | Delivery","ESCU - Detect hosts connecting to dynamic domain providers - Rule | ESCU - Prohibited Network Traffic Allowed - Rule | ESCU - Protocol or Port Mismatch - Rule | ESCU - TOR Traffic - Rule","ESCU - Get Authentication Logs For Endpoint | ESCU - Get DNS Server History for a host | ESCU - Get Notable History | ESCU - Get Notable Info | ESCU - Get Parent Process Info | ESCU - Get Process Info | ESCU - Get Process Information For Port Activity | ESCU - Get Risk Modifiers For Endpoint | ESCU - Get Risk Modifiers For User | ESCU - Get User Information from Identity Table",,"",
"Splunk ES Content Update - Analytic Stories",Ransomware,"Leverage searches that allow you to detect and investigate unusual activities that might relate to ransomware--spikes in SMB traffic suspicious wevtutil usage the presence of common ransomware extensions and system processes run from unexpected locations and many others.",,"Bluecoat | Bro | Carbon Black Response | CrowdStrike Falcon | Linux | Microsoft Windows | Nessus | Netbackup | Palo Alto Firewall | Splunk Enterprise Security | Splunk Stream | Sysmon | Tanium | Ziften | macOS",,Malware,,"AppInit DLLs | Authentication Package | Command and Control | Commonly Used Port | Defense Evasion | Execution | Exfiltration | Exfiltration Over Alternative Protocol | Impact | Indicator Removal on Host | Lateral Movement | Masquerading | Persistence | Registry Run Keys / Start Folder | Scheduled Task | Windows Management Instrumentation","Actions on Objectives | Command and Control | Delivery","ESCU - Common Ransomware Extensions - Rule | ESCU - Common Ransomware Notes - Rule | ESCU - Deleting Shadow Copies - Rule | ESCU - Prohibited Network Traffic Allowed - Rule | ESCU - Registry Keys Used For Persistence - Rule | ESCU - Remote Process Instantiation via WMI - Rule | ESCU - SMB Traffic Spike - MLTK - Rule | ESCU - SMB Traffic Spike - Rule | ESCU - Scheduled tasks used in BadRabbit ransomware - Rule | ESCU - Schtasks used for forcing a reboot - Rule | ESCU - Spike in File Writes - Rule | ESCU - Suspicious wevtutil Usage - Rule | ESCU - System Processes Run From Unexpected Locations - Rule | ESCU - TOR Traffic - Rule | ESCU - USN Journal Deletion - Rule | ESCU - Unusually Long Command Line - MLTK - Rule | ESCU - Unusually Long Command Line - Rule | ESCU - Windows Event Log Cleared - Rule","ESCU - Get Authentication Logs For Endpoint | ESCU - Get Backup Logs For Endpoint | ESCU - Get Notable History | ESCU - Get Notable Info | ESCU - Get Parent Process Info | ESCU - Get Process Info | ESCU - Get Process Information For Port Activity | ESCU - Get Registry Activities | ESCU - Get Risk Modifiers For Endpoint | ESCU - Get Risk Modifiers For User | ESCU - Get Sysmon WMI Activity for Host | ESCU - Get Update Logs For Endpoint | ESCU - Get User Information from Identity Table | ESCU - Get Vulnerability Logs For Endpoint | ESCU - Investigate Web Activity From Host",,"ESCU - Baseline of Command Line Length - MLTK | ESCU - Baseline of SMB Traffic - MLTK",
"Splunk ES Content Update - Analytic Stories","Router & Infrastructure Security","Validate the security configuration of network infrastructure and verify that only authorized users and systems are accessing critical assets. Core routing and switching infrastructure are common strategic targets for attackers.",,"Active Directory | Linux | Microsoft Windows | Palo Alto Firewall | Splunk Enterprise Security | macOS",,"Best Practices",,,"Actions on Objectives","ESCU - Detect New Login Attempts to Routers - Rule","ESCU - Get Authentication Logs For Endpoint | ESCU - Get Notable History | ESCU - Get Notable Info | ESCU - Get Risk Modifiers For Endpoint | ESCU - Get Risk Modifiers For User | ESCU - Get User Information from Identity Table",,"",
"Splunk ES Content Update - Analytic Stories","SamSam Ransomware","Leverage searches that allow you to detect and investigate unusual activities that might relate to the SamSam ransomware including looking for file writes associated with SamSam RDP brute force attacks the presence of files with SamSam ransomware extensions suspicious psexec use and more.",,"Apache | Bluecoat | Bro | Carbon Black Response | CrowdStrike Falcon | Linux | Microsoft Windows | Nessus | Netbackup | Palo Alto Firewall | Splunk Enterprise Security | Splunk Stream | Sysmon | Tanium | Ziften | macOS",,Malware,,"Command-Line Interface | Credential Access | Defense Evasion | Discovery | Execution | Exploitation of Vulnerability | Impact | Lateral Movement | Remote Desktop Protocol | System Information Discovery","Actions on Objectives | Command and Control | Delivery | Installation | Reconnaissance","ESCU - Batch File Write to System32 - Rule | ESCU - Common Ransomware Extensions - Rule | ESCU - Common Ransomware Notes - Rule | ESCU - Deleting Shadow Copies - Rule | ESCU - Detect PsExec With accepteula Flag - Rule | ESCU - Detect attackers scanning for vulnerable JBoss servers - Rule | ESCU - Detect malicious requests to exploit JBoss servers - Rule | ESCU - File with Samsam Extension - Rule | ESCU - Prohibited Software On Endpoint - Rule | ESCU - Remote Desktop Network Bruteforce - Rule | ESCU - Remote Desktop Network Traffic - Rule | ESCU - Samsam Test File Write - Rule | ESCU - Spike in File Writes - Rule","ESCU - Get Authentication Logs For Endpoint | ESCU - Get Backup Logs For Endpoint | ESCU - Get Notable History | ESCU - Get Notable Info | ESCU - Get Parent Process Info | ESCU - Get Process Info | ESCU - Get Process Information For Port Activity | ESCU - Get Risk Modifiers For Endpoint | ESCU - Get Risk Modifiers For User | ESCU - Get Update Logs For Endpoint | ESCU - Get User Information from Identity Table | ESCU - Get Vulnerability Logs For Endpoint | ESCU - Investigate Successful Remote Desktop Authentications | ESCU - Investigate Web Activity From Host",,"ESCU - Add Prohibited Processes to Enterprise Security",
"Splunk ES Content Update - Analytic Stories","Spectre And Meltdown Vulnerabilities","Assess and mitigate your systems' vulnerability to Spectre and Meltdown exploitation with the searches in this Analytic Story.",,"Carbon Black Response | CrowdStrike Falcon | Linux | Microsoft Windows | Nessus | Qualys | Splunk Enterprise Security | Sysmon | Tanium | Ziften | macOS",,Vulnerability,,,,"ESCU - Spectre and Meltdown Vulnerable Systems - Rule","ESCU - Get Authentication Logs For Endpoint | ESCU - Get Notable History | ESCU - Get Notable Info | ESCU - Get Risk Modifiers For Endpoint | ESCU - Get Risk Modifiers For User | ESCU - Get User Information from Identity Table",,"ESCU - Systems Ready for Spectre-Meltdown Windows Patch",
"Splunk ES Content Update - Analytic Stories","Splunk Enterprise Vulnerability","Keeping your Splunk deployment up to date is critical and may help you reduce the risk of CVE-2016-4859 an open-redirection vulnerability within some older versions of Splunk Enterprise. The detection search will help ensure that users are being properly authenticated and not being redirected to malicious domains.",,"Splunk Enterprise | Splunk Enterprise Security",,Vulnerability,,"Defense Evasion | Exploitation of Vulnerability",Delivery,"ESCU - Open Redirect in Splunk Web - Rule","ESCU - Get Notable History | ESCU - Get Notable Info | ESCU - Get Risk Modifiers For Endpoint",,"",
"Splunk ES Content Update - Analytic Stories","Splunk Enterprise Vulnerability CVE-2018-11409","Reduce the risk of CVE-2018-11409 an information disclosure vulnerability within some older versions of Splunk Enterprise with searches designed to help ensure that your Splunk system does not leak information to authenticated users.",,"Bluecoat | Bro | Palo Alto Firewall | Splunk Enterprise | Splunk Enterprise Security | Splunk Stream",,Vulnerability,,"Defense Evasion | Exploitation of Vulnerability",Delivery,"ESCU - Splunk Enterprise Information Disclosure - Rule","ESCU - Get Notable History | ESCU - Get Notable Info | ESCU - Get Risk Modifiers For Endpoint | ESCU - Investigate Network Traffic From src_ip | ESCU - Investigate Web Activity From src_ip",,"",
"Splunk ES Content Update - Analytic Stories","SQL Injection","Use the searches in this Analytic Story to help you detect structured query language (SQL) injection attempts characterized by long URLs that contain malicious parameters.",,"Bro | Linux | Microsoft Windows | Splunk Enterprise Security | Splunk Stream | macOS",,"Adversary Tactics",,"Commonly Used Port | Defense Evasion | Execution | Exploitation of Vulnerability",Delivery,"ESCU - SQL Injection with Long URLs - Rule","ESCU - Get Authentication Logs For Endpoint | ESCU - Get Notable History | ESCU - Get Notable Info | ESCU - Get Risk Modifiers For Endpoint",,"",
"Splunk ES Content Update - Analytic Stories","Suspicious AWS EC2 Activities","Use the searches in this Analytic Story to monitor your AWS EC2 instances for evidence of anomalous activity and suspicious behaviors such as EC2 instances that originate from unusual locations or those launched by previously unseen users (among others). Included investigative searches will help you probe more deeply when the information warrants it.",,"AWS | Splunk Enterprise Security",,"Cloud Security",,"Defense Evasion | Execution","Actions on Objectives","ESCU - Abnormally High AWS Instances Launched by User - MLTK - Rule | ESCU - Abnormally High AWS Instances Launched by User - Rule | ESCU - Abnormally High AWS Instances Terminated by User - MLTK - Rule | ESCU - Abnormally High AWS Instances Terminated by User - Rule | ESCU - EC2 Instance Started In Previously Unseen Region - Rule | ESCU - EC2 Instance Started With Previously Unseen User - Rule","ESCU - AWS Investigate User Activities By ARN | ESCU - Get EC2 Instance Details by instanceId | ESCU - Get EC2 Launch Details | ESCU - Get Notable History | ESCU - Get Notable Info | ESCU - Get User Information from Identity Table | ESCU - Investigate AWS activities via region name",,"ESCU - Baseline of Excessive AWS Instances Launched by User - MLTK | ESCU - Baseline of Excessive AWS Instances Terminated by User - MLTK | ESCU - Previously Seen AWS Regions | ESCU - Previously Seen EC2 Launches By User",
"Splunk ES Content Update - Analytic Stories","Suspicious AWS Login Activities","Monitor your AWS authentication events using your CloudTrail logs. Searches within this Analytic Story will help you stay aware of and investigate suspicious logins.",,AWS,,"Cloud Security",,"Credential Access","Actions on Objectives","ESCU - Detect AWS Console Login by User from New City - Rule | ESCU - Detect AWS Console Login by User from New Country - Rule | ESCU - Detect AWS Console Login by User from New Region - Rule | ESCU - Detect new user AWS Console Login - Rule","ESCU - AWS Investigate User Activities By ARN",,"ESCU - Previously seen users in CloudTrail | ESCU - Update previously seen users in CloudTrail",
"Splunk ES Content Update - Analytic Stories","Suspicious AWS S3 Activities","Use the searches in this Analytic Story to monitor your AWS S3 buckets for evidence of anomalous activity and suspicious behaviors such as detecting open S3 buckets and buckets being accessed from a new IP. The contextual and investigative searches will give you more information when required.",,"AWS | Splunk Enterprise Security",,"Cloud Security",,"Credential Access | Execution | Exfiltration | Initial Access","Actions on Objectives","ESCU - Detect New Open S3 buckets - Rule | ESCU - Detect S3 access from a new IP - Rule | ESCU - Detect Spike in S3 Bucket deletion - Rule","ESCU - AWS Investigate User Activities By ARN | ESCU - AWS S3 Bucket details via bucketName | ESCU - Get All AWS Activity From IP Address | ESCU - Get Notable History | ESCU - Get Notable Info | ESCU - Get User Information from Identity Table | ESCU - Investigate AWS activities via region name",,"ESCU - Baseline of S3 Bucket deletion activity by ARN | ESCU - Previously seen S3 bucket access by remote IP",
"Splunk ES Content Update - Analytic Stories","Suspicious AWS Traffic","Leverage these searches to monitor your AWS network traffic for evidence of anomalous activity and suspicious behaviors such as a spike in blocked outbound traffic in your virtual private cloud (VPC).",,"AWS | Bluecoat | Bro | Carbon Black Response | CrowdStrike Falcon | Linux | Microsoft Windows | Palo Alto Firewall | Splunk Enterprise Security | Splunk Stream | Sysmon | Tanium | Ziften | macOS",,"Cloud Security",,"Command and Control | Exfiltration","Actions on Objectives | Command and Control","ESCU - Detect Spike in blocked Outbound Traffic from your AWS - Rule","ESCU - AWS Investigate User Activities By ARN | ESCU - AWS Network ACL Details from ID | ESCU - AWS Network Interface details via resourceId | ESCU - Get All AWS Activity From IP Address | ESCU - Get Authentication Logs For Endpoint | ESCU - Get DNS Server History for a host | ESCU - Get DNS traffic ratio | ESCU - Get Notable History | ESCU - Get Notable Info | ESCU - Get Process Info | ESCU - Get Process Information For Port Activity | ESCU - Get Process Responsible For The DNS Traffic | ESCU - Get Risk Modifiers For Endpoint | ESCU - Get Risk Modifiers For User | ESCU - Get User Information from Identity Table",,"ESCU - Baseline of blocked outbound traffic from AWS",
"Splunk ES Content Update - Analytic Stories","Suspicious Command-Line Executions","Leveraging the Windows command-line interface (CLI) is one of the most common attack techniques--one that is also detailed in the MITRE ATT&CK framework. Use this Analytic Story to help you identify unusual or suspicious use of the CLI on Windows systems.",,"Bluecoat | Bro | Carbon Black Response | CrowdStrike Falcon | Linux | Microsoft Windows | Palo Alto Firewall | Splunk Enterprise Security | Splunk Stream | Sysmon | Tanium | Ziften | macOS",,"Adversary Tactics",,"Command-Line Interface | Defense Evasion | Execution | Masquerading | Persistence | Scripting","Actions on Objectives | Command and Control | Exploitation","ESCU - Detect Prohibited Applications Spawning cmd.exe - Rule | ESCU - Detect Use of cmd.exe to Launch Script Interpreters - Rule | ESCU - First time seen command line argument - Rule | ESCU - System Processes Run From Unexpected Locations - Rule | ESCU - Unusually Long Command Line - MLTK - Rule | ESCU - Unusually Long Command Line - Rule","ESCU - Get Authentication Logs For Endpoint | ESCU - Get Notable History | ESCU - Get Notable Info | ESCU - Get Parent Process Info | ESCU - Get Process Info | ESCU - Get Registry Activities | ESCU - Get Risk Modifiers For Endpoint | ESCU - Get Risk Modifiers For User | ESCU - Get User Information from Identity Table | ESCU - Investigate Web Activity From Host",,"ESCU - Baseline of Command Line Length - MLTK | ESCU - Previously seen command line arguments",
"Splunk ES Content Update - Analytic Stories","Suspicious DNS Traffic","Attackers often attempt to hide within or otherwise abuse the domain name system (DNS). You can thwart attempts to manipulate this omnipresent protocol by monitoring for these types of abuses.",,"Bro | Carbon Black Response | CrowdStrike Falcon | Linux | Microsoft Windows | Splunk Enterprise Security | Splunk Stream | Sysmon | Tanium | Ziften | macOS",,"Adversary Tactics",,"Command and Control | Commonly Used Port | Defense Evasion | Exfiltration | Exfiltration Over Alternative Protocol","Actions on Objectives | Command and Control","ESCU - Clients Connecting to Multiple DNS Servers - Rule | ESCU - DNS Query Length Outliers - MLTK - Rule | ESCU - DNS Query Length With High Standard Deviation - Rule | ESCU - DNS Query Requests Resolved by Unauthorized DNS Servers - Rule | ESCU - Detect Long DNS TXT Record Response - Rule | ESCU - Detect hosts connecting to dynamic domain providers - Rule | ESCU - Detection of DNS Tunnels - Rule | ESCU - Excessive DNS Failures - Rule","ESCU - Get Authentication Logs For Endpoint | ESCU - Get DNS Server History for a host | ESCU - Get DNS traffic ratio | ESCU - Get Notable History | ESCU - Get Notable Info | ESCU - Get Parent Process Info | ESCU - Get Process Info | ESCU - Get Process Responsible For The DNS Traffic | ESCU - Get Risk Modifiers For Endpoint | ESCU - Get Risk Modifiers For User | ESCU - Get User Information from Identity Table",,"ESCU - Baseline of DNS Query Length - MLTK",
"Splunk ES Content Update - Analytic Stories","Suspicious Emails","Email remains one of the primary means for attackers to gain an initial foothold within the modern enterprise. Detect and investigate suspicious emails in your environment with the help of the searches in this Analytic Story.",,"Bluecoat | Bro | Cuckoo | DeepSight | Linux | Microsoft Exchange | Microsoft Windows | Palo Alto Firewall | SMTP | Splunk Enterprise | Splunk Enterprise Security | Splunk Stream | VirusTotal | macOS",,"Adversary Tactics",,"Defense Evasion | Execution",Delivery,"ESCU - Email Attachments With Lots Of Spaces - Rule | ESCU - Monitor Email For Brand Abuse - Rule | ESCU - Suspicious Email Attachment Extensions - Rule","ESCU - Get Authentication Logs For Endpoint | ESCU - Get Email Info | ESCU - Get Emails From Specific Sender | ESCU - Get Notable History | ESCU - Get Notable Info | ESCU - Get Risk Modifiers For Endpoint | ESCU - Get Risk Modifiers For User | ESCU - Get User Information from Identity Table | ESCU - Investigate Web Activity From Host",,"ESCU - DNSTwist Domain Names",
"Splunk ES Content Update - Analytic Stories","Suspicious MSHTA Activity","Monitor and detect techniques used by attackers who leverage the mshta.exe process to execute malicious code.",,"Bluecoat | Bro | Carbon Black Response | CrowdStrike Falcon | Linux | Microsoft Windows | Palo Alto Firewall | Splunk Enterprise Security | Splunk Stream | Sysmon | Tanium | Ziften | macOS",,"Adversary Tactics",,"AppInit DLLs | Authentication Package | Command-Line Interface | Execution | Persistence | Registry Run Keys / Start Folder","Actions on Objectives | Exploitation","ESCU - Detect Prohibited Applications Spawning cmd.exe - Rule | ESCU - Detect mshta.exe running scripts in command-line arguments - Rule | ESCU - Registry Keys Used For Persistence - Rule","ESCU - Get Authentication Logs For Endpoint | ESCU - Get Notable History | ESCU - Get Notable Info | ESCU - Get Parent Process Info | ESCU - Get Process Info | ESCU - Get Registry Activities | ESCU - Get Risk Modifiers For Endpoint | ESCU - Get Risk Modifiers For User | ESCU - Get User Information from Identity Table | ESCU - Investigate Web Activity From Host",,"ESCU - Baseline of Command Line Length - MLTK | ESCU - Previously seen command line arguments",
"Splunk ES Content Update - Analytic Stories","Suspicious Okta Activity","Monitor your Okta environment for suspicious activities. Due to the Covid outbreak many users are migrating over to leverage cloud services more and more. Okta is a popular tool to manage multiple users and the web-based applications they need to stay productive. The searches in this story will help monitor your Okta environment for suspicious activities and associated user behaviors.",,Okta,,"Adversary Tactics",,"Valid Accounts",,"ESCU - Multiple Okta Users With Invalid Credentails From The Same IP - Rule | ESCU - Okta Account Lockout Events - Rule | ESCU - Okta Failed SSO Attempts - Rule | ESCU - Okta User Logins From Multiple Cities - Rule","ESCU - Investigate Okta Activity by IP Address | ESCU - Investigate Okta Activity by app | ESCU - Investigate User Activities In Okta",,"",
"Splunk ES Content Update - Analytic Stories","Suspicious Windows Registry Activities","Monitor and detect registry changes initiated from remote locations which can be a sign that an attacker has infiltrated your system.",,"Bluecoat | Bro | Carbon Black Response | CrowdStrike Falcon | Linux | Microsoft Windows | Palo Alto Firewall | Splunk Enterprise Security | Splunk Stream | Sysmon | Tanium | Ziften | macOS",,"Adversary Tactics",,"Accessibility Features | AppInit DLLs | Application Shimming | Authentication Package | Change Default File Association | Defense Evasion | Lateral Movement | Local Port Monitor | Modify Registry | Persistence | Privilege Escalation | Registry Run Keys / Start Folder","Actions on Objectives","ESCU - Disabling Remote User Account Control - Rule | ESCU - Monitor Registry Keys for Print Monitors - Rule | ESCU - Reg.exe used to hide files/directories via registry keys - Rule | ESCU - Registry Keys Used For Persistence - Rule | ESCU - Registry Keys Used For Privilege Escalation - Rule | ESCU - Registry Keys for Creating SHIM Databases - Rule | ESCU - Remote Registry Key modifications - Rule | ESCU - Suspicious Changes to File Associations - Rule","ESCU - Get Authentication Logs For Endpoint | ESCU - Get Notable History | ESCU - Get Notable Info | ESCU - Get Parent Process Info | ESCU - Get Process Info | ESCU - Get Registry Activities | ESCU - Get Risk Modifiers For Endpoint | ESCU - Get Risk Modifiers For User | ESCU - Get User Information from Identity Table | ESCU - Investigate Web Activity From Host",,"",
"Splunk ES Content Update - Analytic Stories","Suspicious WMI Use","Attackers are increasingly abusing Windows Management Instrumentation (WMI) a framework and associated utilities available on all modern Windows operating systems. Because WMI can be leveraged to manage both local and remote systems it is important to identify the processes executed and the user context within which the activity occurred.",,"Carbon Black Response | CrowdStrike Falcon | Linux | Microsoft Windows | Splunk Enterprise Security | Sysmon | Tanium | Ziften | macOS",,"Adversary Tactics",,"Execution | Persistence | Windows Management Instrumentation | Windows Management Instrumentation Event Subscription","Actions on Objectives","ESCU - Process Execution via WMI - Rule | ESCU - Remote Process Instantiation via WMI - Rule | ESCU - Remote WMI Command Attempt - Rule | ESCU - Script Execution via WMI - Rule | ESCU - WMI Permanent Event Subscription - Rule | ESCU - WMI Permanent Event Subscription - Sysmon - Rule | ESCU - WMI Temporary Event Subscription - Rule","ESCU - Get Authentication Logs For Endpoint | ESCU - Get Notable History | ESCU - Get Notable Info | ESCU - Get Parent Process Info | ESCU - Get Process Info | ESCU - Get Risk Modifiers For Endpoint | ESCU - Get Risk Modifiers For User | ESCU - Get Sysmon WMI Activity for Host | ESCU - Get User Information from Identity Table",,"",
"Splunk ES Content Update - Analytic Stories","Unusual AWS EC2 Modifications","Identify unusual changes to your AWS EC2 instances that may indicate malicious activity. Modifications to your EC2 instances by previously unseen users is an example of an activity that may warrant further investigation.",,"AWS | Splunk Enterprise Security",,"Cloud Security",,,,"ESCU - EC2 Instance Modified With Previously Unseen User - Rule","ESCU - AWS Investigate User Activities By ARN | ESCU - Get EC2 Instance Details by instanceId | ESCU - Get Notable History",,"ESCU - Previously Seen EC2 Modifications By User",
"Splunk ES Content Update - Analytic Stories","Unusual Processes","Quickly identify systems running new or unusual processes in your environment that could be indicators of suspicious activity. Processes run from unusual locations those with conspicuously long command lines and rare executables are all examples of activities that may warrant deeper investigation.",,"Bluecoat | Bro | Carbon Black Response | CrowdStrike Falcon | Linux | Microsoft Windows | Palo Alto Firewall | Splunk Enterprise Security | Splunk Stream | Sysmon | Tanium | Ziften | macOS",,Malware,,"Accessibility Features | Defense Evasion | Execution | Masquerading | Rundll32","Actions on Objectives | Command and Control | Installation","ESCU - Detect Rare Executables - Rule | ESCU - Detect processes used for System Network Configuration Discovery - Rule | ESCU - RunDLL Loading DLL By Ordinal - Rule | ESCU - System Processes Run From Unexpected Locations - Rule | ESCU - Uncommon Processes On Endpoint - Rule | ESCU - Unusually Long Command Line - MLTK - Rule | ESCU - Unusually Long Command Line - Rule","ESCU - Get Authentication Logs For Endpoint | ESCU - Get Notable History | ESCU - Get Notable Info | ESCU - Get Parent Process Info | ESCU - Get Process Info | ESCU - Get Risk Modifiers For Endpoint | ESCU - Get Risk Modifiers For User | ESCU - Get User Information from Identity Table | ESCU - Investigate Web Activity From Host",,"ESCU - Baseline of Command Line Length - MLTK",
"Splunk ES Content Update - Analytic Stories","Use of Cleartext Protocols","Leverage searches that detect cleartext network protocols that may leak credentials or should otherwise be encrypted.",,"Bluecoat | Bro | Palo Alto Firewall | Splunk Enterprise Security | Splunk Stream",,"Best Practices",,"Collection | Credential Access | Lateral Movement","Actions on Objectives | Reconnaissance","ESCU - Protocols passing authentication in cleartext - Rule","ESCU - Get Notable History | ESCU - Get Notable Info | ESCU - Get Process Information For Port Activity | ESCU - Get Risk Modifiers For Endpoint | ESCU - Get Risk Modifiers For User | ESCU - Get User Information from Identity Table",,"",
"Splunk ES Content Update - Analytic Stories","Web Fraud Detection","Monitor your environment for activity consistent with common attack techniques bad actors use when attempting to compromise web servers or other web-related assets.",,"Microsoft Exchange | Splunk Enterprise Security | Splunk Stream",,Abuse,,"Create Account | Initial Access | Persistence | Valid Accounts","Actions on Objectives","ESCU - Web Fraud - Account Harvesting - Rule | ESCU - Web Fraud - Anomalous User Clickspeed - Rule | ESCU - Web Fraud - Password Sharing Across Accounts - Rule","ESCU - Get Emails From Specific Sender | ESCU - Get Notable History | ESCU - Get Notable Info | ESCU - Get Web Session Information via session_id",,"",
"Splunk ES Content Update - Analytic Stories","Windows Defense Evasion Tactics","Detect tactics used by malware to evade defenses on Windows endpoints. A few of these include suspicious `reg.exe` processes files hidden with `attrib.exe` and disabling user-account control among many others",,"Carbon Black Response | CrowdStrike Falcon | Linux | Microsoft Windows | Splunk Enterprise Security | Sysmon | Tanium | Ziften | macOS",,"Adversary Tactics",,"Defense Evasion | Disabling Security Tools | Lateral Movement | Modify Registry | Persistence","Actions on Objectives","ESCU - Disabling Remote User Account Control - Rule | ESCU - Hiding Files And Directories With Attrib.exe - Rule | ESCU - Reg.exe used to hide files/directories via registry keys - Rule | ESCU - Remote Registry Key modifications - Rule | ESCU - Suspicious Reg.exe Process - Rule","ESCU - Get Authentication Logs For Endpoint | ESCU - Get Notable History | ESCU - Get Notable Info | ESCU - Get Parent Process Info | ESCU - Get Process Info | ESCU - Get Registry Activities | ESCU - Get Risk Modifiers For Endpoint | ESCU - Get Risk Modifiers For User | ESCU - Get User Information from Identity Table",,"",
"Splunk ES Content Update - Analytic Stories","Windows File Extension and Association Abuse","Detect and investigate suspected abuse of file extensions and Windows file associations. Some of the malicious behaviors involved may include inserting spaces before file extensions or prepending the file extension with a different one among other techniques.",,"Carbon Black Response | CrowdStrike Falcon | Linux | Microsoft Windows | Splunk Enterprise Security | Sysmon | Tanium | Ziften | macOS",,Malware,,"Change Default File Association | Execution | Persistence","Actions on Objectives","ESCU - Execution of File With Spaces Before Extension - Rule | ESCU - Execution of File with Multiple Extensions - Rule | ESCU - Suspicious Changes to File Associations - Rule","ESCU - Get Authentication Logs For Endpoint | ESCU - Get Notable History | ESCU - Get Notable Info | ESCU - Get Parent Process Info | ESCU - Get Process Info | ESCU - Get Registry Activities | ESCU - Get Risk Modifiers For Endpoint | ESCU - Get Risk Modifiers For User | ESCU - Get User Information from Identity Table",,"",
"Splunk ES Content Update - Analytic Stories","Windows Log Manipulation","Adversaries often try to cover their tracks by manipulating Windows logs. Use these searches to help you monitor for suspicious activity surrounding log files--an essential component of an effective defense.",,"Bluecoat | Bro | Carbon Black Response | CrowdStrike Falcon | Linux | Microsoft Windows | Nessus | Palo Alto Firewall | Splunk Enterprise Security | Splunk Stream | Sysmon | Tanium | Ziften | macOS",,"Adversary Tactics",,"Defense Evasion | Impact | Indicator Removal on Host","Actions on Objectives","ESCU - Deleting Shadow Copies - Rule | ESCU - Suspicious wevtutil Usage - Rule | ESCU - USN Journal Deletion - Rule | ESCU - Windows Event Log Cleared - Rule","ESCU - Get Authentication Logs For Endpoint | ESCU - Get Notable History | ESCU - Get Notable Info | ESCU - Get Parent Process Info | ESCU - Get Process Info | ESCU - Get Risk Modifiers For Endpoint | ESCU - Get Risk Modifiers For User | ESCU - Get User Information from Identity Table | ESCU - Get Vulnerability Logs For Endpoint | ESCU - Investigate Web Activity From Host",,"",
"Splunk ES Content Update - Analytic Stories","Windows Persistence Techniques","Monitor for activities and techniques associated with maintaining persistence on a Windows system--a sign that an adversary may have compromised your environment.",,"Bluecoat | Bro | Carbon Black Response | CrowdStrike Falcon | Linux | Microsoft Windows | Palo Alto Firewall | Splunk Enterprise Security | Splunk Stream | Sysmon | Tanium | Ziften | macOS",,"Adversary Tactics",,"AppInit DLLs | Application Shimming | Authentication Package | Defense Evasion | Disabling Security Tools | Execution | Lateral Movement | Local Port Monitor | Modify Existing Service | New Service | Persistence | Privilege Escalation | Registry Run Keys / Start Folder | Scheduled Task","Actions on Objectives | Installation","ESCU - Detect Path Interception By Creation Of program.exe - Rule | ESCU - Hiding Files And Directories With Attrib.exe - Rule | ESCU - Monitor Registry Keys for Print Monitors - Rule | ESCU - Reg.exe Manipulating Windows Services Registry Keys - Rule | ESCU - Reg.exe used to hide files/directories via registry keys - Rule | ESCU - Registry Keys Used For Persistence - Rule | ESCU - Registry Keys for Creating SHIM Databases - Rule | ESCU - Remote Registry Key modifications - Rule | ESCU - Sc.exe Manipulating Windows Services - Rule | ESCU - Schtasks used for forcing a reboot - Rule | ESCU - Shim Database File Creation - Rule | ESCU - Shim Database Installation With Suspicious Parameters - Rule","ESCU - Get Authentication Logs For Endpoint | ESCU - Get Notable History | ESCU - Get Notable Info | ESCU - Get Parent Process Info | ESCU - Get Process Info | ESCU - Get Registry Activities | ESCU - Get Risk Modifiers For Endpoint | ESCU - Get Risk Modifiers For User | ESCU - Get User Information from Identity Table | ESCU - Investigate Web Activity From Host",,"",
"Splunk ES Content Update - Analytic Stories","Windows Privilege Escalation","Monitor for and investigate activities that may be associated with a Windows privilege-escalation attack including unusual processes running on endpoints modified registry keys and more.",,"Bluecoat | Bro | Carbon Black Response | CrowdStrike Falcon | Linux | Microsoft Windows | Palo Alto Firewall | Splunk Enterprise Security | Splunk Stream | Sysmon | Tanium | Ziften | macOS",,"Adversary Tactics",,"Accessibility Features | Execution | Exploitation for Privilege Escalation | Persistence | Privilege Escalation","Actions on Objectives | Exploitation","ESCU - Child Processes of Spoolsv.exe - Rule | ESCU - Overwriting Accessibility Binaries - Rule | ESCU - Registry Keys Used For Privilege Escalation - Rule | ESCU - Uncommon Processes On Endpoint - Rule","ESCU - Get Authentication Logs For Endpoint | ESCU - Get Notable History | ESCU - Get Notable Info | ESCU - Get Parent Process Info | ESCU - Get Process Info | ESCU - Get Registry Activities | ESCU - Get Risk Modifiers For Endpoint | ESCU - Get Risk Modifiers For User | ESCU - Get User Information from Identity Table | ESCU - Investigate Web Activity From Host",,"",
"Splunk ES Content Update - Analytic Stories","Windows Service Abuse","Windows services are often used by attackers for persistence and the ability to load drivers or otherwise interact with the Windows kernel. This Analytic Story helps you monitor your environment for indications that Windows services are being modified or created in a suspicious manner.",,"Carbon Black Response | CrowdStrike Falcon | Linux | Microsoft Windows | Splunk Enterprise Security | Sysmon | Tanium | Ziften | macOS",,Malware,,"Defense Evasion | Disabling Security Tools | Execution | Modify Existing Service | New Service | Persistence | Privilege Escalation","Actions on Objectives | Installation","ESCU - First Time Seen Running Windows Service - Rule | ESCU - Reg.exe Manipulating Windows Services Registry Keys - Rule | ESCU - Sc.exe Manipulating Windows Services - Rule","ESCU - Get Authentication Logs For Endpoint | ESCU - Get Notable History | ESCU - Get Notable Info | ESCU - Get Parent Process Info | ESCU - Get Process Info | ESCU - Get Risk Modifiers For Endpoint | ESCU - Get Risk Modifiers For User | ESCU - Get User Information from Identity Table",,"ESCU - Previously Seen Running Windows Services",
"Splunk ES Content Update - Correlations","Abnormally High AWS Instances Launched by User - MLTK","This search looks for CloudTrail events where a user successfully launches an abnormally high number of instances.",,"AWS | Audit Trail",,"Cloud Security | SaaS","Security Monitoring",None,"Actions on Objectives",,,,,"search sourcetype=aws:cloudtrail eventName=RunInstances errorCode=success `ec2_excessive_runinstances_mltk_input_filter` | bucket span=10m _time  | stats count as instances_launched by _time src_user  | apply ec2_excessive_runinstances_v1  | rename ""IsOutlier(instances_launched)"" as isOutlier  | where isOutlier=1"
"Splunk ES Content Update - Correlations","Abnormally High AWS Instances Launched by User","This search looks for CloudTrail events where a user successfully launches an abnormally high number of instances.",,"AWS | Audit Trail",,"Cloud Security | SaaS","Advanced Threat Detection",Execution,"Actions on Objectives",,,,,"search sourcetype=aws:cloudtrail eventName=RunInstances errorCode=success | bucket span=10m _time | stats count AS instances_launched by _time userName | eventstats avg(instances_launched) as total_launched_avg, stdev(instances_launched) as total_launched_stdev | eval threshold_value = 4 | eval isOutlier=if(instances_launched > total_launched_avg+(total_launched_stdev * threshold_value), 1, 0) | search isOutlier=1 AND _time >= relative_time(now(), ""-10m@m"") | eval num_standard_deviations_away = round(abs(instances_launched - total_launched_avg) / total_launched_stdev, 2) | table _time, userName, instances_launched, num_standard_deviations_away, total_launched_avg, total_launched_stdev"
"Splunk ES Content Update - Correlations","Abnormally High AWS Instances Terminated by User - MLTK","This search looks for CloudTrail events where a user successfully terminates an abnormally high number of instances.",,"AWS | Audit Trail",,"Cloud Security | SaaS","Security Monitoring",None,"Actions on Objectives",,,,,"search sourcetype=aws:cloudtrail eventName=TerminateInstances errorCode=success `ec2_excessive_terminateinstances_mltk_input_filter` | bucket span=10m _time  | stats count as instances_terminated by _time src_user  | apply ec2_excessive_terminateinstances_v1  | rename ""IsOutlier(instances_terminated)"" as isOutlier  | where isOutlier=1"
"Splunk ES Content Update - Correlations","Abnormally High AWS Instances Terminated by User","This search looks for CloudTrail events where an abnormally high number of instances were successfully terminated by a user in a 10-minute window",,"AWS | Audit Trail",,"Cloud Security | SaaS","Advanced Threat Detection",Execution,"Actions on Objectives",,,,,"search sourcetype=aws:cloudtrail eventName=TerminateInstances errorCode=success | bucket span=10m _time | stats count AS instances_terminated by _time userName | eventstats avg(instances_terminated) as total_terminations_avg, stdev(instances_terminated) as total_terminations_stdev | eval threshold_value = 4 | eval isOutlier=if(instances_terminated > total_terminations_avg+(total_terminations_stdev * threshold_value), 1, 0) | search isOutlier=1 AND _time >= relative_time(now(), ""-10m@m"")| eval num_standard_deviations_away = round(abs(instances_terminated - total_terminations_avg) / total_terminations_stdev, 2) |table _time, userName, instances_terminated, num_standard_deviations_away, total_terminations_avg, total_terminations_stdev"
"Splunk ES Content Update - Correlations","Access LSASS Memory for Dump Creation","Detect memory dumping of the LSASS process.",,"Windows Security",,"Adversary Tactics | ","Advanced Threat Detection",None,"Actions on Objectives",,,,,"search `sysmon` EventCode=10 TargetImage=*lsass.exe CallTrace=*dbgcore.dll* OR CallTrace=*dbghelp.dll* | stats count min(_time) as firstTime max(_time) as lastTime by Computer, TargetImage, TargetProcessId, SourceImage, SourceProcessId | rename Computer as dest | `security_content_ctime(firstTime)`| `security_content_ctime(lastTime)` | `access_lsass_memory_for_dump_creation_filter`"
"Splunk ES Content Update - Correlations","Amazon EKS Kubernetes cluster scan detection","This search provides information of unauthenticated requests via user agent, and authentication data against Kubernetes cluster in AWS",,"[""AWS""]",,,,,,,,,,"search sourcetype=""aws:cloudwatchlogs:eks"" ""user.username""=""system:anonymous"" userAgent!=""AWS Security Scanner"" | rename sourceIPs{} as src_ip | stats count min(_time) as firstTime max(_time) as lastTime values(responseStatus.reason) values(source) as cluster_name values(responseStatus.code) values(userAgent) as http_user_agent values(verb) values(requestURI) by src_ip user.username user.groups{} | `security_content_ctime(lastTime)` | `security_content_ctime(firstTime)` |`kubernetes_aws_scan_fingerprint_detection`"
"Splunk ES Content Update - Correlations","Amazon EKS Kubernetes Pod scan detection","This search provides detection information on unauthenticated requests against Kubernetes' Pods API",,"[""AWS""]",,,,,,,,,,"search sourcetype=""aws:cloudwatchlogs:eks"" ""user.username""=""system:anonymous"" verb=list objectRef.resource=pods requestURI=""/api/v1/pods"" | rename source as cluster_name sourceIPs{} as src_ip | stats count min(_time) as firstTime max(_time) as lastTime values(responseStatus.reason) values(responseStatus.code) values(userAgent) values(verb) values(requestURI) by src_ip cluster_name user.username user.groups{} | `security_content_ctime(lastTime)` | `security_content_ctime(firstTime)` | `kubernetes_pods_aws_scan_fingerprint_detection`"
"Splunk ES Content Update - Correlations","Attempt To Add Certificate To Untrusted Store","Attempt to add a certificate to the untrusted certificate store",Endpoint,"Endpoint Detection and Response",,"Adversary Tactics","Advanced Threat Detection","Defense Evasion","Installation | Actions on Objectives",,,,," tstats `security_content_summariesonly` count min(_time) as firstTime values(Processes.process) as process max(_time) as lastTime from datamodel=Endpoint.Processes where Processes.process_name=certutil.exe (Processes.process=*-addstore* AND Processes.process=*disallowed* ) by Processes.parent_process Processes.process_name Processes.user | `drop_dm_object_name(""Processes"")` | `security_content_ctime(firstTime)`|`security_content_ctime(lastTime)`"
"Splunk ES Content Update - Correlations","Attempt To Set Default PowerShell Execution Policy To Unrestricted or Bypass","Monitor for changes of the ExecutionPolicy in the registry to the values ""unrestricted"" or ""bypass,"" which allows the execution of malicious scripts.",Endpoint,"Endpoint Detection and Response",,"Adversary Tactics | ","Advanced Threat Detection",None,"Installation | Actions on Objectives",,,,," tstats `security_content_summariesonly` count min(_time) as firstTime max(_time) as lastTime from datamodel=Endpoint.Registry where Registry.registry_path=*Software\\Microsoft\\Powershell\\1\\ShellIds\\Microsoft.PowerShell* Registry.registry_key_name=ExecutionPolicy (Registry.registry_value_name=Unrestricted OR Registry.registry_value_name=Bypass) by Registry.registry_path Registry.registry_key_name Registry.registry_value_name Registry.dest | `drop_dm_object_name(Registry)` | `security_content_ctime(firstTime)`| `security_content_ctime(lastTime)` | `attempt_to_set_default_powershell_execution_policy_to_unrestricted_or_bypass_filter`"
"Splunk ES Content Update - Correlations","Attempt To Stop Security Service","This search looks for attempts to stop security-related services on the endpoint.",Endpoint,"Endpoint Detection and Response",,"Adversary Tactics","Advanced Threat Detection","Defense Evasion","Installation | Actions on Objectives",,,,," tstats `security_content_summariesonly` values(Processes.process) as process min(_time) as firstTime max(_time) as lastTime from datamodel=Endpoint.Processes where (Processes.process_name = net.exe OR  Processes.process_name = sc.exe) Processes.process=""* stop *"" by Processes.process_name Processes.parent_process_name Processes.dest Processes.user | `drop_dm_object_name(Processes)` | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)` |lookup security_services_lookup service as process OUTPUTNEW category, description | search category=security"
"Splunk ES Content Update - Correlations","Attempted Credential Dump From Registry via Reg.exe","Monitor for execution of reg.exe with parameters specifying an export of keys that contain hashed credentials that attackers may try to crack offline.",Endpoint,"Endpoint Detection and Response",,"Adversary Tactics | ","Advanced Threat Detection",None,"Actions on Objectives",,,,," tstats `security_content_summariesonly` count min(_time) as firstTime max(_time) as lastTime from datamodel=Endpoint.Processes where (Processes.process_name=reg.exe OR Processes.process_name=cmd.exe) Processes.process=*save* (Processes.process=*HKEY_LOCAL_MACHINE\\Security* OR Processes.process=*HKEY_LOCAL_MACHINE\\SAM* OR Processes.process=*HKEY_LOCAL_MACHINE\\System* OR Processes.process=*HKLM\\Security* OR Processes.process=*HKLM\\System* OR Processes.process=*HKLM\\SAM*) by Processes.user Processes.process_name Processes.process Processes.dest | `drop_dm_object_name(Processes)` | `security_content_ctime(firstTime)`| `security_content_ctime(lastTime)` | `attempted_credential_dump_from_registry_via_reg_filter`"
"Splunk ES Content Update - Correlations","AWS Cloud Provisioning From Previously Unseen City","This search looks for AWS provisioning activities from previously unseen cities.  Provisioning activities are defined broadly as any event that begins with ""Run"" or ""Create."" ",,"AWS | Audit Trail",,"Cloud Security | SaaS","Advanced Threat Detection",None,None,,,,,"search sourcetype=aws:cloudtrail (eventName=Run* OR eventName=Create*) | iplocation sourceIPAddress | search City=* [search sourcetype=aws:cloudtrail (eventName=Run* OR eventName=Create*) | iplocation sourceIPAddress | search City=* | stats earliest(_time) as firstTime, latest(_time) as lastTime by sourceIPAddress, City, Region, Country | inputlookup append=t previously_seen_provisioning_activity_src.csv | stats min(firstTime) as firstTime max(lastTime) as lastTime by sourceIPAddress, City, Region, Country | outputlookup previously_seen_provisioning_activity_src.csv | stats min(firstTime) as firstTime max(lastTime) as lastTime by City | eval newCity=if(firstTime >= relative_time(now(), ""-70m@m""), 1, 0) | where newCity=1 | table City] | spath output=user userIdentity.arn | rename sourceIPAddress as src_ip | table _time, user, src_ip, City, eventName, errorCode"
"Splunk ES Content Update - Correlations","AWS Cloud Provisioning From Previously Unseen Country","This search looks for AWS provisioning activities from previously unseen countries. Provisioning activities are defined broadly as any event that begins with ""Run"" or ""Create."" ",,"AWS | Audit Trail",,"Cloud Security | SaaS","Advanced Threat Detection",None,None,,,,,"search sourcetype=aws:cloudtrail (eventName=Run* OR eventName=Create*) | iplocation sourceIPAddress | search Country=* [search sourcetype=aws:cloudtrail (eventName=Run* OR eventName=Create*) | iplocation sourceIPAddress | search Country=* | stats earliest(_time) as firstTime, latest(_time) as lastTime by sourceIPAddress, City, Region, Country | inputlookup append=t previously_seen_provisioning_activity_src.csv | stats min(firstTime) as firstTime max(lastTime) as lastTime by sourceIPAddress, City, Region, Country | outputlookup previously_seen_provisioning_activity_src.csv | stats min(firstTime) as firstTime max(lastTime) as lastTime by Country | eval newCountry=if(firstTime >= relative_time(now(), ""-70m@m""), 1, 0) | where newCountry=1 | table Country] | spath output=user userIdentity.arn | rename sourceIPAddress as src_ip | table _time, user, src_ip, Country, eventName, errorCode"
"Splunk ES Content Update - Correlations","AWS Cloud Provisioning From Previously Unseen IP Address","This search looks for AWS provisioning activities from previously unseen IP addresses. Provisioning activities are defined broadly as any event that begins with ""Run"" or ""Create."" ",,"AWS | Audit Trail",,"Cloud Security | SaaS","Advanced Threat Detection",None,None,,,,,"search sourcetype=aws:cloudtrail (eventName=Run* OR eventName=Create*) | iplocation sourceIPAddress | search Country=* [search sourcetype=aws:cloudtrail (eventName=Run* OR eventName=Create*) | iplocation sourceIPAddress | search Country=* | stats earliest(_time) as firstTime, latest(_time) as lastTime by sourceIPAddress, City, Region, Country | inputlookup append=t previously_seen_provisioning_activity_src.csv | stats min(firstTime) as firstTime max(lastTime) as lastTime by sourceIPAddress, City, Region, Country | outputlookup previously_seen_provisioning_activity_src.csv | stats min(firstTime) as firstTime max(lastTime) as lastTime by sourceIPAddress | eval newIP=if(firstTime >= relative_time(now(), ""-70m@m""), 1, 0) | where newIP=1 | table sourceIPAddress] | spath output=user userIdentity.arn | rename sourceIPAddress as src_ip | table _time, user, src_ip, eventName, errorCode"
"Splunk ES Content Update - Correlations","AWS Cloud Provisioning From Previously Unseen Region","This search looks for AWS provisioning activities from previously unseen regions. Region in this context is similar to a state in the United States. Provisioning activities are defined broadly as any event that begins with ""Run"" or ""Create.""",,"AWS | Audit Trail",,"Cloud Security | SaaS","Advanced Threat Detection",None,None,,,,,"search sourcetype=aws:cloudtrail (eventName=Run* OR eventName=Create*) | iplocation sourceIPAddress | search Region=* [search sourcetype=aws:cloudtrail (eventName=Run* OR eventName=Create*) | iplocation sourceIPAddress | search Region=* | stats earliest(_time) as firstTime, latest(_time) as lastTime by sourceIPAddress, City, Region, Country | inputlookup append=t previously_seen_provisioning_activity_src.csv | stats min(firstTime) as firstTime max(lastTime) as lastTime by sourceIPAddress, City, Region, Country | outputlookup previously_seen_provisioning_activity_src.csv | stats min(firstTime) as firstTime max(lastTime) as lastTime by Region | eval newRegion=if(firstTime >= relative_time(now(), ""-70m@m""), 1, 0) | where newRegion=1 | table Region] | spath output=user userIdentity.arn | rename sourceIPAddress as src_ip | table _time, user, src_ip, Region, eventName, errorCode"
"Splunk ES Content Update - Correlations","AWS Cross Account Activity From Previously Unseen Account","This search looks for AssumeRole events where an IAM role in a different account is requested for the first time.",,"AWS | Audit Trail",,"Cloud Security | SaaS","Advanced Threat Detection","Credential Access","Actions on Objectives",,,,,"search sourcetype=aws:cloudtrail eventName=AssumeRole | spath output=requestingAccountId path=userIdentity.accountId | spath output=requestedAccountId path=resources{}.accountId | search requestingAccountId=* | where requestingAccountId != requestedAccountId | inputlookup append=t previously_seen_aws_cross_account_activity | multireport [| stats min(eval(coalesce(firstTime, strptime(_time,""%Y-%m-%d %H:%M:%S"")))) as firstTime max(eval(coalesce(strptime(_time,""%Y-%m-%d %H:%M:%S""), lastTime))) as lastTime by requestingAccountId, requestedAccountId | outputlookup previously_seen_aws_cross_account_activity | where fact=fiction] [| eventstats min(eval(coalesce(firstTime, strptime(_time,""%Y-%m-%d %H:%M:%S"")))) as firstTime, max(eval(coalesce(strptime(_time,""%Y-%m-%d %H:%M:%S""), lastTime))) as lastTime by requestingAccountId, requestedAccountId | where firstTime >= relative_time(now(), ""-70m@m"") AND isnotnull(_time) | spath output=accessKeyId path=responseElements.credentials.accessKeyId | spath output=requestingARN path=resources{}.ARN | stats values(awsRegion) as awsRegion values(firstTime) as firstTime values(lastTime) as lastTime values(sharedEventID) as sharedEventID, values(requestingARN) as src_user, values(responseElements.assumedRoleUser.arn) as dest_user by _time, requestingAccountId, requestedAccountId, accessKeyId] | table _time, firstTime, lastTime, src_user, requestingAccountId, dest_user, requestedAccountId, awsRegion, accessKeyId, sharedEventID"
"Splunk ES Content Update - Correlations","AWS Network Access Control List Created with All Open Ports","The search looks for CloudTrail events to detect if any network ACLs were created with all the ports open to a specified CIDR.",,"AWS | Audit Trail",,"Cloud Security | SaaS","Advanced Threat Detection",Persistence,"Actions on Objectives",,,,,"search sourcetype=aws:cloudtrail eventName=CreateNetworkAclEntry | mvexpand requestParameters | mvexpand responseElements | search requestParameters.portRange.from=1024 requestParameters.portRange.to=65535 requestParameters.ruleAction=allow | rename userIdentity.arn as arn | rename requestParameters.networkAclId as networkAclId | table _time aws_account_id src userName arn networkAclId requestParameters.* responseElements.*"
"Splunk ES Content Update - Correlations","AWS Network Access Control List Deleted","Enforcing network-access controls is one of the defensive mechanisms used by cloud administrators to restrict access to a cloud instance. After the attacker has gained control of the AWS console by compromising an admin account, they can delete a network ACL and gain access to the instance from anywhere. This search will query the CloudTrail logs to detect users deleting network ACLs.",,"AWS | Audit Trail",,"Cloud Security | SaaS","Advanced Threat Detection",Persistence,"Actions on Objectives",,,,,"search sourcetype=aws:cloudtrail eventName=DeleteNetworkAcl|rename userIdentity.arn as arn  | stats count min(_time) as firstTime max(_time) as lastTime values(errorMessage) values(errorCode) values(userAgent) values(userIdentity.*) by src userName arn eventName | `security_content_ctime(lastTime)` | `security_content_ctime(firstTime)`"
"Splunk ES Content Update - Correlations","Batch File Write to System32","The search looks for a batch file (.bat) written to the Windows system directory tree.",Endpoint,"Endpoint Detection and Response",,"Malware | ","Security Monitoring",None,Delivery,,,,," tstats `security_content_summariesonly` count min(_time) as firstTime max(_time) as lastTime values(Filesystem.dest) as dest values(Filesystem.file_name) as file_name values(Filesystem.user) as user from datamodel=Endpoint.Filesystem by Filesystem.file_path | `drop_dm_object_name(Filesystem)` | `security_content_ctime(lastTime)` | `security_content_ctime(firstTime)`| rex field=file_name ""(?<file_extension>\.[^\.]+)$"" | search file_path=*system32* AND file_extension=.bat"
"Splunk ES Content Update - Correlations","Child Processes of Spoolsv.exe","This search looks for child processes of spoolsv.exe. This activity is associated with a POC privilege-escalation exploit associated with CVE-2018-8440. Spoolsv.exe is the process associated with the Print Spooler service in Windows and typically runs as SYSTEM.",Endpoint,"Endpoint Detection and Response",,"Adversary Tactics | ","Advanced Threat Detection","Privilege Escalation",Exploitation,,,,," tstats `security_content_summariesonly` count values(Processes.process_name) as process_name values(Processes.process) as process min(_time) as firstTime max(_time) as lastTime from datamodel=Endpoint.Processes where Processes.parent_process_name=spoolsv.exe AND Processes.process_name!=regsvr32.exe by Processes.dest Processes.parent_process Processes.user | `drop_dm_object_name(Processes)` | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)` | `children_of_spoolsv_filter`"
"Splunk ES Content Update - Correlations","Clients Connecting to Multiple DNS Servers","This search allows you to identify the endpoints that have connected to more than five DNS servers and made DNS Queries over the time frame of the search.","Network_Resolution",DNS,,"Command and Control","Advanced Threat Detection","Command and Control | Exfiltration","Command and Control",,,,," tstats `security_content_summariesonly` count, values(DNS.dest) AS dest dc(DNS.dest) as dest_count from datamodel=Network_Resolution where DNS.message_type=QUERY by DNS.src | `drop_dm_object_name(""Network_Resolution"")` |where dest_count > 5 | `clients_connecting_to_multiple_dns_servers_output_filter`"
"Splunk ES Content Update - Correlations","Cloud Compute Instance Created By Previously Unseen User","This search looks for cloud compute instances created by users who have not created them before.","Cloud_Infrastructure","",,"Cloud Security","Security Monitoring",None,None,,,,," tstats `security_content_summariesonly` earliest(_time) as firstTime, latest(_time) as lastTime values(Compute.dest) as dest from datamodel=Cloud_Infrastructure.Compute where Compute.action=run by Compute.src_user | `drop_dm_object_name(""Compute"")` | inputlookup append=t previously_seen_cloud_compute_creations_by_user  | stats min(firstTime) as firstTime max(lastTime) as lastTime, values(dest) as dest by src_user | multireport [| table src_user, firstTime, lastTime | outputlookup previously_seen_cloud_compute_creations_by_user | where fact=fiction][| eval new_user=if(firstTime >= relative_time(now(), `previously_seen_cloud_compute_creations_by_user_search_window_begin_offset`), 1, 0) | where new_user=1 | `security_content_ctime(firstTime)`|`security_content_ctime(lastTime)`] | table src_user, dest, firstTime, lastTime"
"Splunk ES Content Update - Correlations","Cloud Compute Instance Created With Previously Unseen Image","This search looks for cloud compute instances being created with previously unseen image IDs.","Cloud_Infrastructure","",,"Cloud Security","Security Monitoring",None,None,,,,," tstats earliest(_time) as firstTime, latest(_time) as lastTime values(Compute.dest) as dest from datamodel=Cloud_Infrastructure.Compute where Compute.action=run `previously_seen_cloud_compute_image_input_filter` by Compute.image_id, Compute.src_user | `drop_dm_object_name(""Compute"")` | inputlookup append=t previously_seen_cloud_compute_images | stats min(firstTime) as firstTime max(lastTime) as lastTime, values(dest) as dest by image_id, src_user | multireport [| table image_id, firstTime, lastTime | outputlookup previously_seen_cloud_compute_images | where fact=fiction][| eval new_image=if(firstTime >= relative_time(now(), `previously_seen_cloud_compute_image_search_window_begin_offset`), 1, 0) | where new_image=1 | `security_content_ctime(firstTime)`|`security_content_ctime(lastTime)`] | table image_id, dest, src_user, firstTime, lastTime"
"Splunk ES Content Update - Correlations","Cloud Compute Instance Created With Previously Unseen Instance Type","Find EC2 instances being created with previously unseen instance types.","Cloud_Infrastructure","",,"Cloud Security","Security Monitoring",None,None,,,,," tstats earliest(_time) as firstTime, latest(_time) as lastTime values(Compute.dest) as dest from datamodel=Cloud_Infrastructure.Compute where Compute.event_name=RunInstances `previously_seen_cloud_compute_instance_types_input_filter` by Compute.instance_type, Compute.src_user | `drop_dm_object_name(""Compute"")` | inputlookup append=t previously_seen_cloud_compute_instance_types | stats min(firstTime) as firstTime max(lastTime) as lastTime, values(dest) as dest by instance_type, src_user | multireport [| table instance_type, firstTime, lastTime | outputlookup previously_seen_cloud_compute_instance_types | where fact=fiction][| eval new_type=if(firstTime >= relative_time(now(), `previously_seen_cloud_compute_instance_types_search_window_begin_offset`), 1, 0) | where new_type=1 | `security_content_ctime(firstTime)`|`security_content_ctime(lastTime)`] | table instance_type, dest, src_user, firstTime, lastTime"
"Splunk ES Content Update - Correlations","Cloud Compute Instance Started In Previously Unused Region","This search looks at cloud-infrastructure events where an instance is created in any region within the last hour and then compares it to a lookup file of previously seen regions where instances have been created.","Cloud_Infrastructure","",,"Cloud Security","Security Monitoring",None,"Actions on Objectives",,,,," tstats earliest(_time) as firstTime, latest(_time) as lastTime values(Compute.dest) as dest from datamodel=Cloud_Infrastructure.Compute where Compute.event_name=RunInstances `previously_seen_cloud_regions_input_filter` by Compute.region, Compute.src_user | `drop_dm_object_name(""Compute"")` | inputlookup append=t previously_seen_cloud_regions | stats min(firstTime) as firstTime max(lastTime) as lastTime, values(dest) as dest by region, src_user | multireport [| table region, firstTime, lastTime | outputlookup previously_seen_cloud_regions | where fact=fiction][| eval new_region=if(firstTime >= relative_time(now(), `previously_seen_cloud_regions_search_window_begin_offset`), 1, 0) | where new_region=1 | `security_content_ctime(firstTime)`|`security_content_ctime(lastTime)`] | table region, dest, src_user, firstTime, lastTime"
"Splunk ES Content Update - Correlations","Common Ransomware Extensions","The search looks for file modifications with extensions commonly used by Ransomware",Endpoint,"Endpoint Detection and Response",,Ransomware,"Security Monitoring",None,"Actions on Objectives",,,,," tstats `security_content_summariesonly` count min(_time) as firstTime max(_time) as lastTime values(Filesystem.user) as user values(Filesystem.dest) as dest values(Filesystem.file_path) as file_path from datamodel=Endpoint.Filesystem by Filesystem.file_name | `drop_dm_object_name(Filesystem)` | `security_content_ctime(lastTime)` | `security_content_ctime(firstTime)`| rex field=file_name ""(?<file_extension>\.[^\.]+)$"" | `ransomware_extensions` | `common_ransomware_extensions_filter`"
"Splunk ES Content Update - Correlations","Common Ransomware Notes","The search looks for files created with names matching those typically used in ransomware notes that tell the victim how to get their data back.",Endpoint,"Endpoint Detection and Response",,Ransomware,"Security Monitoring",None,"Actions on Objectives",,,,," tstats `security_content_summariesonly` count min(_time) as firstTime max(_time) as lastTime values(Filesystem.user) as user values(Filesystem.dest) as dest values(Filesystem.file_path) as file_path from datamodel=Endpoint.Filesystem by Filesystem.file_name | `drop_dm_object_name(Filesystem)` | `security_content_ctime(lastTime)` | `security_content_ctime(firstTime)`|`ransomware_notes`| `common_ransomware_notes_filter`"
"Splunk ES Content Update - Correlations","Create local admin accounts using net.exe","This search looks for the creation of local administrator accounts using net.exe.",Endpoint,"Endpoint Detection and Response",,Malware,"Security Monitoring","Execution | Persistence","Actions on Objectives",,,,," tstats `security_content_summariesonly` count values(Processes.user) as user values(Processes.parent_process) as parent_process min(_time) as firstTime max(_time) as lastTime from datamodel=Endpoint.Processes where (Processs.process_name=net.exe OR Processes.process_name=net1.exe) by Processes.process Processes.process_name Processes.dest | `drop_dm_object_name(Processes)` | `security_content_ctime(firstTime)`| `security_content_ctime(lastTime)`  | search (process=*localgroup* OR process=*/add* OR process=*user*) |`create_local_admin_via_net_filter`"
"Splunk ES Content Update - Correlations","Create or delete windows shares using net.exe","This search looks for the creation or deletion of hidden shares using net.exe.",Endpoint,"Endpoint Detection and Response",,"Malware | ","Advanced Threat Detection",None,"Actions on Objectives",,,,," tstats `security_content_summariesonly` count values(Processes.user) as user values(Processes.parent_process) as parent_process min(_time) as firstTime max(_time) as lastTime from datamodel=Endpoint.Processes where (Processs.process_name=net.exe OR Processes.process_name=net1.exe) by Processes.process Processes.process_name Processes.dest | `drop_dm_object_name(Processes)` | `security_content_ctime(firstTime)`| `security_content_ctime(lastTime)` | search (process=*share* AND process=*delete*) | `create_or_delete_windows_shares_filter`"
"Splunk ES Content Update - Correlations","Create Remote Thread into LSASS","Detect remote thread creation into LSASS consistent with credential dumping.",,"Windows Security",,"Adversary Tactics | ","Advanced Threat Detection",None,"Actions on Objectives",,,,,"search `sysmon` EventID=8 TargetImage=*lsass.exe | stats count min(_time) as firstTime max(_time) as lastTime by Computer, EventCode, TargetImage, TargetProcessId | rename Computer as dest | `security_content_ctime(firstTime)`| `security_content_ctime(lastTime)` |`create_remote_thread_into_lsass_filter`"
"Splunk ES Content Update - Correlations","Creation of Shadow Copy","Monitor for signs that Ntdsutil, Vssadmin, or Wmic has been used to create a shadow copy.",Endpoint,"Endpoint Detection and Response",,"Adversary Tactics | ","Advanced Threat Detection",None,"Actions on Objectives",,,,," tstats `security_content_summariesonly` count min(_time) as firstTime max(_time) as lastTime from datamodel=Endpoint.Processes where (Processes.process_name=ntdsutil.exe Processes.process=*ntds* Processes.process=*create*) OR (Processes.process_name=vssadmin.exe Processes.process=*create* Processes.process=*shadow*) OR (Processes.process_name=wmic.exe Processes.process=*shadowcopy* Processes.process=*create*) by Processes.dest Processes.user Processes.process_name Processes.process  Processes.parent_process Processes.process_id Processes.parent_process_id | `drop_dm_object_name(Processes)` | `security_content_ctime(firstTime)`| `security_content_ctime(lastTime)` | `creation_of_shadow_copy_filter`"
"Splunk ES Content Update - Correlations","Creation of Shadow Copy with wmic and powershell","This search detects the use of wmic and Powershell to create a shadow copy.",,"Windows Security",,"Adversary Tactics | ","Advanced Threat Detection",None,"Actions on Objectives",,,,,"search `sysmon` Message=*win32_shadowcopy* Message=*Create* | stats count min(_time) as firstTime max(_time) as lastTime by dvc User EventCode Message | rename User as user, dvc as dest | `security_content_ctime(firstTime)`| `security_content_ctime(lastTime)` | `creation_of_shadow_copy_with_wmic_and_powershell_filter`"
"Splunk ES Content Update - Correlations","Credential Dumping via Copy Command from Shadow Copy","This search detects credential dumping using copy command from a shadow copy.",Endpoint,"Endpoint Detection and Response",,"Adversary Tactics | ","Advanced Threat Detection",None,"Actions on Objectives",,,,," tstats `security_content_summariesonly` count min(_time) as firstTime max(_time) as lastTime from datamodel=Endpoint.Processes where Processes.process_name=cmd.exe (Processes.process=*\\system32\\config\\sam* OR Processes.process=*\\system32\\config\\security* OR Processes.process=*\\system32\\config\\system* OR Processes.process=*\\windows\\ntds\\ntds.dit*) by Processes.dest Processes.user Processes.process_name Processes.process  Processes.parent_process Processes.process_id Processes.parent_process_id | `drop_dm_object_name(Processes)` | `security_content_ctime(firstTime)`| `security_content_ctime(lastTime)` | `cred_dump_via_copy_from_shadowcopy_filter`"
"Splunk ES Content Update - Correlations","Credential Dumping via Symlink to Shadow Copy","This search detects the creation of a symlink to a shadow copy.",Endpoint,"Endpoint Detection and Response",,"Adversary Tactics | ","Advanced Threat Detection",None,"Actions on Objectives",,,,," tstats `security_content_summariesonly` count min(_time) as firstTime max(_time) as lastTime from datamodel=Endpoint.Processes where Processes.process_name=cmd.exe Processes.process=*mklink* Processes.process=*HarddiskVolumeShadowCopy* by Processes.dest Processes.user Processes.process_name Processes.process  Processes.parent_process Processes.process_id Processes.parent_process_id | `drop_dm_object_name(Processes)` | `security_content_ctime(firstTime)`| `security_content_ctime(lastTime)` | `cred_dump_via_symlink_shadowcopy_filter`"
"Splunk ES Content Update - Correlations","Deleting Shadow Copies","The vssadmin.exe utility is used to interact with the Volume Shadow Copy Service.  Wmic is an interface to the Windows Management Instrumentation.  This search looks for either of these tools being used to delete shadow copies.",Endpoint,"Endpoint Detection and Response",,Ransomware,"Security Monitoring",Execution,"Actions on Objectives",,,,," tstats `security_content_summariesonly` count values(Processes.process) as process values(Processes.parent_process) as parent_process min(_time) as firstTime max(_time) as lastTime from datamodel=Endpoint.Processes where (Processes.process_name=vssadmin.exe OR Processes.process_name=wmic.exe)  by Processes.user Processes.process_name Processes.parent_process_name Processes.dest  | `drop_dm_object_name(Processes)` | `security_content_ctime(firstTime)`| `security_content_ctime(lastTime)` | search process=*delete* AND process=*shadow*"
"Splunk ES Content Update - Correlations","Detect Activity Related to Pass the Hash Attacks","This search looks for specific authentication events from the Windows Security Event logs to detect potential attempts at using the Pass-the-Hash technique.",,"Windows Security",,"Lateral Movement","Advanced Threat Detection","Lateral Movement","Actions on Objectives",,,,,"search `wineventlog_security` EventCode=4624 (Logon_Type=3 LogonProcessName=NtLmSsp WorkstationName=WORKSTATION NOT AccountName=""ANONYMOUS LOGON"") OR (EventCode=4624 Logon_Type=9 LogonProcessName=seclogo) | stats count min(_time) as firstTime max(_time) as lastTime by EventCode, Logon_Type, WorkstationName, user, dest | `security_content_ctime(firstTime)`| `security_content_ctime(lastTime)` | `detect_activity_related_to_pass_the_hash_attacks_filter`"
"Splunk ES Content Update - Correlations","Detect API activity from users without MFA","This search looks for CloudTrail events where a user logged into the AWS account, is making API calls and has not enabled Multi Factor authentication. Multi factor authentication adds a layer of security by forcing the users to type a unique authentication code from an approved authentication device when they access AWS websites or services. AWS Best Practices recommend that you enable MFA for privileged IAM users.",,"AWS | Audit Trail",,"Cloud Security | SaaS","Advanced Threat Detection",Execution,None,,,,,"search sourcetype=aws:cloudtrail userIdentity.sessionContext.attributes.mfaAuthenticated=false | search NOT [| inputlookup aws_service_accounts | fields identity | rename identity as user]| stats  count min(_time) as firstTime max(_time) as lastTime values(eventName) as eventName by userIdentity.arn userIdentity.type user | `security_content_ctime(firstTime)`  | `security_content_ctime(lastTime)`"
"Splunk ES Content Update - Correlations","Detect attackers scanning for vulnerable JBoss servers","This search looks for specific GET or HEAD requests to web servers that are indicative of reconnaissance attempts to identify vulnerable JBoss servers. JexBoss is described as the exploit tool of choice for this malicious activity.",Web,"Web Server",,Scanning,"Security Monitoring",Discovery,Reconnaissance,,,,," tstats `security_content_summariesonly` count min(_time) as firstTime max(_time) as lastTime from datamodel=Web where (Web.http_method=""GET"" OR Web.http_method=""HEAD"") AND (Web.url=""*/web-console/ServerInfo.jsp*"" OR Web.url=""*web-console*"" OR Web.url=""*jmx-console*"" OR Web.url = ""*invoker*"") by Web.http_method, Web.url, Web.src, Web.dest | `drop_dm_object_name(""Web"")` | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)`"
"Splunk ES Content Update - Correlations","Detect AWS API Activities From Unapproved Accounts","This search looks for successful CloudTrail activity by user accounts that are not listed in the identity table or `aws_service_accounts.csv`. It returns event names and count, as well as the first and last time a specific user or service is detected, grouped by users.",,"AWS | Audit Trail",,"Cloud Security | SaaS","Advanced Threat Detection","Credential Access | Execution","Actions on Objectives",,,,,"search sourcetype=aws:cloudtrail errorCode=success | rename userName as identity | search NOT [| inputlookup identity_lookup_expanded | fields identity] | search NOT [| inputlookup aws_service_accounts | fields identity] | rename identity as user | stats count min(_time) as firstTime max(_time) as lastTime values(eventName) as eventName by user | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)`"
"Splunk ES Content Update - Correlations","Detect AWS Console Login by User from New City","This search looks for CloudTrail events wherein a console login event by a user was recorded within the last hour, then compares the event to a lookup file of previously seen users (by ARN values) who have logged into the console. The alert is fired if the user has logged into the console for the first time within the last hour",,"AWS | Audit Trail",,"Cloud Security | SaaS","Security Monitoring",None,"Actions on Objectives",,,,," inputlookup previously_seen_users_console_logins.csv | stats min(firstTime) as firstTime max(lastTime) as lastTime by user City | join user type=outer [| inputlookup previously_seen_users_console_logins.csv | stats min(firstTime) AS earliestseen by user | fields earliestseen user] | eval userStatus=if(firstTime >= relative_time(now(), ""@d""), ""New City"",""Previously Seen City"") | eval UserData=if(earliestseen >= relative_time(now(), ""@d"") OR isnull(earliestseen), ""New User"",""Old User"") | where userStatus=""New City"" AND UserData=""Old User"" | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)`| `security_content_ctime(earliestseen)` | table user City userStatus firstTime lastTime earliestseen"
"Splunk ES Content Update - Correlations","Detect AWS Console Login by User from New Country","This search looks for CloudTrail events wherein a console login event by a user was recorded within the last hour, then compares the event to a lookup file of previously seen users (by ARN values) who have logged into the console. The alert is fired if the user has logged into the console for the first time within the last hour",,"AWS | Audit Trail",,"Cloud Security | SaaS","Security Monitoring",None,"Actions on Objectives",,,,," inputlookup previously_seen_users_console_logins.csv | stats min(firstTime) as firstTime max(lastTime) as lastTime by user Country | join user type=outer [| inputlookup previously_seen_users_console_logins.csv | stats min(firstTime) AS earliestseen by user | fields earliestseen user] | eval userStatus=if(firstTime >= relative_time(now(), ""@d""), ""New Country"",""Previously Seen Country"") | eval UserData=if(earliestseen >= relative_time(now(), ""@d"") OR isnull(earliestseen), ""New User"",""Old User"") | where userStatus=""New Country"" AND UserData=""Old User"" | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)`|`security_content_ctime(earliestseen)` | table user Country userStatus firstTime lastTime earliestseen"
"Splunk ES Content Update - Correlations","Detect AWS Console Login by User from New Region","This search looks for CloudTrail events wherein a console login event by a user was recorded within the last hour, then compares the event to a lookup file of previously seen users (by ARN values) who have logged into the console. The alert is fired if the user has logged into the console for the first time within the last hour",,"AWS | Audit Trail",,"Cloud Security | SaaS","Security Monitoring",None,"Actions on Objectives",,,,," inputlookup previously_seen_users_console_logins.csv | stats min(firstTime) as firstTime max(lastTime) as lastTime by user Region | join user type=outer [| inputlookup previously_seen_users_console_logins.csv | stats min(firstTime) AS earliestseen by user | fields earliestseen user] | eval userStatus=if(firstTime >= relative_time(now(), ""@d""), ""New Region"",""Previously Seen Region"") | eval UserData=if(earliestseen >= relative_time(now(), ""@d"") OR isnull(earliestseen), ""New User"",""Old User"") | where userStatus=""New Region"" AND UserData=""Old User"" | `security_content_ctime(firstTime)`| `security_content_ctime(lastTime)` | `security_content_ctime(earliestseen)` | table user Region userStatus firstTime lastTime earliestseen"
"Splunk ES Content Update - Correlations","Detect Credential Dumping through LSASS access","This search looks for reading lsass memory consistent with credential dumping.",,"Windows Security",,"Adversary Tactics | ","Advanced Threat Detection",None,"Actions on Objectives",,,,,"search `sysmon` EventCode=10 TargetImage=*lsass.exe (GrantedAccess=0x1010 OR GrantedAccess=0x1410) | stats count min(_time) as firstTime max(_time) as lastTime by Computer, SourceImage, SourceProcessId, TargetImage, TargetProcessId, EventCode, GrantedAccess | rename Computer as dest | `security_content_ctime(firstTime)`| `security_content_ctime(lastTime)` | `detect_credential_dumping_through_LSASS_access_filter`"
"Splunk ES Content Update - Correlations","Detect DNS requests to Phishing Sites leveraging EvilGinx2","This search looks for DNS requests for phishing domains that are leveraging EvilGinx tools to mimic websites.",Web,DNS,,"Adversary Tactics | ","Advanced Threat Detection",None,"Delivery | Command and Control",,,,," tstats `security_content_summariesonly` count min(_time) as firstTime max(_time) as lastTime values(DNS.answer) as answer from datamodel=Network_Resolution.DNS by DNS.dest DNS.src DNS.query host | `drop_dm_object_name(DNS)`| rex field=query "".*?(?<domain>[^./:]+\.(\S{2,3}|\S{2,3}.\S{2,3}))$"" | stats count values(query) as query by domain dest src answer| search `evilginx_phishlets_amazon` OR `evilginx_phishlets_facebook` OR `evilginx_phishlets_github` OR `evilginx_phishlets_0365` OR `evilginx_phishlets_outlook` OR `evilginx_phishlets_aws` OR `evilginx_phishlets_google` | search NOT [ inputlookup legit_domains.csv | fields domain]| join domain type=outer [| tstats count `security_content_summariesonly` values(Web.url) as url from datamodel=Web.Web by Web.dest Web.site | rename ""Web.*"" as * | rex field=site "".*?(?<domain>[^./:]+\.(\S{2,3}|\S{2,3}.\S{2,3}))$"" | table dest domain url] | table count src dest query answer domain url"
"Splunk ES Content Update - Correlations","Detect Excessive Account Lockouts From Endpoint","This search identifies endpoints that have caused a relatively high number of account lockouts in a short period.",Change,Authentication,,"Account Compromise","Security Monitoring",None,None,,,,," tstats `security_content_summariesonly` count min(_time) as firstTime max(_time) as lastTime from datamodel=Change.All_Changes where nodename=All_Changes.Account_Management All_Changes.result=""lockout"" by All_Changes.dest All_Changes.result |`drop_dm_object_name(""All_Changes"")` |`drop_dm_object_name(""Account_Management"")`| `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)` | search count > 5"
"Splunk ES Content Update - Correlations","Detect Excessive User Account Lockouts","This search detects user accounts that have been locked out a relatively high number of times in a short period.",Change,Authentication,,"Account Compromise","Security Monitoring",None,None,,,,," tstats `security_content_summariesonly` count min(_time) as firstTime max(_time) as lastTime from datamodel=Change.All_Changes where nodename=All_Changes.Account_Management All_Changes.result=""lockout"" by All_Changes.user All_Changes.result |`drop_dm_object_name(""All_Changes"")` |`drop_dm_object_name(""Account_Management"")`| `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)` | search count > 5"
"Splunk ES Content Update - Correlations","Detect hosts connecting to dynamic domain providers","Malicious actors often abuse legitimate Dynamic DNS services to host malicious payloads or interactive command and control nodes. Attackers will automate domain resolution changes by routing dynamic domains to countless IP addresses to circumvent firewall blocks, blacklists as well as frustrate a network defenders analytic and investigative processes. This search will look for DNS queries made from within your infrastructure to suspicious dynamic domains.","Network_Resolution",DNS,,"Command and Control","Advanced Threat Detection","Exfiltration | Defense Evasion","Command and Control | Actions on Objectives",,,,," tstats `security_content_summariesonly` count values(DNS.answer) as answer min(_time) as firstTime from datamodel=Network_Resolution by DNS.src, DNS.query | `drop_dm_object_name(""DNS"")` | `security_content_ctime(firstTime)` | `dynamic_dns_providers`"
"Splunk ES Content Update - Correlations","Detect Large Outbound ICMP Packets","This search looks for outbound ICMP packets with a packet size larger than 1,000 bytes. Various threat actors have been known to use ICMP as a command and control channel for their attack infrastructure. Large ICMP packets from an endpoint to a remote host may be indicative of this activity.","Network_Traffic","Network Communication",,"Adversary Tactics","Advanced Threat Detection","Command and Control","Command and Control",,,,," tstats `security_content_summariesonly` count earliest(_time) as firstTime latest(_time) as lastTime values(All_Traffic.action) values(All_Traffic.bytes) from datamodel=Network_Traffic where All_Traffic.action !=blocked All_Traffic.dest_category !=internal (All_Traffic.protocol=icmp OR All_Traffic.transport=icmp) All_Traffic.bytes > 1000 by All_Traffic.src_ip All_Traffic.dest_ip | `drop_dm_object_name(""All_Traffic"")` | search ( dest_ip!=10.0.0.0/8 AND dest_ip!=172.16.0.0/12 AND dest_ip!=192.168.0.0/16) | `security_content_ctime(firstTime)`|`security_content_ctime(lastTime)`"
"Splunk ES Content Update - Correlations","Detect Long DNS TXT Record Response","This search is used to detect attempts to use DNS tunneling, by calculating the length of responses to DNS TXT queries. Endpoints using DNS as a method of transmission for data exfiltration, command and control, or evasion of security controls can often be detected by noting unusually large volumes of DNS traffic.","Network_Resolution",DNS,,"Command and Control","Advanced Threat Detection","Command and Control | Exfiltration","Command and Control",,,,," tstats `security_content_summariesonly` count min(_time) as firstTime max(_time) as lastTime from datamodel=Network_Resolution where DNS.message_type=response AND DNS.record_type=TXT by DNS.src DNS.dest DNS.answer DNS.record_type |  `drop_dm_object_name(""DNS"")` | eval anslen=len(answer) | search anslen>100 | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)` | rename src as ""Source IP"", dest as ""Destination IP"", answer as ""DNS Answer"" anslen as ""Answer Length"" record_type as ""DNS Record Type"" firstTime as ""First Time"" lastTime as ""Last Time"" count as Count | table ""Source IP"" ""Destination IP"" ""DNS Answer"" ""DNS Record Type""  ""Answer Length"" Count ""First Time"" ""Last Time"""
"Splunk ES Content Update - Correlations","Detect malicious requests to exploit JBoss servers","This search is used to detect malicious HTTP requests crafted to exploit jmx-console in JBoss servers. The malicious requests have a long URL length, as the payload is embedded in the URL.",Web,"Web Server",,"Web Attack","Application Security","Defense Evasion",Delivery,,,,," tstats `security_content_summariesonly` count min(_time) as firstTime max(_time) as lastTime from datamodel=Web where (Web.http_method=""GET"" OR Web.http_method=""HEAD"") by Web.http_method, Web.url,Web.url_length Web.src, Web.dest | search Web.url=""*jmx-console/HtmlAdaptor?action=invokeOpByName&name=jboss.admin*import*"" AND Web.url_length > 200 | `drop_dm_object_name(""Web"")` | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)` | table src, dest_ip, http_method, url, firstTime, lastTime"
"Splunk ES Content Update - Correlations","Detect Mimikatz Using Loaded Images","This search looks for reading loaded Images unique to credential dumping with Mimikatz.",,"Windows Security",,"Adversary Tactics | ","Advanced Threat Detection",None,"Actions on Objectives",,,,,"search `sysmon` EventCode=7 | stats values(ImageLoaded) as ImageLoaded values(ProcessId) as ProcessId by Computer, Image | search ImageLoaded=*WinSCard.dll ImageLoaded=*cryptdll.dll ImageLoaded=*hid.dll ImageLoaded=*samlib.dll ImageLoaded=*vaultcli.dll | rename Computer as dest | `security_content_ctime(firstTime)`| `security_content_ctime(lastTime)` | `detect_mimikatz_using_loaded_images_filter`"
"Splunk ES Content Update - Correlations","Detect Mimikatz Via PowerShell And EventCode 4703","This search looks for PowerShell requesting privileges consistent with credential dumping.",,"Windows Security",,"Adversary Tactics","Advanced Threat Detection","Credential Access","Actions on Objectives",,,,,"search eventtype=wineventlog_security signature_id=4703 Process_Name=*powershell.exe | rex field=Message ""Enabled Privileges:\s+(?<privs>\w+)\s+Disabled Privileges:"" | where privs=""SeDebugPrivilege"" | stats count min(_time) as firstTime max(_time) as lastTime by dest, Process_Name, privs, Process_ID, Message | rename privs as ""Enabled Privilege"" | rename Process_Name as process |  `security_content_ctime(firstTime)`| `security_content_ctime(lastTime)`"
"Splunk ES Content Update - Correlations","Detect mshta.exe running scripts in command-line arguments","This search looks for the execution of ""mshta.exe"" with command-line arguments that launch a script. The search will return the first time and last time these command-line arguments were used for these executions, as well as the target system, the user, process ""mshta.exe"" and its parent process.",Endpoint,"Endpoint Detection and Response",,"Adversary Tactics","Advanced Threat Detection","Execution | Persistence",Exploitation,,,,," tstats `security_content_summariesonly` count values(Processes.process) as process values(Processes.parent_process) as parent_process min(_time) as firstTime max(_time) as lastTime from datamodel=Endpoint.Processes where Processes.process_name=mshta.exe by Processes.user Processes.process_name Processes.parent_process_name Processes.dest  | `drop_dm_object_name(Processes)` | `security_content_ctime(firstTime)`| `security_content_ctime(lastTime)`| search (process=*vbscript* OR process=*javascript*)"
"Splunk ES Content Update - Correlations","Detect new API calls from user roles","This search detects new API calls that have either never been seen before or that have not been seen in the previous hour, where the identity type is `AssumedRole`.",,"AWS | Audit Trail",,"Cloud Security | SaaS","Advanced Threat Detection",None,None,,,,,"search sourcetype=aws:cloudtrail eventType=AwsApiCall errorCode=success userIdentity.type=AssumedRole [search sourcetype=aws:cloudtrail eventType=AwsApiCall errorCode=success  userIdentity.type=AssumedRole | stats earliest(_time) as earliest latest(_time) as latest by userName eventName |  inputlookup append=t previously_seen_api_calls_from_user_roles | stats min(earliest) as earliest, max(latest) as latest by userName eventName | outputlookup previously_seen_api_calls_from_user_roles| eval newApiCallfromUserRole=if(earliest>=relative_time(now(), ""-70m@m""), 1, 0) | where newApiCallfromUserRole=1 | `security_content_ctime(earliest)` | `security_content_ctime(latest)` | table eventName userName]  |rename userName as user| stats values(eventName) earliest(_time) as earliest latest(_time) as latest by user | `security_content_ctime(earliest)` | `security_content_ctime(latest)`"
"Splunk ES Content Update - Correlations","Detect New Local Admin account","This search looks for newly created accounts that have been elevated to local administrators.",,"Windows Security",,Malware,"Security Monitoring","Defense Evasion | Persistence","Actions on Objectives | Command and Control",,,,,"search eventtype = wineventlog_security signature_id=4720 OR (signature_id=4732 Group_Name= Administrators) | transaction Security_ID connected=false maxspan=180m | search signature_id=4720 signature_id=4732 | table _time user dest signature_id Security_ID Group_Name src_user Message"
"Splunk ES Content Update - Correlations","Detect New Login Attempts to Routers","The search queries the authentication logs for assets that are categorized as routers in the ES Assets and Identity Framework, to identify connections that have not been seen before in the last 30 days.",Authentication,Authentication,,Operations,"Security Monitoring",None,"Actions on Objectives",,,,," tstats `security_content_summariesonly` count earliest(_time) as earliest latest(_time) as latest from datamodel=Authentication where Authentication.dest_category=router by Authentication.dest Authentication.user| eval isOutlier=if(earliest >= relative_time(now(), ""-30d@d""), 1, 0) | where isOutlier=1| `security_content_ctime(earliest)`| `security_content_ctime(latest)` | `drop_dm_object_name(""Authentication"")`"
"Splunk ES Content Update - Correlations","Detect New Open S3 buckets","This search looks for CloudTrail events where a user has created an open/public S3 bucket.",,"AWS | Audit Trail",,"Cloud Security | SaaS","Advanced Threat Detection","Execution | Initial Access | Exfiltration","Actions on Objectives",,,,,"search sourcetype=aws:cloudtrail AllUsers eventName=PutBucketAcl | spath output=userIdentityArn path=userIdentity.arn | spath output=bucketName path=requestParameters.bucketName | spath output=aclControlList path=requestParameters.AccessControlPolicy.AccessControlList | spath input=aclControlList output=grantee path=Grant{} | mvexpand grantee | spath input=grantee | search Grantee.URI=*AllUsers | rename userIdentityArn as user| table _time, src,awsRegion Permission, Grantee.URI, bucketName, user"
"Splunk ES Content Update - Correlations","Detect new user AWS Console Login","This search looks for CloudTrail events wherein a console login event by a user was recorded within the last hour, then compares the event to a lookup file of previously seen users (by ARN values) who have logged into the console. The alert is fired if the user has logged into the console for the first time within the last hour",,"AWS | Audit Trail",,"Cloud Security | SaaS","Advanced Threat Detection","Credential Access","Actions on Objectives",,,,,"search sourcetype=aws:cloudtrail eventName=ConsoleLogin | rename userIdentity.arn as user | stats earliest(_time) as firstTime latest(_time) as lastTime by user | inputlookup append=t previously_seen_users_console_logins.csv  | stats min(firstTime) as firstTime max(lastTime) as lastTime by user | eval userStatus=if(firstTime >= relative_time(now(), ""-70m@m""), ""First Time Logging into AWS Console"",""Previously Seen User"") | `security_content_ctime(firstTime)`|`security_content_ctime(lastTime)`| where userStatus =""First Time Logging into AWS Console"""
"Splunk ES Content Update - Correlations","Detect Oulook.exe writing a .zip file","This search looks for execution of process `outlook.exe` where the process is writing a `.zip` file to the disk.",Endpoint,"Endpoint Detection and Response",,"Adversary Tactics | ","Advanced Threat Detection",None,"Installation | Actions on Objectives",,,,," tstats `security_content_summariesonly`  min(_time) as firstTime max(_time) as lastTime FROM datamodel=Endpoint.Processes where Processes.process_name=outlook.exe OR Processes.process_name=explorer.exe by _time span=5m Processes.parent_process_id Processes.process_id Processes.dest Processes.process_name Processes.parent_process_name Processes.user | `drop_dm_object_name(Processes)` | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)` | rename process_id as malicious_id| rename parent_process_id as outlook_id| join malicious_id type=inner[| tstats `security_content_summariesonly` count values(Filesystem.file_path) as file_path values(Filesystem.file_name) as file_name  FROM datamodel=Endpoint.Filesystem where (Filesystem.file_path=*zip*   OR Filesystem.file_name=*.lnk ) AND (Filesystem.file_path=C:\\Users* OR Filesystem.file_path=*Local\\Temp*) by  _time span=5m Filesystem.process_id Filesystem.file_hash Filesystem.dest  | `drop_dm_object_name(Filesystem)` | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)` | rename process_id as malicious_id| fields malicious_id outlook_id dest file_path file_name file_hash count file_id] | table firstTime lastTime user malicious_id outlook_id process_name parent_process_name file_name  file_path | where file_name != """" | `outlook_writing_zip_filter`"
"Splunk ES Content Update - Correlations","Detect Outbound SMB Traffic","This search looks for outbound SMB connections made by hosts within your network to the Internet. SMB traffic is used for Windows file-sharing activity. One of the techniques often used by attackers involves retrieving the credential hash using an SMB request made to a compromised server controlled by the threat actor.","Network_Traffic","Network Communication",,Malware,"Security Monitoring","Credential Access | Lateral Movement","Actions on Objectives | Command and Control",,,,," tstats `security_content_summariesonly` count earliest(_time) as earliest latest(_time) as latest values(All_Traffic.action) from datamodel=Network_Traffic where All_Traffic.action !=blocked All_Traffic.dest_category !=internal (All_Traffic.dest_port=139 OR All_Traffic.dest_port=445 OR All_Traffic.app=smb) by All_Traffic.src_ip All_Traffic.dest_ip | `drop_dm_object_name(""All_Traffic"")` | search ( dest_ip!=10.0.0.0/8 AND dest_ip!=172.16.0.0/12 AND dest_ip!=192.168.0.0/16) | `security_content_ctime(earliest)`| `security_content_ctime(latest)` | `outbound_smb_connections_filter`"
"Splunk ES Content Update - Correlations","Detect Path Interception By Creation Of program.exe","The search is looking for the creation of program.exe in the C: drive.  The creation of this file in that location may be driven by a motive to perform path interception.",Endpoint,"Endpoint Detection and Response",,"Adversary Tactics","Advanced Threat Detection","Privilege Escalation | Persistence","Actions on Objectives",,,,," tstats `security_content_summariesonly` count min(_time) as firstTime max(_time) as lastTime values(Filesystem.user) as user values(Filesystem.dest) as dest values(Filesystem.file_hash) as file_hash values(Filesystem.file_path) as file_path from datamodel=Endpoint.Filesystem where Filesystem.file_path=""C:\\program.exe"" by Filesystem.file_name | `drop_dm_object_name(Filesystem)` | `security_content_ctime(lastTime)` | `security_content_ctime(firstTime)`"
"Splunk ES Content Update - Correlations","Detect processes used for System Network Configuration Discovery","This search looks for fast execution of processes used for system network configuration discovery on the endpoint.",Endpoint,"Endpoint Detection and Response",,"Malware | ","Security Monitoring",Execution,"Installation | Command and Control | Actions on Objectives",,,,," tstats `security_content_summariesonly` count values(Processes.process) as process values(Processes.parent_process) as parent_process min(_time) as firstTime max(_time) as lastTime from datamodel=Endpoint.Processes by Processes.dest Processes.process_name Processes.user _time | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)` | `drop_dm_object_name(Processes)` | search `system_network_configuration_discovery_tools` | transaction dest connected=false maxpause=5m |where eventcount>=5 | table firstTime lastTime dest user process_name process parent_process eventcount"
"Splunk ES Content Update - Correlations","Detect Prohibited Applications Spawning cmd.exe","This search looks for executions of cmd.exe spawned by a process that is often abused by attackers and that does not typically launch cmd.exe.",Endpoint,"Endpoint Detection and Response",,"Endpoint Compromise","Advanced Threat Detection",Execution,Exploitation,,,,," tstats `security_content_summariesonly` count values(Processes.process) as process min(_time) as firstTime max(_time) as lastTime from datamodel=Endpoint.Processes where Processes.process_name=cmd.exe by Processes.parent_process_name Processes.process_name Processes.dest Processes.user| `drop_dm_object_name(Processes)` | `security_content_ctime(firstTime)`| `security_content_ctime(lastTime)` |search [`prohibited_apps_launching_cmd`]"
"Splunk ES Content Update - Correlations","Detect PsExec With accepteula Flag","This search looks for events where `PsExec.exe` is run with the `accepteula` flag in the command line. PsExec is a built-in Windows utility that enables you to execute processes on other systems. It is fully interactive for console applications. This tool is widely used for launching interactive command prompts on remote systems. Threat actors leverage this extensively for executing code on compromised systems. If an attacker is running PsExec for the first time, they will be prompted to accept the end-user license agreement (EULA), which can be passed as the argument `accepteula` within the command line.",Endpoint,"Endpoint Detection and Response",,Malware,"Security Monitoring",Execution,"Actions on Objectives",,,,," tstats `security_content_summariesonly` values(Processes.process) as process min(_time) as firstTime max(_time) as lastTime from datamodel=Endpoint.Processes where Processes.process_name = PsExec.exe Processes.process = ""*accepteula*"" by Processes.process_name Processes.dest  Processes.parent_process_name | `drop_dm_object_name(Processes)`| `security_content_ctime(firstTime)`| `security_content_ctime(lastTime)`"
"Splunk ES Content Update - Correlations","Detect Rare Executables","This search will return a table of rare processes, the names of the systems running them, and the users who initiated each process.",Endpoint,"Endpoint Detection and Response",,"Unauthorized Software","Security Monitoring",Execution,"Installation | Command and Control | Actions on Objectives",,,,," tstats `security_content_summariesonly` count values(Processes.dest) as dest values(Processes.user) as user min(_time) as firstTime max(_time) as lastTime from datamodel=Endpoint.Processes by Processes.process_name  | rename Processes.process_name as process | rex field=user ""(?<user_domain>.*)\\\\(?<user_name>.*)"" | `security_content_ctime(firstTime)`| `security_content_ctime(lastTime)`| search [| tstats count from datamodel=Endpoint.Processes by Processes.process_name | rare Processes.process_name limit=30 | rename Processes.process_name as process| `filter_rare_process_whitelist`| table process ] | `rare_executables_on_endpoint_filter`"
"Splunk ES Content Update - Correlations","Detect S3 access from a new IP","This search looks at S3 bucket-access logs and detects new or previously unseen remote IP addresses that have successfully accessed an S3 bucket.",,"Web Server | AWS | Audit Trail",,"Cloud Security | SaaS","Advanced Threat Detection","Execution | Exfiltration","Actions on Objectives",,,,,"search sourcetype=aws:s3:accesslogs http_status=200  [search sourcetype=aws:s3:accesslogs http_status=200 | stats earliest(_time) as firstTime latest(_time) as lastTime by bucket_name remote_ip | inputlookup append=t previously_seen_S3_access_from_remote_ip.csv | stats min(firstTime) as firstTime, max(lastTime) as lastTime by bucket_name remote_ip | outputlookup previously_seen_S3_access_from_remote_ip.csv | eval newIP=if(firstTime >= relative_time(now(), ""-70m@m""), 1, 0) | where newIP=1 | `security_content_ctime(firstTime)`| `security_content_ctime(lastTime)` | table bucket_name remote_ip]| iplocation remote_ip |rename remote_ip as src_ip | table _time bucket_name src_ip City Country operation request_uri"
"Splunk ES Content Update - Correlations","Detect Spike in AWS API Activity","This search will detect users creating spikes of API activity in your AWS environment.  It will also update the cache file that factors in the latest data.",,"AWS | Audit Trail",,"Cloud Security | SaaS","Advanced Threat Detection","Credential Access | Execution","Actions on Objectives",,,,,"search sourcetype=aws:cloudtrail eventType=AwsApiCall [search sourcetype=aws:cloudtrail eventType=AwsApiCall | spath output=arn path=userIdentity.arn | stats count as apiCalls by arn | inputlookup api_call_by_user_baseline append=t | fields - latestCount | stats values(*) as * by arn | rename apiCalls as latestCount | eval newAvgApiCalls=avgApiCalls + (latestCount-avgApiCalls)/720 | eval newStdevApiCalls=sqrt(((pow(stdevApiCalls, 2)*719 + (latestCount-newAvgApiCalls)*(latestCount-avgApiCalls))/720)) | eval avgApiCalls=coalesce(newAvgApiCalls, avgApiCalls), stdevApiCalls=coalesce(newStdevApiCalls, stdevApiCalls), numDataPoints=if(isnull(latestCount), numDataPoints, numDataPoints+1) | table arn, latestCount, numDataPoints, avgApiCalls, stdevApiCalls | outputlookup api_call_by_user_baseline | eval dataPointThreshold = 15, deviationThreshold = 3 | eval isSpike=if((latestCount > avgApiCalls+deviationThreshold*stdevApiCalls) AND numDataPoints > dataPointThreshold, 1, 0) | where isSpike=1 | rename arn as userIdentity.arn | table userIdentity.arn] | spath output=user userIdentity.arn | stats values(eventName) as eventName, count as numberOfApiCalls, dc(eventName) as uniqueApisCalled by user"
"Splunk ES Content Update - Correlations","Detect Spike in blocked Outbound Traffic from your AWS","This search will detect spike in blocked outbound network connections originating from within your AWS environment.  It will also update the cache file that factors in the latest data.",,"AWS | Audit Trail",,"Cloud Security | SaaS","Advanced Threat Detection","Exfiltration | Command and Control","Actions on Objectives | Command and Control",,,,,"search sourcetype=aws:cloudwatchlogs:vpcflow action=blocked (src_ip=10.0.0.0/8 OR src_ip=172.16.0.0/12 OR src_ip=192.168.0.0/16) ( dest_ip!=10.0.0.0/8 AND dest_ip!=172.16.0.0/12 AND dest_ip!=192.168.0.0/16)  [search  sourcetype=aws:cloudwatchlogs:vpcflow action=blocked (src_ip=10.0.0.0/8 OR src_ip=172.16.0.0/12 OR src_ip=192.168.0.0/16) ( dest_ip!=10.0.0.0/8 AND dest_ip!=172.16.0.0/12 AND dest_ip!=192.168.0.0/16)  | stats count as numberOfBlockedConnections by src_ip | inputlookup baseline_blocked_outbound_connections append=t | fields - latestCount | stats values(*) as * by src_ip | rename numberOfBlockedConnections as latestCount | eval newAvgBlockedConnections=avgBlockedConnections + (latestCount-avgBlockedConnections)/720 | eval newStdevBlockedConnections=sqrt(((pow(stdevBlockedConnections, 2)*719 + (latestCount-newAvgBlockedConnections)*(latestCount-avgBlockedConnections))/720)) | eval avgBlockedConnections=coalesce(newAvgBlockedConnections, avgBlockedConnections), stdevBlockedConnections=coalesce(newStdevBlockedConnections, stdevBlockedConnections), numDataPoints=if(isnull(latestCount), numDataPoints, numDataPoints+1) | table src_ip, latestCount, numDataPoints, avgBlockedConnections, stdevBlockedConnections | outputlookup baseline_blocked_outbound_connections | eval dataPointThreshold = 5, deviationThreshold = 3 | eval isSpike=if((latestCount > avgBlockedConnections+deviationThreshold*stdevBlockedConnections) AND numDataPoints > dataPointThreshold, 1, 0) | where isSpike=1 | table src_ip] | stats values(dest_ip) as ""Blocked Destination IPs"", values(interface_id) as ""resourceId"" count as numberOfBlockedConnections, dc(dest_ip) as uniqueDestConnections by src_ip"
"Splunk ES Content Update - Correlations","Detect Spike in Network ACL Activity","This search will detect users creating spikes in API activity related to network access-control lists (ACLs)in your AWS environment.",,"AWS | Audit Trail",,"Cloud Security | SaaS","Advanced Threat Detection","Persistence | Exfiltration","Actions on Objectives",,,,,"search sourcetype=aws:cloudtrail `network_acl_events` [search sourcetype=aws:cloudtrail `network_acl_events` | spath output=arn path=userIdentity.arn | stats count as apiCalls by arn | inputlookup network_acl_activity_baseline append=t | fields - latestCount | stats values(*) as * by arn | rename apiCalls as latestCount | eval newAvgApiCalls=avgApiCalls + (latestCount-avgApiCalls)/720 | eval newStdevApiCalls=sqrt(((pow(stdevApiCalls, 2)*719 + (latestCount-newAvgApiCalls)*(latestCount-avgApiCalls))/720)) | eval avgApiCalls=coalesce(newAvgApiCalls, avgApiCalls), stdevApiCalls=coalesce(newStdevApiCalls, stdevApiCalls), numDataPoints=if(isnull(latestCount), numDataPoints, numDataPoints+1) | table arn, latestCount, numDataPoints, avgApiCalls, stdevApiCalls | outputlookup network_acl_activity_baseline | eval dataPointThreshold = 15, deviationThreshold = 3 | eval isSpike=if((latestCount > avgApiCalls+deviationThreshold*stdevApiCalls) AND numDataPoints > dataPointThreshold, 1, 0) | where isSpike=1 | rename arn as userIdentity.arn | table userIdentity.arn] | spath output=user userIdentity.arn | stats values(eventName) as eventNames, count as numberOfApiCalls, dc(eventName) as uniqueApisCalled by user"
"Splunk ES Content Update - Correlations","Detect Spike in S3 Bucket deletion","This search detects users creating spikes in API activity related to deletion of S3 buckets in your AWS environment. It will also update the cache file that factors in the latest data.",,"AWS | Audit Trail",,"Cloud Security | SaaS","Advanced Threat Detection","Credential Access | Execution","Actions on Objectives",,,,,"search sourcetype=aws:cloudtrail eventName=DeleteBucket [search sourcetype=aws:cloudtrail eventName=DeleteBucket | spath output=arn path=userIdentity.arn | stats count as apiCalls by arn | inputlookup s3_deletion_baseline append=t | fields - latestCount | stats values(*) as * by arn | rename apiCalls as latestCount | eval newAvgApiCalls=avgApiCalls + (latestCount-avgApiCalls)/720 | eval newStdevApiCalls=sqrt(((pow(stdevApiCalls, 2)*719 + (latestCount-newAvgApiCalls)*(latestCount-avgApiCalls))/720)) | eval avgApiCalls=coalesce(newAvgApiCalls, avgApiCalls), stdevApiCalls=coalesce(newStdevApiCalls, stdevApiCalls), numDataPoints=if(isnull(latestCount), numDataPoints, numDataPoints+1) | table arn, latestCount, numDataPoints, avgApiCalls, stdevApiCalls | outputlookup s3_deletion_baseline | eval dataPointThreshold = 15, deviationThreshold = 3 | eval isSpike=if((latestCount > avgApiCalls+deviationThreshold*stdevApiCalls) AND numDataPoints > dataPointThreshold, 1, 0) | where isSpike=1 | rename arn as userIdentity.arn | table userIdentity.arn] | spath output=user userIdentity.arn | spath output=bucketName path=requestParameters.bucketName | stats values(bucketName) as bucketName, count as numberOfApiCalls, dc(eventName) as uniqueApisCalled by user"
"Splunk ES Content Update - Correlations","Detect Spike in Security Group Activity","This search will detect users creating spikes in API activity related to security groups in your AWS environment.  It will also update the cache file that factors in the latest data.",,"AWS | Audit Trail",,"Cloud Security | SaaS","Advanced Threat Detection","Credential Access | Execution","Actions on Objectives",,,,,"search sourcetype=aws:cloudtrail `security_group_api_calls` [search sourcetype=aws:cloudtrail `security_group_api_calls` | spath output=arn path=userIdentity.arn | stats count as apiCalls by arn | inputlookup security_group_activity_baseline append=t | fields - latestCount | stats values(*) as * by arn | rename apiCalls as latestCount | eval newAvgApiCalls=avgApiCalls + (latestCount-avgApiCalls)/720 | eval newStdevApiCalls=sqrt(((pow(stdevApiCalls, 2)*719 + (latestCount-newAvgApiCalls)*(latestCount-avgApiCalls))/720)) | eval avgApiCalls=coalesce(newAvgApiCalls, avgApiCalls), stdevApiCalls=coalesce(newStdevApiCalls, stdevApiCalls), numDataPoints=if(isnull(latestCount), numDataPoints, numDataPoints+1) | table arn, latestCount, numDataPoints, avgApiCalls, stdevApiCalls | outputlookup security_group_activity_baseline | eval dataPointThreshold = 15, deviationThreshold = 3 | eval isSpike=if((latestCount > avgApiCalls+deviationThreshold*stdevApiCalls) AND numDataPoints > dataPointThreshold, 1, 0) | where isSpike=1 | rename arn as userIdentity.arn | table userIdentity.arn] | spath output=user userIdentity.arn | stats values(eventName) as eventNames, count as numberOfApiCalls, dc(eventName) as uniqueApisCalled by user"
"Splunk ES Content Update - Correlations","Detect Unauthorized Assets by MAC address","By populating the organization's assets within the assets_by_str.csv, we will be able to detect unauthorized devices that are trying to connect with the organization's network by inspecting DHCP request packets, which are issued by devices when they attempt to obtain an IP address from the DHCP server. The MAC address associated with the source of the DHCP request is checked against the list of known devices, and reports on those that are not found.","Network_Sessions","IP Address Assignment",,Compliance,Compliance,"Defense Evasion","Reconnaissance | Delivery | Actions on Objectives",,,,," tstats `security_content_summariesonly` count from datamodel=Network_Sessions where nodename=All_Sessions.DHCP All_Sessions.signature=DHCPREQUEST by All_Sessions.src_ip All_Sessions.src_mac | dedup All_Sessions.src_mac| `drop_dm_object_name(""Network_Sessions"")`|`drop_dm_object_name(""All_Sessions"")` | search NOT [| inputlookup asset_lookup_by_str |rename mac as src_mac | fields + src_mac]"
"Splunk ES Content Update - Correlations","Detect USB device insertion","The search is used to detect hosts that generate Windows Event ID 4663 for successful attempts to write to or read from a removable storage and Event ID 4656 for failures, which occurs when a USB drive is plugged in. In this scenario we are querying the Change_Analysis data model to look for Windows Event ID 4656 or 4663 where the priority of the affected host is marked as high in the ES Assets and Identity Framework.","Change_Analysis","Endpoint Detection and Response | DLP",,"Data Exfiltration","Insider Threat",Exfiltration,"Installation | Actions on Objectives",,,,," tstats `security_content_summariesonly` count earliest(_time) AS earliest latest(_time) AS latest from datamodel=Change_Analysis where (nodename = All_Changes) All_Changes.result=""Removable Storage device"" (All_Changes.result_id=4663 OR All_Changes.result_id=4656) (All_Changes.src_priority=high) by All_Changes.dest | `drop_dm_object_name(""All_Changes"")`| `security_content_ctime(earliest)`| `security_content_ctime(latest)`"
"Splunk ES Content Update - Correlations","Detect Use of cmd.exe to Launch Script Interpreters","This search looks for the execution of the cscript.exe or wscript.exe processes, with a parent of cmd.exe. The search will return the count, the first and last time this execution was seen on a machine, the user, and the destination of the machine",Endpoint,"Endpoint Detection and Response",,"Endpoint Compromise","Advanced Threat Detection",Execution,Exploitation,,,,," tstats `security_content_summariesonly` count values(Processes.process) min(_time) as firstTime max(_time) as lastTime from datamodel=Endpoint.Processes where Processes.parent_process_name=""cmd.exe"" (Processes.process_name=cscript.exe OR Processes.process_name =wscript.exe) by Processes.parent_process Processes.process_name Processes.user Processes.dest | `drop_dm_object_name(""Processes"")` | `security_content_ctime(firstTime)`|`security_content_ctime(lastTime)`"
"Splunk ES Content Update - Correlations","Detect web traffic to dynamic domain providers","This search looks for web connections to dynamic DNS providers.",Web,"Web Proxy",,"Malware | ","Security Monitoring","Command and Control | Defense Evasion","Command and Control | Actions on Objectives",,,,," tstats `security_content_summariesonly` count values(Web.url) as url min(_time) as firstTime from datamodel=Web where Web.status=200 by Web.src Web.dest Web.status | `drop_dm_object_name(""Web"")` | `security_content_ctime(firstTime)` | `dynamic_dns_web_traffic`"
"Splunk ES Content Update - Correlations","Detection of DNS Tunnels","This search is used to detect DNS tunneling, by calculating the sum of the length of DNS queries and DNS answers. The search also filters out potential false positives by filtering out queries made to internal systems and the queries originating from internal DNS, Web, and Email servers. Endpoints using DNS as a method of transmission for data exfiltration, command and control, or evasion of security controls can often be detected by noting an unusually large volume of DNS traffic.","Network_Resolution",DNS,,"Command and Control","Advanced Threat Detection","Command and Control | Exfiltration","Command and Control | Actions on Objectives",,,,," tstats `security_content_summariesonly` dc(""DNS.query"") as count  from datamodel=Network_Resolution  where nodename=DNS ""DNS.message_type""=""QUERY"" NOT (`cim_corporate_web_domain_search(""DNS.query"")`) NOT ""DNS.query""=""*.in-addr.arpa"" NOT (""DNS.src_category""=""svc_infra_dns"" OR ""DNS.src_category""=""svc_infra_webproxy"" OR ""DNS.src_category""=""svc_infra_email*""   ) by ""DNS.src"",""DNS.query"" | rename ""DNS.src"" as src  ""DNS.query"" as message | eval length=len(message) | stats sum(length) as length by src | append [ tstats `security_content_summariesonly` dc(""DNS.answer"") as count  from datamodel=Network_Resolution  where nodename=DNS ""DNS.message_type""=""QUERY"" NOT (`cim_corporate_web_domain_search(""DNS.query"")`) NOT ""DNS.query""=""*.in-addr.arpa"" NOT (""DNS.src_category""=""svc_infra_dns"" OR ""DNS.src_category""=""svc_infra_webproxy"" OR ""DNS.src_category""=""svc_infra_email*""   ) by ""DNS.src"",""DNS.answer"" | rename ""DNS.src"" as src  ""DNS.answer"" as message | eval message=if(message==""unknown"","""", message) | eval length=len(message) | stats sum(length) as length by src ] | stats sum(length) as length by src | where length > 10000"
"Splunk ES Content Update - Correlations","Detection of tools built by NirSoft","This search looks for specific command-line arguments that may indicate the execution of tools made by Nirsoft, which are legitimate, but may be abused by attackers.",Endpoint,"Endpoint Detection and Response",,"Malware | ","Security Monitoring",None,"Installation | Actions on Objectives",,,,," tstats `security_content_summariesonly` count min(_time) values(Processes.process) as process max(_time) as lastTime from datamodel=Endpoint.Processes where (Processes.process=""* /stext *"" OR Processes.process=""* /scomma *"" ) by Processes.parent_process Processes.process_name Processes.user | `drop_dm_object_name(Processes)` | `security_content_ctime(firstTime)` |`security_content_ctime(lastTime)`"
"Splunk ES Content Update - Correlations","Disabling Remote User Account Control","The search looks for modifications to registry keys that control the enforcement of Windows User Account Control (UAC).",Endpoint,"Endpoint Detection and Response",,"Endpoint Compromise","Advanced Threat Detection","Defense Evasion","Actions on Objectives",,,,," tstats `security_content_summariesonly` count min(_time) as firstTime max(_time) as lastTime FROM datamodel=Endpoint.Registry where Registry.registry_path=""*Windows\\CurrentVersion\\Policies\\System\\LocalAccountTokenFilterPolicy"" by Registry.dest, Registry.registry_key_name Registry.user Registry.registry_path Registry.action | `drop_dm_object_name(Registry)`"
"Splunk ES Content Update - Correlations","DNS Query Length Outliers - MLTK","This search allows you to identify DNS requests that are unusually large for the record type being requested in your environment.","Network_Resolution",DNS,,"Adversary Tactics | ","Advanced Threat Detection",None,"Command and Control",,,,," tstats `security_content_summariesonly` count min(_time) as start_time max(_time) as end_time values(DNS.src) as src values(DNS.dest) as dest from datamodel=Network_Resolution by DNS.query DNS.record_type | search DNS.record_type=* |  `drop_dm_object_name(DNS)` | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)` | eval query_length = len(query) | apply dns_query_pdfmodel threshold=0.01 | rename ""IsOutlier(query_length)"" as isOutlier | search isOutlier > 0 | sort -query_length | table start_time end_time query record_type count src dest query_length | `dns_query_length_mltk_filter`"
"Splunk ES Content Update - Correlations","DNS Query Length With High Standard Deviation","This search allows you to identify DNS requests and compute the standard deviation on the length of the names being resolved, then filter on two times the standard deviation to show you those queries that are unusually large for your environment.","Network_Resolution",DNS,,"Command and Control","Advanced Threat Detection","Command and Control | Exfiltration","Command and Control",,,,," tstats `security_content_summariesonly` count from datamodel=Network_Resolution by DNS.query DNS.record_type |  `drop_dm_object_name(""DNS"")` | eval query_length = len(query) | table query query_length record_type count | eventstats stdev(query_length) AS stdev avg(query_length) AS avg p50(query_length) AS p50| where query_length>(avg+stdev*2) | eval z_score=(query_length-avg)/stdev | `dns_query_length_with_high_standard_deviation_filter`"
"Splunk ES Content Update - Correlations","DNS Query Requests Resolved by Unauthorized DNS Servers","This search will detect DNS requests resolved by unauthorized DNS servers. Legitimate DNS servers should be identified in the Enterprise Security Assets and Identity Framework.","Network_Resolution",DNS,,Compliance,Compliance,"Exfiltration | Command and Control | Defense Evasion","Command and Control",,,,," tstats `security_content_summariesonly` count from datamodel=Network_Resolution where DNS.dest_category != dns_server AND DNS.src_category != dns_server by DNS.src DNS.dest | `drop_dm_object_name(""DNS"")` | `unauthorized_dns_servers_filter`"
"Splunk ES Content Update - Correlations","DNS record changed","The search takes the DNS records and their answers results of the discovered_dns_records lookup and finds if any records have changed by searching DNS response from the Network_Resolution datamodel across the last day.","Network_Resolution",DNS,,"Adversary Tactics | ","Advanced Threat Detection","Exfiltration | Command and Control | Defense Evasion","Command and Control",,,,," inputlookup discovered_dns_records.csv | rename answer as discovered_answer | join domain[|tstats `security_content_summariesonly` count values(DNS.record_type) as type, values(DNS.answer) as current_answer values(DNS.src) as src from datamodel=Network_Resolution where DNS.message_type=RESPONSE DNS.answer!=""unknown"" DNS.answer!="""" by DNS.query | rename DNS.query as query | where query!=""unknown"" | rex field=query ""(?<domain>\w+\.\w+?)(?:$|/)""] | makemv delim="" "" answer |  makemv delim="" "" type | sort -count | table count,src,domain,type,query,current_answer,discovered_answer | makemv current_answer  | mvexpand current_answer | makemv discovered_answer | eval n=mvfind(discovered_answer, current_answer) | where isnull(n) | `dns_record_changed_filter`"
"Splunk ES Content Update - Correlations","Dump LSASS via comsvcs DLL","Detect the usage of comsvcs.dll for dumping the lsass process.",Endpoint,"Endpoint Detection and Response",,"Adversary Tactics | ","Advanced Threat Detection",None,"Actions on Objectives",,,,," tstats `security_content_summariesonly` count min(_time) as firstTime max(_time) as lastTime from datamodel=Endpoint.Processes where Processes.process_name=rundll32.exe Processes.process=*comsvcs.dll* Processes.process=*MiniDump* by Processes.user Processes.process_name Processes.process Processes.dest | `drop_dm_object_name(Processes)` | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)` | `dump_lsass_via_comsvcs_dll_filter`"
"Splunk ES Content Update - Correlations","EC2 Instance Modified With Previously Unseen User","This search looks for EC2 instances being modified by users who have not previously modified them.",,"AWS | Audit Trail",,"Cloud Security | SaaS","Advanced Threat Detection",None,None,,,,,"search sourcetype=aws:cloudtrail `ec2_modification_api_calls` [search sourcetype=aws:cloudtrail `ec2_modification_api_calls` errorCode=success | stats earliest(_time) as firstTime latest(_time) as lastTime by userIdentity.arn | rename userIdentity.arn as arn | inputlookup append=t previously_seen_ec2_modifications_by_user | stats min(firstTime) as firstTime, max(lastTime) as lastTime by arn | outputlookup previously_seen_ec2_modifications_by_user | eval newUser=if(firstTime >= relative_time(now(), ""-70m@m""), 1, 0) | where newUser=1 | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)` | rename arn as userIdentity.arn | table userIdentity.arn] | spath output=dest responseElements.instancesSet.items{}.instanceId | spath output=user userIdentity.arn | table _time, user, dest"
"Splunk ES Content Update - Correlations","EC2 Instance Started In Previously Unseen Region","This search looks for CloudTrail events where an instance is started in a particular region in the last one hour and then compares it to a lookup file of previously seen regions where an instance was started",,"AWS | Audit Trail",,"Cloud Security | SaaS","Advanced Threat Detection","Defense Evasion","Actions on Objectives",,,,,"search sourcetype=aws:cloudtrail earliest=-1h StartInstances | stats earliest(_time) as earliest latest(_time) as latest by awsRegion | inputlookup append=t previously_seen_aws_regions.csv | stats min(earliest) as earliest max(latest) as latest by awsRegion | outputlookup previously_seen_aws_regions.csv | eval regionStatus=if(earliest >= relative_time(now(),""-1d@d""), ""Instance Started in a New Region"",""Previously Seen Region"") | `security_content_ctime(earliest)` | `security_content_ctime(latest)` | where regionStatus=""Instance Started in a New Region"""
"Splunk ES Content Update - Correlations","EC2 Instance Started With Previously Unseen AMI","This search looks for EC2 instances being created with previously unseen AMIs.",,"AWS | Audit Trail",,"Cloud Security | SaaS","Advanced Threat Detection",None,None,,,,,"search sourcetype=aws:cloudtrail eventName=RunInstances [search sourcetype=aws:cloudtrail eventName=RunInstances errorCode=success | stats earliest(_time) as firstTime latest(_time) as lastTime by requestParameters.instancesSet.items{}.imageId | rename requestParameters.instancesSet.items{}.imageId as amiID | inputlookup append=t previously_seen_ec2_amis.csv | stats min(firstTime) as firstTime max(lastTime) as lastTime by amiID | outputlookup previously_seen_ec2_amis.csv | eval newAMI=if(firstTime >= relative_time(now(), ""-70m@m""), 1, 0) | `security_content_ctime(firstTime)`|`security_content_ctime(lastTime)` | where newAMI=1 | rename amiID as requestParameters.instancesSet.items{}.imageId | table requestParameters.instancesSet.items{}.imageId] | rename requestParameters.instanceType as instanceType, responseElements.instancesSet.items{}.instanceId as dest, userIdentity.arn as arn, requestParameters.instancesSet.items{}.imageId as amiID | table firstTime, lastTime, arn, amiID, dest, instanceType"
"Splunk ES Content Update - Correlations","EC2 Instance Started With Previously Unseen Instance Type","This search looks for EC2 instances being created with previously unseen instance types.",,"AWS | Audit Trail",,"Cloud Security | SaaS","Advanced Threat Detection",None,None,,,,,"search sourcetype=aws:cloudtrail eventName=RunInstances [search sourcetype=aws:cloudtrail eventName=RunInstances errorCode=success | fillnull value=""m1.small"" requestParameters.instanceType | stats earliest(_time) as earliest latest(_time) as latest by requestParameters.instanceType | rename requestParameters.instanceType as instanceType | inputlookup append=t previously_seen_ec2_instance_types.csv | stats min(earliest) as earliest max(latest) as latest by instanceType | outputlookup previously_seen_ec2_instance_types.csv | eval newType=if(earliest >= relative_time(now(), ""-70m@m""), 1, 0) | `security_content_ctime(earliest)` | `security_content_ctime(latest)` | where newType=1 | rename instanceType as requestParameters.instanceType | table requestParameters.instanceType] | spath output=user userIdentity.arn | rename requestParameters.instanceType as instanceType, responseElements.instancesSet.items{}.instanceId as dest | table _time, user, dest, instanceType"
"Splunk ES Content Update - Correlations","EC2 Instance Started With Previously Unseen User","This search looks for EC2 instances being created by users who have not created them before.",,"AWS | Audit Trail",,"Cloud Security | SaaS","Advanced Threat Detection",None,None,,,,,"search sourcetype=aws:cloudtrail eventName=RunInstances [search sourcetype=aws:cloudtrail eventName=RunInstances errorCode=success | stats earliest(_time) as firstTime latest(_time) as lastTime by userIdentity.arn | rename userIdentity.arn as arn | inputlookup append=t previously_seen_ec2_launches_by_user.csv | stats min(firstTime) as firstTime, max(lastTime) as lastTime by arn | outputlookup previously_seen_ec2_launches_by_user.csv | eval newUser=if(firstTime >= relative_time(now(), ""-70m@m""), 1, 0) | where newUser=1 | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)` | rename arn as userIdentity.arn | table userIdentity.arn] | rename requestParameters.instanceType as instanceType, responseElements.instancesSet.items{}.instanceId as dest, userIdentity.arn as user | table _time, user, dest, instanceType"
"Splunk ES Content Update - Correlations","Email Attachments With Lots Of Spaces","Attackers often use spaces as a means to obfuscate an attachment's file extension. This search looks for messages with email attachments that have many spaces within the file names.",Email,Email,,"Endpoint Compromise","Advanced Threat Detection",None,Delivery,,,,," tstats `security_content_summariesonly` count values(All_Email.recipient) as recipient_address min(_time) as firstTime max(_time) as lastTime from datamodel=Email where All_Email.file_name=""*"" by All_Email.src_user, All_Email.file_name All_Email.message_id | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)` | `drop_dm_object_name(""All_Email"")` | eval space_ratio = (mvcount(split(file_name,"" ""))-1)/len(file_name) | search space_ratio >= 0.1 |  rex field=recipient_address ""(?<recipient_user>.*)@"""
"Splunk ES Content Update - Correlations","Email files written outside of the Outlook directory","The search looks at the change-analysis data model and detects email files created outside the normal Outlook directory.",Endpoint,"Endpoint Detection and Response",,"Adversary Tactics","Advanced Threat Detection",Collection,"Actions on Objectives",,,,," tstats `security_content_summariesonly` count values(Filesystem.file_path) as file_path min(_time) as firstTime max(_time) as lastTime from datamodel=Endpoint.Filesystem where (Filesystem.file_name=*.pst OR Filesystem.file_name=*.ost) Filesystem.file_path != ""C:\\Users\\*\\My Documents\\Outlook Files\\*""  Filesystem.file_path!=""C:\\Users\\*\\AppData\\Local\\Microsoft\\Outlook*"" by Filesystem.action Filesystem.process_id Filesystem.file_name Filesystem.dest | `drop_dm_object_name(""Filesystem"")` | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)`| `email_files_not_in_outlook_directory_filter`"
"Splunk ES Content Update - Correlations","Email servers sending high volume traffic to hosts","This search looks for an increase of data transfers from your email server to your clients. This could be indicative of a malicious actor collecting data using your email server.","Network_Traffic","Network Communication",,"Adversary Tactics","Advanced Threat Detection",Collection,"Actions on Objectives",,,,," tstats `security_content_summariesonly` sum(All_Traffic.bytes_out) as bytes_out from datamodel=Network_Traffic where All_Traffic.src_category=email_server by All_Traffic.dest_ip _time span=1d | `drop_dm_object_name(""All_Traffic"")` | eventstats avg(bytes_out) as avg_bytes_out stdev(bytes_out) as stdev_bytes_out | eventstats count as num_data_samples avg(eval(if(_time < relative_time(now(), ""@d""), bytes_out, null))) as per_source_avg_bytes_out stdev(eval(if(_time < relative_time(now(), ""@d""), bytes_out, null))) as per_source_stdev_bytes_out by dest_ip | eval minimum_data_samples = 4, deviation_threshold = 3 | where num_data_samples >= minimum_data_samples AND bytes_out > (avg_bytes_out + (deviation_threshold * stdev_bytes_out)) AND bytes_out > (per_source_avg_bytes_out + (deviation_threshold * per_source_stdev_bytes_out)) AND _time >= relative_time(now(), ""@d"") | eval num_standard_deviations_away_from_server_average = round(abs(bytes_out - avg_bytes_out) / stdev_bytes_out, 2), num_standard_deviations_away_from_client_average = round(abs(bytes_out - per_source_avg_bytes_out) / per_source_stdev_bytes_out, 2) | table dest_ip, _time, bytes_out, avg_bytes_out, per_source_avg_bytes_out, num_standard_deviations_away_from_server_average, num_standard_deviations_away_from_client_average"
"Splunk ES Content Update - Correlations","Excessive DNS Failures","This search identifies DNS query failures by counting the number of DNS responses that do not indicate success, and trigger on more than 50 occurrences.","Network_Resolution",DNS,,"Command and Control","Advanced Threat Detection","Exfiltration | Command and Control","Command and Control",,,,," tstats `security_content_summariesonly` count values(""DNS.query"") as queries from datamodel=Network_Resolution where nodename=DNS ""DNS.reply_code""!=""No Error"" ""DNS.reply_code""!=""NoError"" DNS.reply_code!=""unknown"" NOT ""DNS.query""=""*.arpa"" ""DNS.query""=""*.*"" by ""DNS.src"",""DNS.query""| `drop_dm_object_name(""DNS"")`| lookup cim_corporate_web_domain_lookup domain as query OUTPUT domain| where isnull(domain)| lookup update=true alexa_lookup_by_str domain as query OUTPUT rank| where isnull(rank)| stats sum(count) as count mode(queries) as queries by src| `get_asset(src)`| where count>50"
"Splunk ES Content Update - Correlations","Execution of File with Multiple Extensions","This search looks for processes launched from files that have double extensions in the file name. This is typically done to obscure the ""real"" file extension and make it appear as though the file being accessed is a data file, as opposed to executable content.",Endpoint,"Endpoint Detection and Response",,Malware,"Security Monitoring","Execution | Persistence","Actions on Objectives",,,,," tstats `security_content_summariesonly` count min(_time) as firstTime max(_time) as lastTime from datamodel=Endpoint.Processes where Processes.process = *.doc.exe OR Processes.process = *.htm.exe OR Processes.process = *.html.exe OR Processes.process = *.txt.exe OR Processes.process = *.pdf.exe OR Processes.process = *.doc.exe by Processes.dest Processes.user Processes.process Processes.parent_process | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)` | `drop_dm_object_name(Processes)`"
"Splunk ES Content Update - Correlations","Execution of File With Spaces Before Extension","This search looks for processes launched from files with at least five spaces in the name before the extension. This is typically done to obfuscate the file extension by pushing it outside of the default view.",Endpoint,"Endpoint Detection and Response",,Malware,"Security Monitoring","Execution | Persistence","Actions on Objectives",,,,," tstats `security_content_summariesonly` count values(Processes.process_path) as process_path min(_time) as firstTime max(_time) as lastTime from datamodel=Endpoint.Processes where Processes.process = ""*     .*"" by Processes.dest Processes.user Processes.process Processes.process_name | `security_content_ctime(firstTime)`| `security_content_ctime(lastTime)` | `drop_dm_object_name(Processes)`"
"Splunk ES Content Update - Correlations","Extended Period Without Successful Netbackup Backups","This search returns a list of hosts that have not successfully completed a backup in over a week.",,Backup,,Compliance,Compliance,None,None,,,,,"search sourcetype=""netbackup_logs"" MESSAGE=""Disk/Partition backup completed successfully."" | stats latest(_time) as latestTime by COMPUTERNAME | `security_content_ctime(latestTime)` | rename COMPUTERNAME as dest | eval isOutlier=if(latestTime <= relative_time(now(), ""-7d@d""), 1, 0) | search isOutlier=1 | table latestTime, dest"
"Splunk ES Content Update - Correlations","File with Samsam Extension","The search looks for file writes with extensions consistent with a SamSam ransomware attack.",Endpoint,"Endpoint Detection and Response",,"Malware | ","Security Monitoring",None,Installation,,,,," tstats `security_content_summariesonly` count min(_time) as firstTime max(_time) as lastTime values(Filesystem.user) as user values(Filesystem.dest) as dest values(Filesystem.file_path) as file_path from datamodel=Endpoint.Filesystem by Filesystem.file_name | `drop_dm_object_name(Filesystem)` | `security_content_ctime(lastTime)` | `security_content_ctime(firstTime)`| rex field=file_name ""(?<file_extension>\.[^\.]+)$"" | search file_extension=.stubbin OR file_extension=.berkshire OR file_extension=.satoshi OR file_extension=.sophos OR file_extension=.keyxml"
"Splunk ES Content Update - Correlations","First time seen command line argument","This search looks for command-line arguments that use a `/c` parameter to execute a command that has not previously been seen.",Endpoint,"Endpoint Detection and Response",,"Adversary Tactics","Advanced Threat Detection","Execution | Persistence","Command and Control | Actions on Objectives",,,,," tstats `security_content_summariesonly` min(_time) as firstTime max(_time) as lastTime from datamodel=Endpoint.Processes where Processes.process_name = cmd.exe Processes.process = ""* /c *"" by Processes.process Processes.process_name Processes.parent_process_name Processes.dest| `drop_dm_object_name(Processes)`| `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)` | search [| tstats `security_content_summariesonly` earliest(_time) as firstTime latest(_time) as lastTime from datamodel=Endpoint.Processes where Processes.process_name = cmd.exe Processes.process = ""* /c *"" by Processes.process | `drop_dm_object_name(Processes)` | inputlookup append=t previously_seen_cmd_line_arguments | stats min(firstTime) as firstTime, max(lastTime) as lastTime by process | outputlookup previously_seen_cmd_line_arguments | eval newCmdLineArgument=if(firstTime >= relative_time(now(), ""-70m@m""), 1, 0) | where newCmdLineArgument=1 | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)` | table process] | `first_time_seen_cmd_line_filter`"
"Splunk ES Content Update - Correlations","First Time Seen Running Windows Service","This search looks for the first time a Windows service is seen running in your environment.",,"Windows Security",,Malware,"Security Monitoring",Execution,"Installation | Actions on Objectives",,,,,"search eventtype=wineventlog_system signature_id=7036 | rename param1 as service_name | rename param2 as action | search action=""running"" [ search eventtype=wineventlog_system signature_id=7036 | rename param1 as service_name | rename param2 as action | search action=""running"" | stats earliest(_time) as firstTime, latest(_time) as lastTime by service_name | inputlookup append=t previously_seen_running_windows_services | stats min(firstTime) as firstTime max(lastTime) as lastTime by service_name | outputlookup previously_seen_running_windows_services| eval serviceStatus=if(firstTime >= relative_time(now(),""-60m@m""), ""First time seen Windows service"",""Previously seen Windows service"") | where serviceStatus=""First time seen Windows service""| `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)` | table service_name]| table _time dest service_name"
"Splunk ES Content Update - Correlations","GCP GCR container uploaded","This search show information on uploaded containers including source user, account, action, bucket name event name, http user agent, message and destination path.","Cloud_Infrastructure","",,"Cloud Security","Security Monitoring",None,None,,,,,"tstats count min(_time) as firstTime max(_time) as lastTime  FROM datamodel=Cloud_Infrastructure.Storage where Storage.event_name=storage.objects.create by Storage.src_user Storage.account Storage.action Storage.bucket_name Storage.event_name Storage.http_user_agent Storage.msg Storage.object_path | `drop_dm_object_name(""Storage"")`  | `container_implant_gcp_detection_filter`"
"Splunk ES Content Update - Correlations","GCP Kubernetes cluster scan detection","This search provides information of unauthenticated requests via user agent, and authentication data against Kubernetes cluster",,"[""GCP""]",,,,,,,,,,"search sourcetype=""google:gcp:pubsub:message"" data.protoPayload.requestMetadata.callerIp!=127.0.0.1 data.protoPayload.requestMetadata.callerIp!=::1 ""data.labels.authorization.k8s.io/decision""=forbid ""data.protoPayload.status.message""=PERMISSION_DENIED data.protoPayload.authenticationInfo.principalEmail=""system:anonymous"" | rename data.protoPayload.requestMetadata.callerIp as src_ip | stats count min(_time) as firstTime max(_time) as lastTime values(data.protoPayload.methodName) as method_name values(data.protoPayload.resourceName) as resource_name values(data.protoPayload.requestMetadata.callerSuppliedUserAgent) as http_user_agent by src_ip data.resource.labels.cluster_name | rename data.resource.labels.cluster_name as cluster_name| `security_content_ctime(lastTime)` | `security_content_ctime(firstTime)`  | `kubernetes_gcp_scan_fingerprint_detection`"
"Splunk ES Content Update - Correlations","Hiding Files And Directories With Attrib.exe","Attackers leverage an existing Windows binary, attrib.exe, to mark specific as hidden by using specific flags so that the victim does not see the file.  The search looks for specific command-line arguments to detect the use of attrib.exe to hide files.",Endpoint,"Endpoint Detection and Response",,"Endpoint Compromise","Advanced Threat Detection","Defense Evasion | Persistence","Actions on Objectives",,,,," tstats `security_content_summariesonly` count min(_time) values(Processes.process) as process max(_time) as lastTime from datamodel=Endpoint.Processes where Processes.process_name=attrib.exe (Processes.process=*+h*) by Processes.parent_process Processes.process_name Processes.user | `drop_dm_object_name(""Processes"")` | `security_content_ctime(firstTime)`|`security_content_ctime(lastTime)`| `attrib_to_hide_files_filter`"
"Splunk ES Content Update - Correlations","Hosts receiving high volume of network traffic from email server","This search looks for an increase of data transfers from your email server to your clients. This could be indicative of a malicious actor collecting data using your email server.","Network_Traffic","Network Communication",,"Adversary Tactics","Advanced Threat Detection",Collection,"Actions on Objectives",,,,," tstats `security_content_summariesonly` sum(All_Traffic.bytes_in) as bytes_in from datamodel=Network_Traffic where All_Traffic.dest_category=email_server by All_Traffic.src_ip _time span=1d | `drop_dm_object_name(""All_Traffic"")` | eventstats avg(bytes_in) as avg_bytes_in stdev(bytes_in) as stdev_bytes_in | eventstats count as num_data_samples avg(eval(if(_time < relative_time(now(), ""@d""), bytes_in, null))) as per_source_avg_bytes_in stdev(eval(if(_time < relative_time(now(), ""@d""), bytes_in, null))) as per_source_stdev_bytes_in by src_ip | eval minimum_data_samples = 4, deviation_threshold = 3 | where num_data_samples >= minimum_data_samples AND bytes_in > (avg_bytes_in + (deviation_threshold * stdev_bytes_in)) AND bytes_in > (per_source_avg_bytes_in + (deviation_threshold * per_source_stdev_bytes_in)) AND _time >= relative_time(now(), ""@d"") | eval num_standard_deviations_away_from_server_average = round(abs(bytes_in - avg_bytes_in) / stdev_bytes_in, 2), num_standard_deviations_away_from_client_average = round(abs(bytes_in - per_source_avg_bytes_in) / per_source_stdev_bytes_in, 2) | table src_ip, _time, bytes_in, avg_bytes_in, per_source_avg_bytes_in, num_standard_deviations_away_from_server_average, num_standard_deviations_away_from_client_average"
"Splunk ES Content Update - Correlations","Identify New User Accounts","This detection search will help profile user accounts in your environment by identifying newly created accounts that have been added to your network in the past week.","Identity_Management","Windows Security | User Activity Audit",,"Operations | GDPR","Security Monitoring | Compliance",None,None,,,,," from datamodel Identity_Management.All_Identities  | eval empStatus=case((now()-startDate)<604800, ""Accounts created in last week"") | search empStatus=""Accounts created in last week""| `security_content_ctime(endDate)` | `security_content_ctime(startDate)`| table identity empStatus endDate startDate"
"Splunk ES Content Update - Correlations","Large Volume of DNS ANY Queries","The search is used to identify attempts to use your DNS Infrastructure for DDoS purposes via a DNS amplification attack leveraging ANY queries.","Network_Resolution",DNS,,"Denial of Service","Application Security",None,"Actions on Objectives",,,,," tstats `security_content_summariesonly` count from datamodel=Network_Resolution where nodename=DNS ""DNS.message_type""=""QUERY"" ""DNS.record_type""=""ANY"" by ""DNS.dest"" | `drop_dm_object_name(""DNS"")` | where count>200"
"Splunk ES Content Update - Correlations","MacOS - Re-opened Applications","This search looks for processes referencing the plist files that determine which applications are re-opened when a user reboots their machine.",Endpoint,"",,"-","-",None,"Installation | Command and Control",,,,," tstats `security_content_summariesonly` count values(Processes.process) as process values(Processes.parent_process) as parent_process min(_time) as firstTime max(_time) as lastTime from datamodel=Endpoint.Processes where Processes.process=""*com.apple.loginwindow*"" by Processes.user Processes.process_name Processes.parent_process_name Processes.dest | `drop_dm_object_name(Processes)` | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)`"
"Splunk ES Content Update - Correlations","Malicious PowerShell Process - Connect To Internet With Hidden Window","This search looks for PowerShell processes started with parameters to modify the execution policy of the run, run in a hidden window, and connect to the Internet. This combination of command-line options is suspicious because it's overriding the default PowerShell execution policy, attempts to hide its activity from the user, and connects to the Internet.",Endpoint,"Endpoint Detection and Response",,"Endpoint Compromise","Advanced Threat Detection",Execution,"Command and Control | Actions on Objectives",,,,," tstats `security_content_summariesonly` count values(Processes.process) as process values(Processes.parent_process) as parent_process min(_time) as firstTime max(_time) as lastTime from datamodel=Endpoint.Processes where Processes.process_name=powershell.exe by Processes.user Processes.process_name Processes.parent_process_name Processes.dest  | `drop_dm_object_name(Processes)` | `security_content_ctime(firstTime)`| `security_content_ctime(lastTime)` | search process=""*-Exec*"" process=""*-WindowStyle*"" process=""*hidden*"" process=""*New-Object*"" process=""*System.Net.WebClient*"""
"Splunk ES Content Update - Correlations","Malicious PowerShell Process - Encoded Command","This search looks for PowerShell processes that have encoded the script within the command-line. Malware has been seen using this parameter, as it obfuscates the code and makes it relatively easy to pass a script on the command-line.",Endpoint,"Endpoint Detection and Response",,"Endpoint Compromise","Advanced Threat Detection",Execution,"Command and Control | Actions on Objectives",,,,," tstats `security_content_summariesonly` count values(Processes.process) as process values(Processes.parent_process) as parent_process min(_time) as firstTime max(_time) as lastTime from datamodel=Endpoint.Processes where Processes.process_name=powershell.exe by Processes.user Processes.process_name Processes.parent_process_name Processes.dest  | `drop_dm_object_name(Processes)` | `security_content_ctime(firstTime)`| `security_content_ctime(lastTime)` | search process=*-EncodedCommand* OR  process=*-enc*"
"Splunk ES Content Update - Correlations","Malicious PowerShell Process - Execution Policy Bypass","This search looks for PowerShell processes started with parameters used to bypass the local execution policy for scripts. These parameters are often observed in attacks leveraging PowerShell scripts as they override the default PowerShell execution policy.",Endpoint,"Endpoint Detection and Response",,Malware,"Security Monitoring",Execution,"Command and Control | Actions on Objectives",,,,," tstats `security_content_summariesonly` values(Processes.process_id) as process_id, values(Processes.parent_process_id) as parent_process_id values(Processes.process) as process min(_time) as firstTime max(_time) as lastTime from datamodel=Endpoint.Processes where Processes.process_name=powershell.exe AND (Processes.process=""* -ex*"" OR Processes.process=""* bypass *"") by Processes.process_id, Processes.user, Processes.dest | `drop_dm_object_name(Processes)` | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)`"
"Splunk ES Content Update - Correlations","Malicious PowerShell Process - Multiple Suspicious Command-Line Arguments","This search looks for PowerShell processes started with a base64 encoded command-line passed to it, with parameters to modify the execution policy for the process, and those that prevent the display of an interactive prompt to the user. This combination of command-line options is suspicious because it overrides the default PowerShell execution policy, attempts to hide itself from the user, and passes an encoded script to be run on the command-line.",Endpoint,"Endpoint Detection and Response",,"Endpoint Compromise","Advanced Threat Detection",Execution,"Command and Control | Actions on Objectives",,,,," tstats `security_content_summariesonly` count values(Processes.process) as process values(Processes.parent_process) as parent_process min(_time) as firstTime max(_time) as lastTime from datamodel=Endpoint.Processes where Processes.process_name=powershell.exe by Processes.user Processes.process_name Processes.parent_process_name Processes.dest  | `drop_dm_object_name(Processes)` | `security_content_ctime(firstTime)`| `security_content_ctime(lastTime)`| search (process=*-EncodedCommand* OR process=*-enc*) process=*-Exec* AND process=*-NonI*"
"Splunk ES Content Update - Correlations","Malicious PowerShell Process With Obfuscation Techniques","This search looks for PowerShell processes launched with arguments that have characters indicative of obfuscation on the command-line.",Endpoint,"Endpoint Detection and Response",,"Endpoint Compromise","Advanced Threat Detection",Execution,"Command and Control | Actions on Objectives",,,,," tstats `security_content_summariesonly` count values(Processes.process) as process values(Processes.parent_process) as parent_process min(_time) as firstTime max(_time) as lastTime from datamodel=Endpoint.Processes where Processes.process_name=powershell.exe by Processes.user Processes.process_name Processes.parent_process_name Processes.dest Processes.process | `drop_dm_object_name(Processes)` | `security_content_ctime(firstTime)`| `security_content_ctime(lastTime)`| eval num_obfuscation = (mvcount(split(process, ""`""))-1) + (mvcount(split(process, ""^""))-1) | `malicious_powershell_process_obfuscation_techniques_output_filter` | search num_obfuscation > 0"
"Splunk ES Content Update - Correlations","Monitor DNS For Brand Abuse","This search looks for DNS requests for faux domains similar to the domains that you want to have monitored for abuse.","Network_Resolution",DNS,,Operations,"Security Monitoring",None,"Delivery | Actions on Objectives",,,,," tstats `security_content_summariesonly` values(DNS.answer) as IPs min(_time) as firstTime from datamodel=Network_Resolution by DNS.src, DNS.query | `drop_dm_object_name(""DNS"")` | `security_content_ctime(firstTime)`| `brand_abuse_dns`"
"Splunk ES Content Update - Correlations","Monitor Email For Brand Abuse","This search looks for emails claiming to be sent from a domain similar to one that you want to have monitored for abuse.",Email,Email,,Operations,"Security Monitoring",None,Delivery,,,,," tstats `security_content_summariesonly` values(All_Email.recipient) as recipients, min(_time) as firstTime, max(_time) as lastTime from datamodel=Email by All_Email.src_user, All_Email.message_id | `drop_dm_object_name(""All_Email"")` | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)` | eval temp=split(src_user, ""@"") | eval email_domain=mvindex(temp, 1) | lookup update=true brandMonitoring_lookup domain as email_domain OUTPUT domain_abuse | search domain_abuse=true | table message_id, src_user, email_domain, recipients, firstTime, lastTime"
"Splunk ES Content Update - Correlations","Monitor Registry Keys for Print Monitors","This search looks for registry activity associated with modifications to the registry key `HKLM\SYSTEM\CurrentControlSet\Control\Print\Monitors`. In this scenario, an attacker can load an arbitrary .dll into the print-monitor registry by giving the full path name to the after.dll. The system will execute the .dll with elevated (SYSTEM) permissions and will persist after reboot.",Endpoint,"Endpoint Detection and Response",,"Endpoint Compromise","Advanced Threat Detection","Persistence | Privilege Escalation","Actions on Objectives",,,,," tstats `security_content_summariesonly` count min(_time) as firstTime max(_time) as lastTime FROM datamodel=Endpoint.Registry where Registry.action=modified AND Registry.registry_path=""*CurrentControlSet\\Control\\Print\\Monitors*"" by Registry.dest, Registry.registry_key_name Registry.status Registry.user Registry.registry_path Registry.action | `drop_dm_object_name(Registry)`"
"Splunk ES Content Update - Correlations","Monitor Web Traffic For Brand Abuse","This search looks for Web requests to faux domains similar to the one that you want to have monitored for abuse.",Web,"Web Server | Web Proxy",,Operations,"Security Monitoring",None,Delivery,,,,," tstats `security_content_summariesonly` values(Web.url) as urls min(_time) as firstTime from datamodel=Web by Web.src | `drop_dm_object_name(""Web"")` | `security_content_ctime(firstTime)` | `brand_abuse_web`"
"Splunk ES Content Update - Correlations","Multiple Okta Users With Invalid Credentails From The Same IP","This search detects Okta login failures due to bad credentials for multiple users originating from the same ip address.",,"",,"Adversary Tactics","Security Monitoring",None,None,,,,,"search eventtype=okta_log outcome.reason=INVALID_CREDENTIALS | rename client.geographicalContext.country as country, client.geographicalContext.state as state, client.geographicalContext.city as city | stats min(_time) as firstTime max(_time) as lastTime dc(user) as distinct_users values(user) as users by src_ip, displayMessage, outcome.reason, country, state, city  | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)` |  search distinct_users > 5| `okta_multiple_users_with_auth_failures_from_ip_filter`"
"Splunk ES Content Update - Correlations","New container uploaded to AWS ECR","This searches show information on uploaded containers including source user, image id, source IP user type, http user agent, region, first time, last time of operation (PutImage). These searches are based on Cloud Infrastructure Data Model.","Cloud_Infrastructure","",,"Cloud Security","Security Monitoring",None,None,,,,," tstats count min(_time) as firstTime max(_time) as lastTime FROM datamodel=Cloud_Infrastructure.Compute where Compute.user_type!=""AssumeRole"" AND Compute.http_user_agent=""AWS Internal"" AND Compute.event_name=""PutImage"" by Compute.image_id Compute.src_user Compute.src Compute.region Compute.msg Compute.user_type | `drop_dm_object_name(""Compute"")` | `container_implant_aws_detection_filter`"
"Splunk ES Content Update - Correlations","No Windows Updates in a time frame","This search looks for Windows endpoints that have not generated an event indicating a successful Windows update in the last 60 days. Windows updates are typically released monthly and applied shortly thereafter. An endpoint that has not successfully applied an update in this time frame indicates the endpoint is not regularly being patched for some reason.",Updates,"Patch Management",,Compliance,Compliance,None,None,,,,," tstats `security_content_summariesonly` max(_time) as lastTime from datamodel=Updates where Updates.status=Installed Updates.vendor_product=""Microsoft Windows"" by Updates.dest Updates.status Updates.vendor_product | rename Updates.dest as Host | rename Updates.status as ""Update Status"" | rename Updates.vendor_product as Product | eval isOutlier=if(lastTime <= relative_time(now(), ""-60d@d""), 1, 0)  | `security_content_ctime(lastTime)`  | search isOutlier=1 | rename lastTime as ""Last Update Time"", | table Host, ""Update Status"", Product, ""Last Update Time"""
"Splunk ES Content Update - Correlations","Okta Account Lockout Events","Detect Okta user lockout events",,"",,"Adversary Tactics","Security Monitoring",None,None,,,,,"search eventtype=okta_log displayMessage=""Max sign in attempts exceeded"" | rename client.geographicalContext.country as country, client.geographicalContext.state as state, client.geographicalContext.city as city | table _time, user, country, state, city, src_ip |`okta_user_lockouts_filter`"
"Splunk ES Content Update - Correlations","Okta Failed SSO Attempts","Detect failed Okta SSO events",,"",,"Adversary Tactics","Security Monitoring",None,None,,,,,"search eventtype=okta_log displayMessage=""User attempted unauthorized access to app"" | stats  min(_time) as firstTime max(_time) as lastTime values(app) as Apps count by user, result ,displayMessage, src_ip | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)`|`okta_failed_sso_attempt_filter`"
"Splunk ES Content Update - Correlations","Okta User Logins From Multiple Cities","This search detects logins from the same user from different states in a 24 hour period.",,"",,"Adversary Tactics","Security Monitoring",None,None,,,,,"search eventtype=okta_log displayMessage=""User login to Okta"" client.geographicalContext.city!=null | stats min(_time) as firstTime max(_time) as lastTime dc(client.geographicalContext.city) as locations values(client.geographicalContext.city) as cities values(client.geographicalContext.state) as states by user | `security_content_ctime(firstTime)`| `security_content_ctime(lastTime)` |`okta_user_logins_from_multiple_cities_filter`| search locations > 1"
"Splunk ES Content Update - Correlations","Open Redirect in Splunk Web","This search allows you to look for evidence of exploitation for CVE-2016-4859, the Splunk Open Redirect Vulnerability.",,"Any Splunk Logs",,"Web Attack","Application Security","Defense Evasion",Delivery,,,,,"search index=_internal sourcetype=splunk_web_access return_to=""/%09/*"""
"Splunk ES Content Update - Correlations","Osquery pack - ColdRoot detection","This search looks for ColdRoot events from the osx-attacks osquery pack.",Alerts,"Endpoint Detection and Response",,Malware,"Security Monitoring","Execution | Persistence | Command and Control","Installation | Command and Control",,,,," from datamodel Alerts.Alerts | search app=osquery:results (name=pack_osx-attacks_OSX_ColdRoot_RAT_Launchd OR name=pack_osx-attacks_OSX_ColdRoot_RAT_Files) | rename columns.path as path | bucket _time span=30s | stats count(path) by _time, host, user, path"
"Splunk ES Content Update - Correlations","Overwriting Accessibility Binaries","Microsoft Windows contains accessibility features that can be launched with a key combination before a user has logged in. An adversary can modify or replace these programs so they can get a command prompt or backdoor without logging in to the system. This search looks for modifications to these binaries.",Endpoint,"Endpoint Detection and Response | Windows Security",,"Endpoint Compromise","Advanced Threat Detection",Persistence,"Actions on Objectives",,,,," tstats `security_content_summariesonly` count min(_time) as firstTime max(_time) as lastTime values(Filesystem.user) as user values(Filesystem.dest) as dest values(Filesystem.file_path) as file_path from datamodel=Endpoint.Filesystem where (Filesystem.file_path=*\\Windows\\System32\\sethc.exe* OR Filesystem.file_path=*\\Windows\\System32\\utilman.exe* OR Filesystem.file_path=*\\Windows\\System32\\osk.exe* OR Filesystem.file_path=*\\Windows\\System32\\Magnify.exe* OR Filesystem.file_path=*\\Windows\\System32\\Narrator.exe* OR Filesystem.file_path=*\\Windows\\System32\\DisplaySwitch.exe* OR Filesystem.file_path=*\\Windows\\System32\\AtBroker.exe*) by Filesystem.file_name Filesystem.dest | `drop_dm_object_name(Filesystem)` | `security_content_ctime(lastTime)` | `security_content_ctime(firstTime)`"
"Splunk ES Content Update - Correlations","Process Execution via WMI","This search looks for processes launched via WMI.",Endpoint,"Endpoint Detection and Response",,"Adversary Tactics | ","Advanced Threat Detection",Execution,"Actions on Objectives",,,,," tstats `security_content_summariesonly` count values(Processes.process) as process min(_time) as firstTime max(_time) as lastTime FROM datamodel=Endpoint.Processes where Processes.parent_process_name = *WmiPrvSE.exe by Processes.user Processes.dest Processes.process_name  | `drop_dm_object_name(""Processes"")` | `security_content_ctime(firstTime)`| `security_content_ctime(lastTime)`| `wmi_process_launch_filter`"
"Splunk ES Content Update - Correlations","Processes created by netsh","This search looks for processes launching netsh.exe to execute various commands via the netsh command-line utility. Netsh.exe is a command-line scripting utility that allows you to, either locally or remotely, display or modify the network configuration of a computer that is currently running. Netsh can be used as a persistence proxy technique to execute a helper .dll when netsh.exe is executed. In this search, we are looking for processes spawned by netsh.exe that are executing commands via the command line.",Endpoint,"Endpoint Detection and Response",,Abuse,Other,"Execution | Persistence","Actions on Objectives",,,,," tstats `security_content_summariesonly` count values(Processes.process) as process min(_time) as firstTime max(_time) as lastTime from datamodel=Endpoint.Processes where Processes.parent_process=""*C:\\Windows\\System32\\netsh.exe*"" by Processes.user Processes.dest Processes.parent_process Processes.parent_process_name Processes.process_name | `drop_dm_object_name(""Processes"")` | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)`"
"Splunk ES Content Update - Correlations","Processes launching netsh","This search looks for processes launching netsh.exe. Netsh is a command-line scripting utility that allows you to, either locally or remotely, display or modify the network configuration of a computer that is currently running. Netsh can be used as a persistence proxy technique to execute a helper DLL when netsh.exe is executed. In this search, we are looking for processes spawned by netsh.exe and executing commands via the command line.",Endpoint,"Endpoint Detection and Response",,Abuse,Other,"Execution | Persistence | Defense Evasion","Actions on Objectives",,,,," tstats `security_content_summariesonly` count values(Processes.process) min(_time) as firstTime max(_time) as lastTime from datamodel=Endpoint.Processes where Processes.process=netsh.exe by Processes.parent_process Processes.process_name Processes.user Processes.dest | `drop_dm_object_name(""Processes"")` | `security_content_ctime(firstTime)`|`security_content_ctime(lastTime)`"
"Splunk ES Content Update - Correlations","Processes Tapping Keyboard Events","This search looks for processes in an MacOS system that is tapping keyboard events in MacOS, and essentially monitoring all keystrokes made by a user. This is a common technique used by RATs to log keystrokes from a victim, although it can also be used by legitimate processes like Siri to react on human input",Alerts,"Endpoint Detection and Response",,Malware,"Security Monitoring",Collection,"Command and Control",,,,," from datamodel Alerts.Alerts | search app=osquery:results name=pack_osx-attacks_Keyboard_Event_Taps | rename columns.cmdline as cmd, columns.name as process_name, columns.pid as process_id| dedup host,process_name | table host,process_name, cmd, process_id"
"Splunk ES Content Update - Correlations","Prohibited Network Traffic Allowed","This search looks for network traffic defined by port and transport layer protocol in the Enterprise Security lookup table ""lookup_interesting_ports"", that is marked as prohibited, and has an associated 'allow' action in the Network_Traffic data model. This could be indicative of a misconfigured network device.","Network_Traffic","Network Communication",,"Operations | GDPR","Security Monitoring | Compliance","Command and Control | Exfiltration","Delivery | Command and Control",,,,," tstats `security_content_summariesonly` count min(_time) as firstTime max(_time) as lastTime from datamodel=Network_Traffic where All_Traffic.action = allowed by All_Traffic.src_ip All_Traffic.dest_ip All_Traffic.dest_port All_Traffic.action | lookup update=true interesting_ports_lookup dest_port as All_Traffic.dest_port OUTPUT app is_prohibited note transport | search is_prohibited=true | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)` | `drop_dm_object_name(""All_Traffic"")`"
"Splunk ES Content Update - Correlations","Prohibited Software On Endpoint","This search looks for applications on the endpoint that you have marked as prohibited.",Endpoint,"Endpoint Detection and Response",,"Unauthorized Software","Security Monitoring",Execution,"Installation | Command and Control | Actions on Objectives",,,,," tstats `security_content_summariesonly` count min(_time) as firstTime max(_time) as lastTime from datamodel=Endpoint.Processes by Processes.dest Processes.user Processes.process_name | `security_content_ctime(firstTime)`| `security_content_ctime(lastTime)` | `drop_dm_object_name(Processes)` | `prohibited_softwares`"
"Splunk ES Content Update - Correlations","Protocol or Port Mismatch","This search looks for network traffic on common ports where a higher layer protocol does not match the port that is being used. For example, this search should identify cases where protocols other than HTTP are running on TCP port 80. This can be used by attackers to circumvent firewall restrictions, or as an attempt to hide malicious communications over ports and protocols that are typically allowed and not well inspected.","Network_Traffic","Network Communication",,Operations,"Security Monitoring","Command and Control","Command and Control",,,,," tstats `security_content_summariesonly` count min(_time) as firstTime max(_time) as lastTime from datamodel=Network_Traffic where (All_Traffic.app=dns NOT All_Traffic.dest_port=53) OR ((All_Traffic.app=web-browsing OR All_Traffic.app=http) NOT (All_Traffic.dest_port=80 OR All_Traffic.dest_port=8080 OR All_Traffic.dest_port=8000)) OR (All_Traffic.app=ssl NOT (All_Traffic.dest_port=443 OR All_Traffic.dest_port=8443)) OR (All_Traffic.app=smtp NOT All_Traffic.dest_port=25) by All_Traffic.src_ip, All_Traffic.dest_ip, All_Traffic.app, All_Traffic.dest_port |`security_content_ctime(firstTime)` | `security_content_ctime(lastTime)` | `drop_dm_object_name(""All_Traffic"")`"
"Splunk ES Content Update - Correlations","Protocols passing authentication in cleartext","This search looks for cleartext protocols at risk of leaking credentials. Currently, this consists of legacy protocols such as telnet, POP3, IMAP, and non-anonymous FTP sessions. While some of these protocols can be used over SSL, they typically run on different assigned ports in those cases.","Network_Traffic","Network Communication",,Compliance,Compliance,"Credential Access | Lateral Movement | Collection","Reconnaissance | Actions on Objectives",,,,," tstats `security_content_summariesonly` count min(_time) as firstTime max(_time) as lastTime from datamodel=Network_Traffic where All_Traffic.protocol=""tcp"" AND (All_Traffic.dest_port=""23"" OR All_Traffic.dest_port=""143"" OR All_Traffic.dest_port=""110"" OR (All_Traffic.dest_port=""21"" AND All_Traffic.user != ""anonymous"")) groupby All_Traffic.user All_Traffic.src All_Traffic.dest All_Traffic.dest_port | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)` | `drop_dm_object_name(""All_Traffic"")`"
"Splunk ES Content Update - Correlations","Reg.exe Manipulating Windows Services Registry Keys","The search looks for reg.exe modifying registry keys that define Windows services and their configurations.",Endpoint,"Endpoint Detection and Response",,Malware,"Security Monitoring","Persistence | Privilege Escalation | Defense Evasion",Installation,,,,," tstats `security_content_summariesonly` count min(_time) as firstTime max(_time) as lastTime values(Processes.process_name) as process_name values(Processes.parent_process_name) as parent_process_name FROM datamodel=Endpoint.Processes where Processes.process_name = reg.exe by Processes.process_id Processes.dest | `drop_dm_object_name(""Processes"")` | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)` | join [| tstats `security_content_summariesonly` values(Registry.registry_path) as registry_path count  FROM datamodel=Endpoint.Registry where Registry.registry_path=""*\\services\\*"" by Registry.process_id Registry.dest | `drop_dm_object_name(""Registry"")` | table process_id dest registry_path]"
"Splunk ES Content Update - Correlations","Reg.exe used to hide files/directories via registry keys","The search looks for command-line arguments used to hide a file or directory using the reg add command.",Endpoint,"Endpoint Detection and Response",,"Endpoint Compromise","Advanced Threat Detection","Defense Evasion | Persistence","Actions on Objectives",,,,," tstats `security_content_summariesonly` values(Processes.process) as process min(_time) as firstTime max(_time) as lastTime from datamodel=Endpoint.Processes where Processes.process_name = reg.exe Processes.process=""*add*"" Processes.process=""*Hidden*"" Processes.process=""*REG_DWORD*"" by Processes.process_name Processes.parent_process_name Processes.dest Processes.user| `drop_dm_object_name(Processes)` | `security_content_ctime(firstTime)` |`security_content_ctime(lastTime)`| regex process = ""(/d\s+2)"""
"Splunk ES Content Update - Correlations","Registry Keys for Creating SHIM Databases","This search looks for registry activity associated with application compatibility shims, which can be leveraged by attackers for various nefarious purposes.","Change_Analysis","Endpoint Detection and Response",,"Endpoint Compromise","Advanced Threat Detection",Persistence,"Actions on Objectives",,,,," tstats `security_content_summariesonly` count min(_time) as firstTime max(_time) as lastTime FROM datamodel=Change_Analysis.All_Changes where All_Changes.object_category=registry AND (All_Changes.object_path=""*CurrentVersion\\AppCompatFlags\\Custom*"" OR All_Changes.object_path=""*CurrentVersion\\AppCompatFlags\\InstalledSDB*"") by All_Changes.dest, All_Changes.command, All_Changes.user, All_Changes.object, All_Changes.object_path | `drop_dm_object_name(""All_Changes"")`"
"Splunk ES Content Update - Correlations","Registry Keys Used For Persistence","The search looks for modifications to registry keys that can be used to launch an application or service at system startup.",Endpoint,"Endpoint Detection and Response",,"Endpoint Compromise","Advanced Threat Detection",Persistence,"Actions on Objectives",,,,," tstats `security_content_summariesonly` count values(Registry.registry_key_name) as registry_key_name values(Registry.registry_path) as registry_path min(_time) as firstTime max(_time) as lastTime FROM datamodel=Endpoint.Registry where (Registry.registry_path=*currentversion\\run* OR Registry.registry_path=*currentVersion\\Windows\\Appinit_Dlls* OR Registry.registry_path=CurrentVersion\\Winlogon\\Shell* OR Registry.registry_path=*CurrentVersion\\Winlogon\\Userinit* OR Registry.registry_path=*CurrentVersion\\Winlogon\\VmApplet* OR Registry.registry_path=*currentversion\\policies\\explorer\\run* OR Registry.registry_path=*currentversion\\runservices* OR Registry.registry_path=*\\CurrentControlSet\\Control\\Lsa\\* OR Registry.registry_path=""*Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options*"" OR Registry.registry_path=HKLM\\SOFTWARE\\Microsoft\\Netsh\\*) by Registry.dest , Registry.status, Registry.user | `security_content_ctime(lastTime)` | `security_content_ctime(firstTime)` | `drop_dm_object_name(Registry)`"
"Splunk ES Content Update - Correlations","Registry Keys Used For Privilege Escalation","This search looks for modifications to registry keys that can be used to elevate privileges. The registry keys under ""Image File Execution Options"" are used to intercept calls to an executable and can be used to attach malicious binaries to benign system binaries.",Endpoint,"Endpoint Detection and Response",,"Privilege Escalation","Advanced Threat Detection","Privilege Escalation | Persistence","Actions on Objectives",,,,," tstats `security_content_summariesonly` count values(Registry.registry_key_name) as registry_key_name values(Registry.registry_path) as registry_path min(_time) as firstTime max(_time) as lastTime FROM datamodel=Endpoint.Registry where (Registry.registry_path=""*Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options*"") AND (Registry.registry_key_name=GlobalFlag OR Registry.registry_key_name=Debugger) by Registry.dest  Registry.user | `security_content_ctime(lastTime)`  | `security_content_ctime(firstTime)` | `drop_dm_object_name(Registry)`"
"Splunk ES Content Update - Correlations","Remote Desktop Network Bruteforce","This search looks for RDP application network traffic and filters any source/destination pair generating more than twice the standard deviation of the average traffic.","Network_Traffic","Network Communication",,"Malware | ","Security Monitoring","Credential Access | Lateral Movement","Reconnaissance | Delivery",,,,," tstats `security_content_summariesonly` count min(_time) as firstTime max(_time) as lastTime from datamodel=Network_Traffic where All_Traffic.app=rdp by All_Traffic.src All_Traffic.dest All_Traffic.dest_port | eventstats stdev(count) AS stdev avg(count) AS avg p50(count) AS p50 | where count>(avg + stdev*2) | rename All_Traffic.src AS src All_Traffic.dest AS dest | table firstTime lastTime src dest count avg p50 stdev"
"Splunk ES Content Update - Correlations","Remote Desktop Network Traffic","This search looks for network traffic on TCP/3389, the default port used by remote desktop. While remote desktop traffic is not uncommon on a network, it is usually associated with known hosts. This search allows for whitelisting both source and destination hosts to remove them from the output of the search so you can focus on the uncommon uses of remote desktop on your network.","Network_Traffic","Network Communication",,"Lateral Movement","Advanced Threat Detection","Lateral Movement","Actions on Objectives",,,,," tstats `security_content_summariesonly` count min(_time) as firstTime max(_time) as lastTime from datamodel=Network_Traffic where All_Traffic.dest_port=3389 AND All_Traffic.dest_category!=common_rdp_destination AND All_Traffic.src_category!=common_rdp_source by All_Traffic.src All_Traffic.dest All_Traffic.dest_port | `drop_dm_object_name(""All_Traffic"")` | `security_content_ctime(firstTime)`| `security_content_ctime(lastTime)` | `remote_desktop_network_traffic_filter`"
"Splunk ES Content Update - Correlations","Remote Desktop Process Running On System","This search looks for the remote desktop process mstsc.exe running on systems upon which it doesn't typically run. This is accomplished by filtering out all systems that are noted in the `common_rdp_source category` in the Assets and Identity framework.",Endpoint,"Endpoint Detection and Response",,"Lateral Movement","Advanced Threat Detection","Lateral Movement","Actions on Objectives",,,,," tstats `security_content_summariesonly` count min(_time) as firstTime max(_time) as lastTime from datamodel=Endpoint.Processes where Processes.process=*mstsc.exe AND Processes.dest_category!=common_rdp_source by Processes.dest Processes.user Processes.process | `security_content_ctime(firstTime)`| `security_content_ctime(lastTime)` | `drop_dm_object_name(Processes)` | `remote_desktop_process_running_on_system_filter`"
"Splunk ES Content Update - Correlations","Remote Process Instantiation via WMI","This search looks for wmic.exe being launched with parameters to spawn a process on a remote system.",Endpoint,"Endpoint Detection and Response",,"Lateral Movement","Advanced Threat Detection",Execution,"Actions on Objectives",,,,," tstats `security_content_summariesonly` values(Processes.process) as process min(_time) as firstTime max(_time) as lastTime from datamodel=Endpoint.Processes where Processes.process_name = wmic.exe Processes.process=""*/node*"" Processes.process=""*process*"" Processes.process=""*call*"" Processes.process=""*create*""   by Processes.process_name Processes.parent_process_name Processes.dest Processes.user | `drop_dm_object_name(Processes)` | `security_content_ctime(firstTime)` |`security_content_ctime(lastTime)`"
"Splunk ES Content Update - Correlations","Remote Registry Key modifications","This search monitors for remote modifications to registry keys.",Endpoint,"Endpoint Detection and Response",,"Adversary Tactics","Advanced Threat Detection","Defense Evasion | Persistence | Lateral Movement","Actions on Objectives",,,,," tstats `security_content_summariesonly` count values(Registry.registry_key_name) as registry_key_name values(Registry.registry_path) as registry_path min(_time) as firstTime max(_time) as lastTime FROM datamodel=Endpoint.Registry where  Registry.registry_path=""\\\\*""  by Registry.dest , Registry.user | `security_content_ctime(lastTime)` | `security_content_ctime(firstTime)` | `drop_dm_object_name(Registry)`"
"Splunk ES Content Update - Correlations","Remote WMI Command Attempt","This search looks for wmic.exe being launched with parameters to operate on remote systems.",Endpoint,"Endpoint Detection and Response",,"Lateral Movement","Advanced Threat Detection",Execution,"Actions on Objectives",,,,," tstats `security_content_summariesonly` count values(Processes.process) as process values(Processes.parent_process) as parent_process min(_time) as firstTime max(_time) as lastTime from datamodel=Endpoint.Processes where Processes.process_name=wmic.exe  AND Processes.process= */node* by Processes.user Processes.process_name Processes.parent_process_name Processes.dest  | `drop_dm_object_name(Processes)` | `security_content_ctime(firstTime)`| `security_content_ctime(lastTime)`"
"Splunk ES Content Update - Correlations","RunDLL Loading DLL By Ordinal","This search looks for DLLs under %AppData% being loaded by rundll32.exe that are calling the exported function at ordinal 2. Calling exported functions by ordinal is not as common as calling by exported name. There was a bug fixed in IDAPro on 2016-08-08 that would not display functions without names.  Calling functions by ordinal would overcome the lack of name and make it harder for analyst to reverse engineer.",Endpoint,"Endpoint Detection and Response",,"Endpoint Compromise","Advanced Threat Detection",Execution,Installation,,,,," tstats `security_content_summariesonly` values(Processes.process) as process min(_time) as firstTime max(_time) as lastTime from datamodel=Endpoint.Processes where Processes.process_name = rundll32.exe Processes.process=""*AppData*"" Processes.process=""*,#2"" by Processes.process_name Processes.parent_process_name Processes.dest Processes.user | `drop_dm_object_name(Processes)` | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)`"
"Splunk ES Content Update - Correlations","Samsam Test File Write","The search looks for a file named ""test.txt"" written to the windows system directory tree, which is consistent with Samsam propagation.",Endpoint,"Endpoint Detection and Response",,"Malware | ","Security Monitoring",None,Delivery,,,,," tstats `security_content_summariesonly` count min(_time) as firstTime max(_time) as lastTime values(Filesystem.user) as user values(Filesystem.dest) as dest values(Filesystem.file_name) as file_name from datamodel=Endpoint.Filesystem where Filesystem.file_path=*\\windows\\system32\\test.txt by Filesystem.file_path | `drop_dm_object_name(Filesystem)` | `security_content_ctime(lastTime)` | `security_content_ctime(firstTime)`"
"Splunk ES Content Update - Correlations","Sc.exe Manipulating Windows Services","This search looks for arguments to sc.exe indicating the creation or modification of a Windows service.",Endpoint,"Endpoint Detection and Response",,"Endpoint Compromise","Advanced Threat Detection","Persistence | Privilege Escalation | Defense Evasion",Installation,,,,," tstats `security_content_summariesonly` values(Processes.process) as process min(_time) as firstTime max(_time) as lastTime from datamodel=Endpoint.Processes where Processes.process_name = sc.exe (Processes.process=""* create *"" OR Processes.process=""* config *"") by Processes.process_name Processes.parent_process_name Processes.dest Processes.user | `drop_dm_object_name(Processes)` | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)`"
"Splunk ES Content Update - Correlations","Scheduled Task Name Used by Dragonfly Threat Actors","This search looks for flags passed to schtasks.exe on the command-line that indicate a task name associated with the Dragonfly threat actor was created or deleted.",Endpoint,"Endpoint Detection and Response",,Malware,"Security Monitoring",Execution,"Actions on Objectives",,,,," tstats `security_content_summariesonly` count values(Processes.process) as process values(Processes.parent_process) as parent_process min(_time) as firstTime max(_time) as lastTime from datamodel=Endpoint.Processes where Processes.process_name=schtasks.exe  by Processes.user Processes.process_name Processes.parent_process_name Processes.dest  | `drop_dm_object_name(Processes)` | `security_content_ctime(firstTime)`| `security_content_ctime(lastTime)` | search (process=*delete* OR process=*create*) process=*reset* | `dragonfly_schtasks_filter`"
"Splunk ES Content Update - Correlations","Scheduled tasks used in BadRabbit ransomware","This search looks for flags passed to schtasks.exe on the command-line that indicate that task names related to the execution of Bad Rabbit ransomware were created or deleted.",Endpoint,"Endpoint Detection and Response",,Ransomware,"Security Monitoring","Persistence | Lateral Movement | Execution","Actions on Objectives",,,,," tstats `security_content_summariesonly` count min(_time) as firstTime max(_time) as lastTime values(Processes.process) as process  from datamodel=Endpoint.Processes where Processes.process_name=schtasks.exe (Processes.process= ""*create*""  OR Processes.process= ""*delete*"") by Processes.parent_process Processes.process_name Processes.user | `drop_dm_object_name(""Processes"")` | `security_content_ctime(firstTime)`|`security_content_ctime(lastTime)` | search (process=*rhaegal* OR process=*drogon* OR *viserion_*)"
"Splunk ES Content Update - Correlations","Schtasks scheduling job on remote system","This search looks for flags passed to schtasks.exe on the command-line that indicate a job is being scheduled on a remote system.",Endpoint,"Endpoint Detection and Response",,"Lateral Movement","Advanced Threat Detection","Persistence | Lateral Movement | Execution","Actions on Objectives",,,,," tstats `security_content_summariesonly` count min(_time) as firstTime max(_time) as lastTime from datamodel=Endpoint.Processes where Processes.process_name = schtasks.exe Processes.process=""*/create*"" Processes.process=""* /s *"" by Processes.process_name Processes.process Processes.parent_process_name Processes.dest Processes.user | `drop_dm_object_name(Processes)` | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)` | `schtasks_scheduling_job_on_remote_system_filter`"
"Splunk ES Content Update - Correlations","Schtasks used for forcing a reboot","This search looks for flags passed to schtasks.exe on the command-line that indicate that a forced reboot of system is scheduled.",Endpoint,"Endpoint Detection and Response",,Ransomware,"Security Monitoring","Persistence | Execution","Actions on Objectives",,,,," tstats `security_content_summariesonly` values(Processes.process) as process min(_time) as firstTime max(_time) as lastTime from datamodel=Endpoint.Processes where Processes.process_name = schtasks.exe Processes.process=""*shutdown*"" Processes.process=""*/r*"" Processes.process=""*/f*"" by Processes.process_name Processes.parent_process_name Processes.dest Processes.user | `drop_dm_object_name(Processes)` | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)`"
"Splunk ES Content Update - Correlations","Script Execution via WMI","This search looks for scripts launched via WMI.",Endpoint,"Endpoint Detection and Response",,"Adversary Tactics | ","Advanced Threat Detection",Execution,"Actions on Objectives",,,,," tstats `security_content_summariesonly` count values(Processes.process) as process min(_time) as firstTime max(_time) as lastTime FROM datamodel=Endpoint.Processes where Processes.process_name = ""scrcons.exe"" by Processes.user Processes.dest Processes.process_name  | `drop_dm_object_name(""Processes"")` | `security_content_ctime(firstTime)`| `security_content_ctime(lastTime)`| `wmi_script_execution_filter`"
"Splunk ES Content Update - Correlations","Shim Database File Creation","This search looks for shim database files being written to default directories. The sdbinst.exe application is used to install shim database files (.sdb). According to Microsoft, a shim is a small library that transparently intercepts an API, changes the parameters passed, handles the operation itself, or redirects the operation elsewhere.",Endpoint,"Endpoint Detection and Response",,"Endpoint Compromise","Advanced Threat Detection",Persistence,"Actions on Objectives",,,,," tstats `security_content_summariesonly` count values(Filesystem.action) values(Filesystem.file_hash) as file_hash values(Filesystem.file_path) as file_path  min(_time) as firstTime max(_time) as lastTime FROM datamodel=Endpoint.Filesystem where Filesystem.file_path=*Windows\AppPatch\Custom* by Filesystem.file_name Filesystem.dest | `security_content_ctime(lastTime)` | `security_content_ctime(firstTime)` |`drop_dm_object_name(Filesystem)`"
"Splunk ES Content Update - Correlations","Shim Database Installation With Suspicious Parameters","This search detects the process execution and arguments required to silently create a shim database.  The sdbinst.exe application is used to install shim database files (.sdb). A shim is a small library which transparently intercepts an API, changes the parameters passed, handles the operation itself, or redirects the operation elsewhere.",Endpoint,"Endpoint Detection and Response",,"Endpoint Compromise","Advanced Threat Detection",Persistence,"Actions on Objectives",,,,," tstats `security_content_summariesonly` values(Processes.process) as process min(_time) as firstTime max(_time) as lastTime from datamodel=Endpoint.Processes where Processes.process_name = sdbinst.exe Processes.process=""*-p*"" Processes.process=""*-q*"" by Processes.process_name Processes.parent_process_name Processes.dest Processes.user | `drop_dm_object_name(Processes)` | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)`"
"Splunk ES Content Update - Correlations","Short Lived Windows Accounts","This search detects accounts that were created and deleted in a short time period.",Change,"Windows Security",,"Best Practices","Security Monitoring",None,None,,,,," tstats `security_content_summariesonly` values(All_Changes.result_id) as result_id count min(_time) as firstTime max(_time) as lastTime from datamodel=Change where All_Changes.result_id=4720 OR All_Changes.result_id=4726 by _time span=4h All_Changes.user All_Changes.dest | `security_content_ctime(lastTime)` | `security_content_ctime(firstTime)` | `drop_dm_object_name(""All_Changes"")` | search result_id = 4720 result_id=4726 | transaction user connected=false maxspan=240m | table firstTime lastTime count user dest result_id"
"Splunk ES Content Update - Correlations","Single Letter Process On Endpoint","This search looks for process names that consist only of a single letter.",Endpoint,"Endpoint Detection and Response",,Malware,"Security Monitoring",Execution,"Actions on Objectives",,,,," tstats `security_content_summariesonly` count min(_time) as firstTime max(_time) as lastTime from datamodel=Endpoint.Processes by Processes.dest, Processes.user, Processes.process, Processes.process_name | `drop_dm_object_name(Processes)` | `security_content_ctime(lastTime)` | `security_content_ctime(firstTime)` | eval process_name_length = len(process_name), endExe = if(substr(process_name, -4) == "".exe"", 1, 0) | search process_name_length=5 AND endExe=1 | table count, firstTime, lastTime, dest, user, process, process_name"
"Splunk ES Content Update - Correlations","SMB Traffic Spike - MLTK","This search uses the Machine Learning Toolkit (MLTK) to identify spikes in the number of Server Message Block (SMB) connections.","Network_Traffic","Network Communication",,"Malware | ","Advanced Threat Detection",None,"Actions on Objectives",,,,," tstats `security_content_summariesonly` count values(All_Traffic.dest_ip) as dest values(All_Traffic.dest_port) as port from datamodel=Network_Traffic where All_Traffic.dest_port=139 OR All_Traffic.dest_port=445 OR All_Traffic.app=smb by _time span=1h, All_Traffic.src | eval HourOfDay=strftime(_time, ""%H"") | eval DayOfWeek=strftime(_time, ""%A"") | `drop_dm_object_name(All_Traffic)` | apply smb_pdfmodel threshold=0.001 | rename ""IsOutlier(count)"" as isOutlier | search isOutlier > 0 | sort -count | table _time src dest port count | `smb_traffic_spike_mltk_filter`"
"Splunk ES Content Update - Correlations","SMB Traffic Spike","This search looks for spikes in the number of Server Message Block (SMB) traffic connections.","Network_Traffic","Network Communication",,Ransomware,"Security Monitoring",None,"Actions on Objectives",,,,," tstats `security_content_summariesonly` count from datamodel=Network_Traffic where All_Traffic.dest_port=139 OR All_Traffic.dest_port=445 OR All_Traffic.app=smb by _time span=1h, All_Traffic.src | `drop_dm_object_name(""All_Traffic"")` | eventstats max(_time) as maxtime | stats count as num_data_samples max(eval(if(_time >= relative_time(maxtime, ""-70m@m""), count, null))) as count avg(eval(if(_time<relative_time(maxtime, ""-70m@m""), count, null))) as avg stdev(eval(if(_time<relative_time(maxtime, ""-70m@m""), count, null))) as stdev by src | eval upperBound=(avg+stdev*2), isOutlier=if(count > upperBound AND num_data_samples >=50, 1, 0) | where isOutlier=1 | table src count | `smb_traffic_spike_filter`"
"Splunk ES Content Update - Correlations","Spectre and Meltdown Vulnerable Systems","The search is used to detect systems that are still vulnerable to the Spectre and Meltdown vulnerabilities.",Vulnerabilities,"Vulnerability Detection",,Vulnerability,"Security Monitoring",None,None,,,,," tstats `security_content_summariesonly` min(_time) as firstTime max(_time) as lastTime from datamodel=Vulnerabilities where Vulnerabilities.cve =""CVE-2017-5753"" OR Vulnerabilities.cve =""CVE-2017-5715"" OR Vulnerabilities.cve =""CVE-2017-5754"" by Vulnerabilities.dest| `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)`"
"Splunk ES Content Update - Correlations","Spike in File Writes","The search looks for a sharp increase in the number of files written to a particular host",Endpoint,"Endpoint Detection and Response",,Ransomware,"Security Monitoring | Advanced Threat Detection",Execution,"Actions on Objectives",,,,," tstats `security_content_summariesonly` count FROM datamodel=Endpoint.Filesystem where Filesystem.action=created by _time span=1h, Filesystem.dest | `drop_dm_object_name(Filesystem)` | eventstats max(_time) as maxtime | stats count as num_data_samples max(eval(if(_time >= relative_time(maxtime, ""-1d@d""), count, null))) as ""count"" avg(eval(if(_time<relative_time(maxtime, ""-1d@d""), count,null))) as avg stdev(eval(if(_time<relative_time(maxtime, ""-1d@d""), count, null))) as stdev by ""dest"" | eval upperBound=(avg+stdev*4), isOutlier=if((count > upperBound) AND num_data_samples >=20, 1, 0) | search isOutlier=1 | `file_write_spikes_filter`"
"Splunk ES Content Update - Correlations","Splunk Enterprise Information Disclosure","This search allows you to look for evidence of exploitation for CVE-2018-11409, a Splunk Enterprise Information Disclosure Bug.",,"Any Splunk Logs",,Vulnerability,"Security Monitoring","Defense Evasion",Delivery,,,,,"search index=_internal sourcetype=splunkd_ui_access server-info | search clientip!=127.0.0.1 uri_path=""*raw/services/server/info/server-info"" | rename clientip as src_ip, splunk_server as dest | stats earliest(_time) as firstTime, latest(_time) as lastTime, values(uri) as uri, values(useragent) as http_user_agent, values(user) as user by src_ip, dest | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)`"
"Splunk ES Content Update - Correlations","SQL Injection with Long URLs","This search looks for long URLs that have several SQL commands visible within them.",Web,"Web Server",,"Web Attack","Application Security","Defense Evasion | Execution",Delivery,,,,," tstats `security_content_summariesonly` count from datamodel=Web where Web.dest_category=web_server AND (Web.url_length > 1024 OR Web.http_user_agent_length > 200) by Web.src Web.dest Web.url Web.url_length Web.http_user_agent | `drop_dm_object_name(""Web"")` | eval num_sql_cmds=mvcount(split(url, ""alter%20table"")) + mvcount(split(url, ""between"")) + mvcount(split(url, ""create%20table"")) + mvcount(split(url, ""create%20database"")) + mvcount(split(url, ""create%20index"")) + mvcount(split(url, ""create%20view"")) + mvcount(split(url, ""delete"")) + mvcount(split(url, ""drop%20database"")) + mvcount(split(url, ""drop%20index"")) + mvcount(split(url, ""drop%20table"")) + mvcount(split(url, ""exists"")) + mvcount(split(url, ""exec"")) + mvcount(split(url, ""group%20by"")) + mvcount(split(url, ""having"")) + mvcount(split(url, ""insert%20into"")) + mvcount(split(url, ""inner%20join"")) + mvcount(split(url, ""left%20join"")) + mvcount(split(url, ""right%20join"")) + mvcount(split(url, ""full%20join"")) + mvcount(split(url, ""select"")) + mvcount(split(url, ""distinct"")) + mvcount(split(url, ""select%20top"")) + mvcount(split(url, ""union"")) + mvcount(split(url, ""xp_cmdshell"")) - 24 | where num_sql_cmds > 3"
"Splunk ES Content Update - Correlations","Suspicious Changes to File Associations","This search looks for changes to registry values that control Windows file associations, executed by a process that is not typical for legitimate, routine changes to this area.",Endpoint,"Endpoint Detection and Response",,Malware,"Security Monitoring",Persistence,"Actions on Objectives",,,,," tstats `security_content_summariesonly` count min(_time) as firstTime max(_time) as lastTime values(Processes.process_name) as process_name values(Processes.parent_process_name) as parent_process_name FROM datamodel=Endpoint.Processes where Processes.process_name!=Explorer.exe AND Processes.process_name!=OpenWith.exe by Processes.process_id Processes.dest | `drop_dm_object_name(""Processes"")` | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)` | join [| tstats `security_content_summariesonly` values(Registry.registry_path) as registry_path count  FROM datamodel=Endpoint.Registry where Registry.registry_path=*\\Explorer\\FileExts* by Registry.process_id Registry.dest | `drop_dm_object_name(""Registry"")` | table process_id dest registry_path]| `change_file_association_filter`"
"Splunk ES Content Update - Correlations","Suspicious Email - UBA Anomaly","This detection looks for emails that are suspicious because of their sender, domain rareness, or behavior differences. This is an anomaly generated by Splunk User Behavior Analytics (UBA).",UEBA,Email,,"Adversary Tactics","Advanced Threat Detection",None,Delivery,,,,,"tstats `security_content_summariesonly` count min(_time) as firstTime max(_time) as lastTime values(All_UEBA_Events.category) as category from datamodel=UEBA where nodename=All_UEBA_Events.UEBA_Anomalies All_UEBA_Events.UEBA_Anomalies.uba_model = ""SuspiciousEmailDetectionModel"" by All_UEBA_Events.description All_UEBA_Events.severity All_UEBA_Events.user All_UEBA_Events.uba_event_type All_UEBA_Events.link All_UEBA_Events.signature All_UEBA_Events.url All_UEBA_Events.UEBA_Anomalies.uba_model | `drop_dm_object_name(All_UEBA_Events)` | `drop_dm_object_name(UEBA_Anomalies)`| `security_content_ctime(firstTime)`| `security_content_ctime(lastTime)`"
"Splunk ES Content Update - Correlations","Suspicious Email Attachment Extensions","This search looks for emails that have attachments with suspicious file extensions.",Email,Email,,"Endpoint Compromise","Security Monitoring","Execution | Defense Evasion",Delivery,,,,," tstats `security_content_summariesonly` count min(_time) as firstTime max(_time) as lastTime from datamodel=Email where All_Email.file_name=""*"" by All_Email.src_user, All_Email.file_name All_Email.message_id | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)` | `drop_dm_object_name(""All_Email"")` | `suspicious_email_attachments` | `suspicious_email_attachments_filter`"
"Splunk ES Content Update - Correlations","Suspicious File Write","The search looks for files created with names that have been linked to malicious activity.",Endpoint,"Endpoint Detection and Response",,Malware,"Security Monitoring",None,"Actions on Objectives",,,,," tstats `security_content_summariesonly` count values(Filesystem.action) as action values(Filesystem.file_path) as file_path min(_time) as firstTime max(_time) as lastTime FROM datamodel=Endpoint.Filesystem by Filesystem.file_name Filesystem.dest | `security_content_ctime(lastTime)` | `security_content_ctime(firstTime)` | `drop_dm_object_name(Filesystem)` | `suspicious_writes`"
"Splunk ES Content Update - Correlations","Suspicious Java Classes","This search looks for suspicious Java classes that are often used to exploit remote command execution in common Java frameworks, such as Apache Struts.",,"Web Server",,"Vulnerability | ","Security Monitoring",Execution,Exploitation,,,,,"search sourcetype=""stream:http"" http_method=POST http_content_length>1 | regex form_data=""(?i)java\.lang\.(?:runtime|processbuilder)"" | rename src_ip as src | stats count earliest(_time) as firstTime, latest(_time) as lastTime, values(url) as uri, values(status) as status, values(http_user_agent) as http_user_agent by src, dest | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)`"
"Splunk ES Content Update - Correlations","Suspicious LNK file launching a process","This search looks for a ``*.lnk` file under `C:\User*` or `*\Local\Temp\*` executing a process. This is common behavior used by various spear phishing tools.",Endpoint,"Endpoint Detection and Response",,"Adversary Tactics | ","Advanced Threat Detection",None,"Installation | Actions on Objectives",,,,," tstats `security_content_summariesonly` count min(_time) as firstTime max(_time) as lastTime FROM datamodel=Endpoint.Filesystem where Filesystem.file_name=""*.lnk"" AND (Filesystem.file_path=""C:\\Users*"" OR Filesystem.file_path=""*Local\\Temp*"")  by _time span=1h Filesystem.process_id Filesystem.file_name Filesystem.file_path Filesystem.file_hash Filesystem.user | `drop_dm_object_name(Filesystem)` | rename process_id as lnk_pid | join lnk_pid, _time [| tstats `security_content_summariesonly` count FROM datamodel=Endpoint.Processes where Processes.process_name=*  by _time span=1h Processes.parent_process_id Processes.process_id Processes.process_name Processes.dest Processes.process_path Processes.process | `drop_dm_object_name(Processes)` | rename parent_process_id as lnk_pid | fields _time lnk_pid process_id dest process_name process_path process] | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)` | table firstTime, lastTime, lnk_pid, process_id, user, dest, file_name, file_path, process_name, process, process_path, file_hash | `lnk_executing_a_process_filter`"
"Splunk ES Content Update - Correlations","Suspicious Reg.exe Process","This search looks for reg.exe being launched from a command prompt not started by the user. When a user launches cmd.exe, the parent process is usually explorer.exe. This search filters out those instances.",Endpoint,"Endpoint Detection and Response",,"Endpoint Compromise","Advanced Threat Detection","Defense Evasion","Actions on Objectives",,,,," tstats `security_content_summariesonly` count min(_time) as firstTime max(_time) as lastTime FROM datamodel=Endpoint.Processes where Processes.parent_process_name != explorer.exe Processes.process_name =cmd.exe by Processes.user Processes.process_name Processes.parent_process_name Processes.dest Processes.process_id Processes.parent_process_id | `drop_dm_object_name(""Processes"")` | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)` | search [| tstats `security_content_summariesonly` count FROM datamodel=Endpoint.Processes where Processes.parent_process_name=cmd.exe Processes.process_name= reg.exe by Processes.parent_process_id Processes.dest Processes.process_name | `drop_dm_object_name(""Processes"")` | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)` | rename parent_process_id as process_id |dedup process_id| table process_id dest] | `suspicious_reg_process_filter`"
"Splunk ES Content Update - Correlations","Suspicious wevtutil Usage","The wevtutil.exe application is the windows event log utility. This searches for wevtutil.exe with parameters for clearing the application, security, setup, or system event logs.",Endpoint,"Endpoint Detection and Response",,"Endpoint Compromise","Advanced Threat Detection","Defense Evasion","Actions on Objectives",,,,," tstats `security_content_summariesonly` values(Processes.process) as process min(_time) as firstTime max(_time) as lastTime from datamodel=Endpoint.Processes where Processes.process_name = wevtutil.exe Processes.process=""*cl*"" (Processes.process=""*System*"" OR Processes.process=""*Security*"" OR Processes.process=""*Setup*"" OR Processes.process=""*Application*"") by Processes.process_name Processes.parent_process_name Processes.dest Processes.user| `drop_dm_object_name(Processes)` | `security_content_ctime(firstTime)` |`security_content_ctime(lastTime)`"
"Splunk ES Content Update - Correlations","Suspicious writes to System Volume Information","This search detects writes to the 'System Volume Information' folder by something other than the System process.",,"Endpoint Detection and Response",,"Adversary Tactics","Advanced Threat Detection",Collection,None,,,,,"search (sourcetype=XmlWinEventLog:Microsoft-Windows-Sysmon/Operational OR tag=process) EventCode=11 process_id!=4 file_path=*System\ Volume\ Information* | stats count min(_time) as firstTime max(_time) as lastTime by dest, Image, file_path | `security_content_ctime(firstTime)`| `security_content_ctime(lastTime)`"
"Splunk ES Content Update - Correlations","Suspicious writes to windows Recycle Bin","This search detects writes to the recycle bin by a process other than explorer.exe.",Endpoint,"Endpoint Detection and Response",,"Adversary Tactics","Advanced Threat Detection",Collection,None,,,,," tstats `security_content_summariesonly` count min(_time) as firstTime max(_time) as lastTime values(Filesystem.file_path) as file_path values(Filesystem.file_name) as file_name FROM datamodel=Endpoint.Filesystem where Filesystem.file_path = ""*$Recycle.Bin*"" by Filesystem.process_id Filesystem.dest | `drop_dm_object_name(""Filesystem"")`| search [| tstats `security_content_summariesonly` values(Processes.user) as user values(Processes.process_name) as process_name values(Processes.parent_process_name) as parent_process_name FROM datamodel=Endpoint.Processes where Processes.process_name != ""explorer.exe"" by Processes.process_id Processes.dest| `drop_dm_object_name(""Processes"")` | table process_id dest]"
"Splunk ES Content Update - Correlations","System Processes Run From Unexpected Locations","This search looks for system processes that normally run out of C:\Windows\System32\ or C:\Windows\SysWOW64 that are not run from that location.  This can indicate a malicious process that is trying to hide as a legitimate process.",Endpoint,"Endpoint Detection and Response",,"Endpoint Compromise","Advanced Threat Detection","Defense Evasion","Actions on Objectives",,,,," tstats `security_content_summariesonly` count min(_time) as firstTime max(_time) as lastTime FROM datamodel=Endpoint.Processes where Processes.process_path !=""C:\\Windows\\System32*"" Processes.process_path !=""C:\\Windows\\SysWOW64*"" by Processes.user Processes.dest Processes.process_name Processes.process_id Processes.process_path Processes.parent_process_name Processes.process_hash| `drop_dm_object_name(""Processes"")` | `security_content_ctime(firstTime)`| `security_content_ctime(lastTime)`| `is_windows_system_file`"
"Splunk ES Content Update - Correlations","TOR Traffic","This search looks for network traffic identified as The Onion Router (TOR), a benign anonymity network which can be abused for a variety of nefarious purposes.","Network_Traffic","Network Communication",,"Data Exfiltration","Insider Threat | Security Monitoring","Command and Control | Exfiltration","Command and Control",,,,," tstats `security_content_summariesonly` count min(_time) as firstTime max(_time) as lastTime from datamodel=Network_Traffic where All_Traffic.app=tor AND All_Traffic.action=allowed by All_Traffic.src_ip All_Traffic.dest_ip All_Traffic.dest_port All_Traffic.action | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)` | `drop_dm_object_name(""All_Traffic"")`"
"Splunk ES Content Update - Correlations","Uncommon Processes On Endpoint","This search looks for applications on the endpoint that you have marked as uncommon.",Endpoint,"Endpoint Detection and Response | Windows Security",,"Unauthorized Software","Security Monitoring",Execution,"Actions on Objectives",,,,," tstats `security_content_summariesonly` count min(_time) as firstTime max(_time) as lastTime from datamodel=Endpoint.Processes by Processes.dest Processes.user Processes.process Processes.process_name | `security_content_ctime(firstTime)`| `security_content_ctime(lastTime)` | `drop_dm_object_name(Processes)` | `uncommon_processes` |`uncommon_processes_filter`"
"Splunk ES Content Update - Correlations","Unload Sysmon Filter Driver","Attackers often disable security tools to avoid detection. This search looks for the usage of process `fltMC.exe` to unload a Sysmon Driver that will stop sysmon from collecting the data.",Endpoint,"Endpoint Detection and Response",,"Adversary Tactics | ","Security Monitoring",None,"Actions on Objectives",,,,," tstats `security_content_summariesonly` count min(_time) as firstTime values(Processes.process) as process max(_time) as lastTime from datamodel=Endpoint.Processes where Processes.process_name=fltMC.exe AND Processes.process=*unload* AND Processes.process=*SysmonDrv*  by Processes.process_name Processes.process_id Processes.parent_process_name Processes.process Processes.dest Processes.user | `drop_dm_object_name(""Processes"")` | `security_content_ctime(firstTime)`|`security_content_ctime(lastTime)` |`unload_sysmon_filter_driver_filter`| table firstTime lastTime dest user count process_name process_id parent_process_name process"
"Splunk ES Content Update - Correlations","Unsigned Image Loaded by LSASS","This search detects loading of unsigned images by LSASS.",,"Windows Security",,"Adversary Tactics | ","Advanced Threat Detection",None,"Actions on Objectives",,,,,"search `sysmon` EventID=7 Image=*lsass.exe Signed=false | stats count min(_time) as firstTime max(_time) as lastTime by Computer, Image, ImageLoaded, Signed, SHA1 | rename Computer as dest | `security_content_ctime(firstTime)`| `security_content_ctime(lastTime)` | `unsigned_image_loaded_by_LSASS_filter`"
"Splunk ES Content Update - Correlations","Unsuccessful Netbackup backups","This search gives you the hosts where a backup was attempted and then failed.",,Backup,,Compliance,Compliance,None,None,,,,,"search sourcetype=""netbackup_logs"" | stats latest(_time) as latestTime by COMPUTERNAME, MESSAGE | search MESSAGE=""An error occurred, failed to backup."" | `security_content_ctime(latestTime)` | rename COMPUTERNAME as dest, MESSAGE as signature | table latestTime, dest, signature"
"Splunk ES Content Update - Correlations","Unusually Long Command Line - MLTK","Command lines that are extremely long may be indicative of malicious activity on your hosts. This search leverages the Machine Learning Toolkit (MLTK) to help identify command lines with lengths that are unusual for a given user.",Endpoint,"Endpoint Detection and Response",,"Malware | ","Advanced Threat Detection",None,"Actions on Objectives",,,,," tstats `security_content_summariesonly` count min(_time) as firstTime max(_time) as lastTime FROM datamodel=Endpoint.Processes by Processes.user Processes.dest Processes.process_name Processes.process | `drop_dm_object_name(Processes)` | `security_content_ctime(firstTime)`| `security_content_ctime(lastTime)`| eval processlen=len(process) | search user!=unknown | apply cmdline_pdfmodel threshold=0.01 | rename ""IsOutlier(processlen)"" as isOutlier | search isOutlier > 0 | table firstTime lastTime user dest process_name process processlen count"
"Splunk ES Content Update - Correlations","Unusually Long Command Line","Command lines that are extremely long may be indicative of malicious activity on your hosts.",Endpoint,"Endpoint Detection and Response",,"Endpoint Compromise","Advanced Threat Detection",Execution,"Actions on Objectives",,,,," tstats `security_content_summariesonly` count min(_time) as firstTime max(_time) as lastTime FROM datamodel=Endpoint.Processes by Processes.user Processes.dest Processes.process_name Processes.process | `drop_dm_object_name(""Processes"")` | `security_content_ctime(firstTime)`| `security_content_ctime(lastTime)`|  eval processlen=len(process) | eventstats stdev(processlen) as stdev, avg(processlen) as avg by dest | stats max(processlen) as maxlen, values(stdev) as stdevperhost, values(avg) as avgperhost by dest, user, process_name, process| `unusually_long_commandlines_filter`| eval threshold = 10 | where maxlen > ((threshold*stdevperhost) + avgperhost)"
"Splunk ES Content Update - Correlations","Unusually Long Content-Type Length","This search looks for unusually long strings in the Content-Type http header that the client sends the server.",,"Web Server",,"Web Attack","Application Security","Defense Evasion",Delivery,,,,,"search sourcetype=stream:http | eval cs_content_type_length = len(cs_content_type) | where cs_content_type_length > 100 | table endtime src_ip dest_ip cs_content_type_length cs_content_type url"
"Splunk ES Content Update - Correlations","USN Journal Deletion","The fsutil.exe application is a legitimate Windows utility used to perform tasks related to the file allocation table (FAT) and NTFS file systems. The update sequence number (USN) change journal provides a log of all changes made to the files on the disk. This search looks for fsutil.exe deleting the USN journal.",Endpoint,"Endpoint Detection and Response",,Ransomware,"Security Monitoring","Defense Evasion","Actions on Objectives",,,,," tstats `security_content_summariesonly` count values(Processes.process) as process values(Processes.parent_process) as parent_process min(_time) as firstTime max(_time) as lastTime from datamodel=Endpoint.Processes where Processes.process_name=fsutil.exe by Processes.user Processes.process_name Processes.parent_process_name Processes.dest  | `drop_dm_object_name(Processes)` | `security_content_ctime(firstTime)`| `security_content_ctime(lastTime)` | search process=""*deletejournal*"" AND process=""*usn*"""
"Splunk ES Content Update - Correlations","Web Fraud - Account Harvesting","This search is used to identify the creation of multiple user accounts using the same email domain name.",,"Web Server",,"Abuse | ",Other,None,"Actions on Objectives",,,,,"search sourcetype=stream:http http_content_type=text* uri=""/magento2/customer/account/loginPost/"" | rex field=cookie ""form_key=(?<SessionID>\w+)"" | rex field=form_data ""login\[username\]=(?<Username>[^&|^$]+)"" | search Username=* | rex field=Username ""@(?<email_domain>.*)""|stats dc(Username) as UniqueUsernames list(Username) as src_user by email_domain|where UniqueUsernames> 25"
"Splunk ES Content Update - Correlations","Web Fraud - Anomalous User Clickspeed","This search is used to examine web sessions to identify those where the clicks are occurring too quickly for a human or are occurring with a near-perfect cadence (high periodicity or low standard deviation), resembling a script driven session.",,"Web Server",,"Abuse | ",Other,None,"Actions on Objectives",,,,,"search sourcetype=stream:http http_content_type=text* | rex field=cookie ""form_key=(?<session_id>\w+)"" | streamstats window=2 current=1 range(_time) as TimeDelta by session_id | where TimeDelta>0 |stats count stdev(TimeDelta) as ClickSpeedStdDev avg(TimeDelta) as ClickSpeedAvg by session_id | where count>5 AND (ClickSpeedStdDev<.5 OR ClickSpeedAvg<.5)"
"Splunk ES Content Update - Correlations","Web Fraud - Password Sharing Across Accounts","This search is used to identify user accounts that share a common password.",,"Web Server",,"Abuse | ",Other,None,None,,,,,"search sourcetype=stream:http http_content_type=text* uri=/magento2/customer/account/loginPost*  | rex field=form_data ""login\[username\]=(?<Username>[^&|^$]+)"" | rex field=form_data ""login\[password\]=(?<Password>[^&|^$]+)"" | stats dc(Username) as UniqueUsernames values(Username) as user list(src_ip) as src_ip by Password|where UniqueUsernames>5"
"Splunk ES Content Update - Correlations","Web Servers Executing Suspicious Processes","This search looks for suspicious processes on all systems labeled as web servers.",Endpoint,"Endpoint Detection and Response",,"Web Attack","Application Security","Defense Evasion | Execution | Discovery","Actions on Objectives",,,,," tstats `security_content_summariesonly` count min(_time) as firstTime max(_time) as lastTime from datamodel=Endpoint.Processes where Processes.dest_category=""web_server"" AND (Processes.process=""*whoami*"" OR Processes.process=""*ping*"" OR Processes.process=""*iptables*"" OR Processes.process=""*wget*"" OR Processes.process=""*service*"" OR Processes.process=""*curl*"") by Processes.process Processes.process_name, Processes.dest Processes.user| `drop_dm_object_name(Processes)` | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)`"
"Splunk ES Content Update - Correlations","Windows Event Log Cleared","This search looks for Windows events that indicate one of the Windows event logs has been purged.",,"Windows Security",,"Endpoint Compromise","Advanced Threat Detection","Defense Evasion","Actions on Objectives",,,,,"search ((eventtype=wineventlog_security) AND (signature_id=1102 OR signature_id=1100)) OR ((eventtype=wineventlog_system) AND signature_id=104) | stats count min(_time) as firstTime max(_time) as lastTime by signature_id dest user| `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)`"
"Splunk ES Content Update - Correlations","Windows hosts file modification","The search looks for modifications to the hosts file on all Windows endpoints across your environment.",Endpoint,"Endpoint Detection and Response",,"Endpoint Compromise","Advanced Threat Detection","Command and Control | Exfiltration","Command and Control",,,,," tstats `security_content_summariesonly` count min(_time) as firstTime max(_time) as lastTime FROM datamodel=Endpoint.Filesystem  by Filesystem.file_name Filesystem.file_path Filesystem.dest | `security_content_ctime(lastTime)` | `security_content_ctime(firstTime)` | search Filesystem.file_name=hosts AND Filesystem.file_path=*Windows\\System32\\* | `drop_dm_object_name(Filesystem)`"
"Splunk ES Content Update - Correlations","WMI Permanent Event Subscription","This search looks for the creation of WMI permanent event subscriptions.",,"Windows Security",,"Adversary Tactics | ","Advanced Threat Detection","Execution | Persistence","Actions on Objectives",,,,,"search sourcetype=""wineventlog:microsoft-windows-wmi-activity/operational"" EventCode=5861 Binding | rex field=Message ""Consumer =\s+(?<consumer>[^;|^$]+)"" | search consumer!=""NTEventLogEventConsumer=\""SCM Event Log Consumer\"""" | stats count min(_time) as firstTime max(_time) as lastTime by ComputerName, consumer, Message | `security_content_ctime(firstTime)`| `security_content_ctime(lastTime)` | rename ComputerName as dest"
"Splunk ES Content Update - Correlations","WMI Permanent Event Subscription - Sysmon","This search looks for the creation of WMI permanent event subscriptions.",,"Windows Security",,"Adversary Tactics | ","Advanced Threat Detection","Execution | Persistence","Actions on Objectives",,,,,"search sourcetype=""XmlWinEventLog:Microsoft-Windows-Sysmon/Operational"" EventCode=21 | rename host as dest | table _time, dest, user, Operation, EventType, Query, Consumer, Filter"
"Splunk ES Content Update - Correlations","WMI Temporary Event Subscription","This search looks for the creation of WMI temporary event subscriptions.",,"Windows Security",,"Adversary Tactics | ","Advanced Threat Detection","Execution | Persistence","Actions on Objectives",,,,,"search sourcetype=""wineventlog:microsoft-windows-wmi-activity/operational"" EventCode=5860 Temporary | rex field=Message ""NotificationQuery =\s+(?<query>[^;|^$]+)"" | search query!=""SELECT * FROM Win32_ProcessStartTrace WHERE ProcessName = 'wsmprovhost.exe'"" AND query!=""SELECT * FROM __InstanceOperationEvent WHERE TargetInstance ISA 'AntiVirusProduct' OR TargetInstance ISA 'FirewallProduct' OR TargetInstance ISA 'AntiSpywareProduct'"" | stats count min(_time) as firstTime max(_time) as lastTime by ComputerName, query  | `security_content_ctime(firstTime)`| `security_content_ctime(lastTime)`"
"Splunk Enterprise Security - Correlations","Account Deleted","Detects user and computer account deletion",Change,"User Activity Audit",,"Lateral Movement","Security Monitoring",None,None,,,,," from datamodel:""Change"".""Account_Management"" | where 'tag'=""delete"" | stats max(_time) as ""lastTime"",latest(_raw) as ""orig_raw"",values(result) as ""signature"",values(src) as ""src"",values(dest) as ""dest"",count by ""src_user"",""user"" | where 'count'>0"
"Splunk Enterprise Security - Correlations","Brute Force Access Behavior Detected","Detects excessive number of failed login attempts along with a successful attempt (this could indicate a successful brute force attack)",Authentication,Authentication,,"Lateral Movement | IAM Analytics","Security Monitoring | Compliance",None,None,,,,," from datamodel:""Authentication"".""Authentication"" | stats values(tag) as tag,values(app) as app,count(eval('action'==""failure"")) as failure,count(eval('action'==""success"")) as success by src | search success>0 | `mltk_apply_upper(""app:failures_by_src_count_1h"", ""high"", ""failure"")`"
"Splunk Enterprise Security - Correlations","Brute Force Access Behavior Detected Over One Day","Detects an excessive number of failed login attempts, along with a successful attempt, over a one day period (this could indicate a successful brute force attack)",Authentication,Authentication,,"Lateral Movement | IAM Analytics","Security Monitoring | Compliance",None,None,,,,," tstats `summariesonly` values(Authentication.app) as app,count from datamodel=Authentication.Authentication by Authentication.action,Authentication.src | `drop_dm_object_name(""Authentication"")` | eval success=if(action=""success"",count,0),failure=if(action=""failure"",count,0) | stats values(app) as app,sum(failure) as failure,sum(success) as success by src | where success > 0 | `mltk_apply_upper(""app:failures_by_src_count_1d"", ""medium"", ""failure"")`"
"Splunk Enterprise Security - Correlations","Cleartext Password At Rest Detected","Detects cleartext passwords being stored at rest (such as in the Unix passwd file)","Compute_Inventory","Configuration Management",,"IAM Analytics",Compliance,None,None,,,,," from datamodel:""Compute_Inventory"".""Cleartext_Passwords"" | stats max(_time) as ""lastTime"",latest(_raw) as ""orig_raw"",values(tag) as ""tag"",count by ""dest"",""user"",""password"""
"Splunk Enterprise Security - Correlations","Completely Inactive Account","Discovers accounts that are no longer used. Unused accounts should be disabled and are oftentimes used by attackers to gain unauthorized access.",,Authentication,,"IAM Analytics","Compliance | Security Monitoring",None,None,,,,," from inputlookup:access_tracker | stats min(firstTime) as firstTime,max(lastTime) as lastTime by user | where ((now()-'lastTime')/86400)>90"
"Splunk Enterprise Security - Correlations","Concurrent Login Attempts Detected","Alerts on concurrent access attempts to an app from different hosts. These are good indicators of shared passwords and potential misuse.",Authentication,Authentication,,"IAM Analytics | Account Sharing | Account Compromise","Security Monitoring | Compliance",None,None,,,,," tstats `summariesonly` count from datamodel=Authentication.Authentication by _time,Authentication.app,Authentication.src,Authentication.user span=1s | `drop_dm_object_name(""Authentication"")` | eventstats dc(src) as src_count by app,user | search src_count>1 | sort 0 + _time | streamstats current=t window=2 earliest(_time) as previous_time,earliest(src) as previous_src by app,user | where (src!=previous_src) | eval time_diff=abs(_time-previous_time) | where time_diff<300"
"Splunk Enterprise Security - Correlations","Default Account Activity Detected","Discovers use of default accounts (such as admin, administrator, etc.). Default accounts have default passwords and are therefore commonly targeted by attackers using brute force attack tools.",Authentication,Authentication,,"IAM Analytics | Endpoint Compromise | GDPR","Security Monitoring | Compliance",None,None,,,,," from datamodel:""Authentication"".""Successful_Default_Authentication"" | stats max(_time) as ""lastTime"",values(tag) as ""tag"",count by ""dest"",""user"",""app"""
"Splunk Enterprise Security - Correlations","Default Account At Rest Detected","Discovers the presence of default accounts even if they are not being used. Default accounts should be disabled in order to prevent an attacker from using them to gain unauthorized access to remote hosts.","Compute_Inventory","Configuration Management",,"IAM Analytics","Security Monitoring | Compliance",None,None,,,,," from datamodel:""Compute_Inventory"".""Default_Accounts"" | where NOT match('enabled', ""0|[Ff]|[Ff][Aa][Ll][Ss][Ee]"") AND NOT 'status'==""Degraded"" AND NOT like('shell',""%nologin"") AND NOT like('shell',""%false"") AND 'user'!=""root"" | stats max(_time) as ""lastTime"",latest(_raw) as ""orig_raw"",values(tag) as ""tag"",count by ""dest"",""user"""
"Splunk Enterprise Security - Correlations","Excessive Failed Logins","Detects excessive number of failed login attempts (this is likely a brute force attack)",Authentication,Authentication,,"Lateral Movement | IAM Analytics","Security Monitoring | Compliance",None,None,,,,," from datamodel:""Authentication"".""Failed_Authentication"" | stats values(tag) as ""tag"",dc(user) as ""user_count"",dc(dest) as ""dest_count"",count by ""app"",""src"" | where 'count'>=6"
"Splunk Enterprise Security - Correlations","Geographically Improbable Access Detected","Alerts on access attempts that are improbable based on time and geography.",,Authentication,,"IAM Analytics | Account Sharing | Account Compromise","Advanced Threat Detection | Compliance",None,None,,,,,"search index=gia_summary source=""Access - Geographically Improbable Access - Summary Gen"" | fields user,src_time,src_app,src,src_lat,src_long,src_city,src_country,dest_time,dest_app,dest,dest_lat,dest_long,dest_city,dest_country,distance,speed"
"Splunk Enterprise Security - Correlations","High or Critical Priority Individual Logging into Infected Machine","Detects users with a high or critical priority logging into a malware infected machine",Malware,"Anti-Virus or Anti-Malware | Authentication",,"Endpoint Compromise | Account Compromise","Security Monitoring",None,None,,,,," tstats `summariesonly` values(Authentication.user) as ""user"" from datamodel=Authentication.Authentication where earliest=-70m@m latest=+0s nodename=Authentication.Successful_Authentication (""Authentication.user_priority""=""high"" OR ""Authentication.user_priority""=""critical"") by ""Authentication.dest"" | rename ""Authentication.dest"" as ""dest"" | eval cs_key='dest' | join type=inner cs_key [| tstats summariesonly=false values(Malware_Attacks.signature) as ""signature"" from datamodel=Malware.Malware_Attacks where earliest=-1450m@m latest=+0s nodename=Malware_Attacks.Allowed_Malware  by ""Malware_Attacks.dest"" | rename ""Malware_Attacks.dest"" as ""dest"" | eval cs_key='dest']"
"Splunk Enterprise Security - Correlations","Inactive Account Activity Detected","Discovers previously inactive accounts that are now being used. This may be due to an attacker that successfully gained access to an account that was no longer being used.",,Authentication,,"Insider Threat","Insider Threat | Security Monitoring",None,None,,,,," `inactive_account_usage(""90"",""2"")` | `ctime(lastTime)` | fields + user,tag,inactiveDays,lastTime"
"Splunk Enterprise Security - Correlations","Insecure Or Cleartext Authentication Detected","Detects authentication requests that transmit the password over the network as cleartext (unencrypted)",Authentication,"Network Communication",,"IAM Analytics | GDPR",Compliance,None,None,,,,," from datamodel:""Authentication"".""Insecure_Authentication"" | stats max(_time) as ""lastTime"",latest(_raw) as ""orig_raw"",values(tag) as ""tag"",count by ""app"",""dest"""
"Splunk Enterprise Security - Correlations","Short-lived Account Detected","Detects when a account or credential is created and then removed a short time later. This may be an indication of malicious activities.",Change,"User Activity Audit",,"Account Compromise","Security Monitoring",None,None,,,,," tstats `summariesonly` count from datamodel=Change.All_Changes where nodename=""All_Changes.Account_Management"" (All_Changes.action=""created"" OR All_Changes.action=""deleted"") by _time,All_Changes.dest,All_Changes.user span=1s | `drop_dm_object_name(""All_Changes"")` | streamstats range(_time) as delta,sum(count) as count by user,dest window=2 global=f | where count>1 AND delta<`useraccount_minimal_lifetime` | `uptime2string(delta,timestr)` | table user, dest, delta, timestr"
"Splunk Enterprise Security - Correlations","Asset Ownership Unspecified","Alerts when there are assets that define a specific priority and category but do not have an assigned owner.","Identity_Management","Configuration Management",,"IAM Analytics | GDPR",Compliance,None,None,,,,," from datamodel:""Identity_Management"".""All_Assets"" | where isnotnull('priority') AND len('priority')>0 AND isnotnull('category') AND len('category')>0 AND (isnull('owner') OR len('owner')==0) AND (isnull('ip') OR len('ip')==0 OR mvcount('ip')==1) | stats count | where 'count'>0 | eval const_dedup_id=""const_dedup_id"""
"Splunk Enterprise Security - Correlations","Anomalous Audit Trail Activity Detected","Discovers anomalous activity such as the deletion of or clearing of log files. Attackers oftentimes clear the log files in order to hide their actions, therefore, this may indicate that the system has been compromised.",Change,"Windows Security",,"Endpoint Compromise | Insider Threat","Security Monitoring | Insider Threat",None,None,,,,," from datamodel:""Change"".""Auditing_Changes"" | where ('action'=""cleared"" OR 'action'=""stopped"") | stats max(_time) as ""lastTime"",latest(_raw) as ""orig_raw"",count by ""dest"",""result"" | rename ""result"" as ""signature"""
"Splunk Enterprise Security - Correlations","Expected Host Not Reporting","Discovers hosts that are longer reporting events but should be submitting log events. This rule is used to monitor hosts that you know should be providing a constant stream of logs in order to determine why the host has failed to provide log data.",,"Any Splunk Logs",,"Operations | GDPR","Security Monitoring | Compliance",None,None,,,,," `host_eventcount(30,2)` | search is_expected=true | `ctime(lastTime)` | fields + host,lastTime,is_expected,tag,dayDiff"
"Splunk Enterprise Security - Correlations","Personally Identifiable Information Detected","Detects personally identifiable information (PII) in log files. Some software can inadvertently provide sensitive information in log files, resulting in potential exposure to those reviewing the log files.",,"Any Splunk Logs",,"Compliance | Insider Threat | Data Exfiltration | GDPR","Compliance | Insider Threat",None,None,,,,,"search NOT sourcetype=stash | `get_integer_seq` | lookup luhn_lite_lookup integer_seq OUTPUTNEW pii,pii_clean | eval pii_length=len(pii_clean) | lookup iin_lookup iin as pii_clean,length as pii_length OUTPUTNEW iin_issuer | search iin_issuer=* | `get_event_id` | fields + event_id,_raw,host,pii,iin_issuer | eval pii_hash=sha1(pii)"
"Splunk Enterprise Security - Correlations","Potential Gap in Data","Detects gaps caused by the failure of the search head. If saved searches do not execute then there may be gaps in summary data.","Splunk_Audit","Any Splunk Logs",,Operations,"Security Monitoring | Compliance",None,None,,,,," from datamodel:""Splunk_Audit"".""Scheduler_Activity"" | where 'status'=""success"" AND ('app' LIKE ""Splunk_%"" OR 'app' LIKE ""SA-%"" OR 'app' LIKE ""DA-%"" OR 'app'=""SplunkEnterpriseSecuritySuite"" OR 'app'=""SplunkPCIComplianceSuite"") | stats count | where 'count'=0 | eval const_dedup_id=""const_dedup_id"""
"Splunk Enterprise Security - Correlations","Untriaged Notable Events","Alerts when notable events have not been triaged",,"Ticket Management",,"Operations | GDPR","Security Monitoring | Compliance",None,None,,,,,"search `notable` | search (status_group=""New"" OR owner=""unassigned"") | stats count by rule_name | eventstats sum(count) as total"
"Splunk Enterprise Security - Correlations","Abnormally High Number of Endpoint Changes By User","Detects an abnormally high number of endpoint changes by user account, as they relate to restarts, audits, filesystem, user, and registry modifications.",Change,"Endpoint Detection and Response",,"Endpoint Compromise | Ransomware","Advanced Threat Detection",None,None,,,,," `tstats` count from datamodel=Endpoint.Filesystem where Filesystem.tag=""change"" by Filesystem.user | eval change_type=""filesystem"",user='Filesystem.user' | `tstats` append=T count from datamodel=Endpoint.Registry where Registry.tag=""change"" by Registry.user | eval change_type=if(isnull(change_type),""registry"",change_type),user=if(isnull(user),'Registry.user',user) | `tstats` append=T count from datamodel=Change.All_Changes where nodename=""All_Changes.Endpoint_Changes"" by All_Changes.change_type,All_Changes.user | eval change_type=if(isnull(change_type),'All_Changes.change_type',change_type),user=if(isnull(user),'All_Changes.user',user) | stats count as change_count by change_type,user  | `mltk_apply_upper(""app:change_count_by_user_by_change_type_1d"", ""extreme"", ""change_count"")`"
"Splunk Enterprise Security - Correlations","Anomalous New Listening Port","Alerts a series of hosts begin listening on a new port within 24 hours. This may be an indication that the devices have been compromised or have had new (and potentially vulnerable) software installed.",,"Endpoint Detection and Response",,"Endpoint Compromise | Unauthorized Software | Lateral Movement","Advanced Threat Detection",None,None,,,,," from inputlookup:""listeningports_tracker"" | eval earliestQual=case(match(""-24h@h"", ""^\d""), tostring(""-24h@h""),  match(""-24h@h"", ""^([@\+-]){1}""), relative_time(time(), ""-24h@h""),  true(), time()) | eval latestQual=case(match(""+0s"", ""^\d""), tostring(""+0s""),  match(""+0s"", ""^([@\+-]){1}""), relative_time(time(), ""+0s""),  true(), time()) | where ('firstTime'>=earliestQual AND 'firstTime'<=latestQual) | fields - earliestQual, latestQual | stats dc(dest) as ""dest_count"" by ""transport"",""dest_port"" | where 'dest_count'>10"
"Splunk Enterprise Security - Correlations","Anomalous New Process","Alerts when an anomalous number hosts are detected with a new process.",,"Endpoint Detection and Response",,"Endpoint Compromise | Unauthorized Software","Advanced Threat Detection",None,None,,,,," from inputlookup:""localprocesses_tracker"" | eval earliestQual=case(match(""-24h@h"", ""^\d""), tostring(""-24h@h""),  match(""-24h@h"", ""^([@\+-]){1}""), relative_time(time(), ""-24h@h""),  true(), time()) | eval latestQual=case(match(""+0s"", ""^\d""), tostring(""+0s""),  match(""+0s"", ""^([@\+-]){1}""), relative_time(time(), ""+0s""),  true(), time()) | where ('firstTime'>=earliestQual AND 'firstTime'<=latestQual) | fields - earliestQual, latestQual | stats dc(dest) as ""dest_count"",values(dest) as ""dest"" by ""process"" | where 'dest_count'>9"
"Splunk Enterprise Security - Correlations","Anomalous New Service","Alerts when an anomalous number hosts are detected with a new service.",,"Endpoint Detection and Response",,"Endpoint Compromise | Unauthorized Software | Privilege Escalation","Advanced Threat Detection",None,None,,,,," from inputlookup:""services_tracker"" | eval earliestQual=case(match(""-24h@h"", ""^\d""), tostring(""-24h@h""),  match(""-24h@h"", ""^([@\+-]){1}""), relative_time(time(), ""-24h@h""),  true(), time()) | eval latestQual=case(match(""+0s"", ""^\d""), tostring(""+0s""),  match(""+0s"", ""^([@\+-]){1}""), relative_time(time(), ""+0s""),  true(), time()) | where ('firstTime'>=earliestQual AND 'firstTime'<=latestQual) | fields - earliestQual, latestQual | stats dc(dest) as ""dest_count"",values(dest) as ""dest"" by ""service"" | where 'dest_count'>9"
"Splunk Enterprise Security - Correlations","New User Account Created On Multiple Hosts","Alerts when numerous new accounts are created for a username accounts multiple hosts.",,"Windows Security | User Activity Audit",,"Lateral Movement | Endpoint Compromise","Security Monitoring",None,None,,,,," from inputlookup:""useraccounts_tracker"" | eval earliestQual=case(match(""-24h@h"", ""^\d""), tostring(""-24h@h""),  match(""-24h@h"", ""^([@\+-]){1}""), relative_time(time(), ""-24h@h""),  true(), time()) | eval latestQual=case(match(""+0s"", ""^\d""), tostring(""+0s""),  match(""+0s"", ""^([@\+-]){1}""), relative_time(time(), ""+0s""),  true(), time()) | where ('firstTime'>=earliestQual AND 'firstTime'<=latestQual) | fields - earliestQual, latestQual | stats dc(dest) as ""dest_count"" by ""user"" | where 'dest_count'>3"
"Splunk Enterprise Security - Correlations","High Number of Hosts Not Updating Malware Signatures","Alerts when a high number of hosts not updating malware signatures have been discovered.  These hosts should be evaluated to determine why they are not updating their malware signatures.",,"Anti-Virus or Anti-Malware",,"Operations | GDPR","Security Monitoring | Compliance",None,None,,,,," `malware_operations_tracker` | rename time_signature_version as _time | `dayDiff(_time)` | search dayDiff>7 | stats count | search count>10 | eval const_dedup_id=""Endpoint - High Number of Hosts Not Updating Malware Signatures - Rule"""
"Splunk Enterprise Security - Correlations","High Number Of Infected Hosts","Alerts when a high total number of infected hosts is discovered.",Malware,"Anti-Virus or Anti-Malware",,"Endpoint Compromise","Security Monitoring",None,None,,,,," tstats summariesonly=true estdc(Malware_Attacks.dest) as ""infected_hosts"" from datamodel=""Malware"".""Malware_Attacks""    | where 'infected_hosts'>100 | eval const_dedup_id=""const_dedup_id"""
"Splunk Enterprise Security - Correlations","High Or Critical Priority Host With Malware Detected","Alerts when an infection is noted on a host with high or critical priority.",Malware,"Anti-Virus or Anti-Malware",,"Endpoint Compromise","Security Monitoring",None,None,,,,," from datamodel:""Malware"".""Malware_Attacks"" | where ('dest_priority'=""high"" OR 'dest_priority'=""critical"") | stats max(_time) as ""lastTime"",latest(_raw) as ""orig_raw"",values(dest_priority) as ""dest_priority"",count by ""dest"",""signature"""
"Splunk Enterprise Security - Correlations","Host Sending Excessive Email","Alerts when an host not designated as an e-mail server sends excessive e-mail to one or more target hosts.",Email,Email,,"Endpoint Compromise | Data Exfiltration | Insider Threat","Advanced Threat Detection | Insider Threat",None,None,,,,," tstats `summariesonly` sum(All_Email.recipient_count) as recipient_count,dc(All_Email.dest) as dest_count from datamodel=Email.All_Email where NOT All_Email.src_category=""email_servers"" by ""All_Email.src"",_time span=1h | `drop_dm_object_name(""All_Email"")` | apply app:recipients_by_src_1h [|`get_qualitative_upper_threshold(high)`] | apply app:destinations_by_src_1h [|`get_qualitative_upper_threshold(high)`] | search ""IsOutlier(recipient_count)""=1 OR ""IsOutlier(dest_count)""=1"
"Splunk Enterprise Security - Correlations","Host With High Number Of Listening ports","Alerts when host has a high number of listening services. This may be an indication that the device is running services that are not necessary (such as a default installation of a server) or is not running a firewall.",Endpoint,"Endpoint Detection and Response",,"Endpoint Compromise | Unauthorized Software | Lateral Movement","Advanced Threat Detection | Security Monitoring",None,None,,,,," tstats summariesonly=true dc(Ports.transport_dest_port) as ""port_count"" from datamodel=""Endpoint"".""Ports""  by ""Ports.dest"" | rename ""Ports.dest"" as ""dest"" | where 'port_count'>20"
"Splunk Enterprise Security - Correlations","High Process Count","Alerts when host has a high number of processes. This may be due to an infection or a runaway process.",Endpoint,"Endpoint Detection and Response",,"Endpoint Compromise","Advanced Threat Detection",None,None,,,,," tstats `summariesonly` max(_time) as _time from datamodel=Endpoint.Processes by Processes.dest,Processes.process | `drop_dm_object_name(""Processes"")` | eventstats max(_time) as lastReportTime by dest | where _time==lastReportTime | stats dc(process) as process_count by dest | search process_count>200"
"Splunk Enterprise Security - Correlations","Host With High Number Of Services","Alerts when host has a high number of services. This may be an indication that the device is running services that are not necessary (such as a default installation of a server).",Endpoint,"Endpoint Detection and Response",,"Endpoint Compromise | Unauthorized Software | Lateral Movement","Advanced Threat Detection | Security Monitoring",None,None,,,,," tstats summariesonly=true dc(Services.service) as ""service_count"" from datamodel=""Endpoint"".""Services""  by ""Services.dest"" | rename ""Services.dest"" as ""dest"" | where 'service_count'>100"
"Splunk Enterprise Security - Correlations","Host With Multiple Infections","Alerts when a host with multiple infections is discovered.",Malware,"Anti-Virus or Anti-Malware",,"Endpoint Compromise","Security Monitoring",None,None,,,,," tstats summariesonly=true dc(Malware_Attacks.signature) as ""infection_count"" from datamodel=""Malware"".""Malware_Attacks""   by ""Malware_Attacks.dest"" | rename ""Malware_Attacks.dest"" as ""dest"" | where 'infection_count'>1"
"Splunk Enterprise Security - Correlations","Multiple Primary Functions Detected","Multiple Primary Functions Detected",,"Network Communication",,Operations,"Security Monitoring",None,None,,,,," `primary_functions_tracker` | eval _time=lastTime | `hoursago(24)` | search is_primary=true | stats values(function) as function,dc(function) as function_count by dest | search function_count>1"
"Splunk Enterprise Security - Correlations","Host With Old Infection Or Potential Re-Infection","Alerts when a host with an old infection is discovered (likely a re-infection).",Malware,"Anti-Virus or Anti-Malware",,"Endpoint Compromise | GDPR","Security Monitoring | Compliance",None,None,,,,," tstats `summariesonly` max(_time) as lastTime from datamodel=Malware.Malware_Attacks by Malware_Attacks.signature,Malware_Attacks.dest | `drop_dm_object_name(""Malware_Attacks"")` | lookup local=true malware_tracker dest,signature OUTPUT firstTime | eval dayDiff=round((lastTime-firstTime)/86400,1) | search dayDiff>30"
"Splunk Enterprise Security - Correlations","Outbreak Detected","Alerts when a potential outbreak is observed based on newly infected systems all exhibiting the same infection",Malware,"Anti-Virus or Anti-Malware",,"Lateral Movement | Endpoint Compromise","Security Monitoring",None,None,,,,," tstats summariesonly=true dc(Malware_Attacks.dest) as ""system_count"",values(Malware_Attacks.tag) as ""tag"" from datamodel=""Malware"".""Malware_Attacks""   by ""Malware_Attacks.signature""  | rename ""Malware_Attacks.signature"" as ""signature"" | where 'system_count'>10"
"Splunk Enterprise Security - Correlations","Prohibited Process Detected","Alerts when a service in the prohibited process list is detected.",Endpoint,"Endpoint Detection and Response",,"Endpoint Compromise | Unauthorized Software","Advanced Threat Detection | Security Monitoring",None,None,,,,," from datamodel:""Endpoint"".""Processes"" | `get_interesting_processes` | search is_prohibited=true | `get_event_id` | fields + event_id,_raw,dest,process,note"
"Splunk Enterprise Security - Correlations","Prohibited Service Detected","Alerts when a service in the prohibited service list is detected.",,"Endpoint Detection and Response",,"Endpoint Compromise | Unauthorized Software","Advanced Threat Detection | Security Monitoring",None,None,,,,,"search NOT sourcetype=stash `service` | `get_interesting_services` | search is_prohibited=true | `get_event_id` | fields + event_id,_raw,dest,service,note"
"Splunk Enterprise Security - Correlations","Host With A Recurring Malware Infection","Alerts when a host has an infection that has been re-infected remove multiple times over multiple days.",Malware,"Anti-Virus or Anti-Malware",,"Endpoint Compromise","Security Monitoring",Execution,None,,,,," tstats summariesonly=true dc(Malware_Attacks.date) as ""day_count"",count from datamodel=""Malware"".""Malware_Attacks""   by ""Malware_Attacks.dest"",""Malware_Attacks.signature"" | rename ""Malware_Attacks.dest"" as ""dest"",""Malware_Attacks.signature"" as ""signature"" | where 'day_count'>3"
"Splunk Enterprise Security - Correlations","Should Timesync Host Not Syncing","Detects when hosts that are required to synchronize their clocks have failed to do so. Time synchronization is important because it ensures that the event logs are stamped with the proper time. Additionally, this is required by some regulatory compliance standards (such as PCI).",Performance,,,,,,,,,,," tstats `summariesonly` max(_time) as lastTime from datamodel=Performance.All_Performance where nodename=All_Performance.OS.Timesync All_Performance.OS.Timesync.action=success by All_Performance.dest | rename All_Performance.dest as dest | `get_asset(dest)` | rename dest_* as * | `assets` | search should_timesync=true | stats max(lastTime) as lastTime,first(should_timesync) as should_timesync,values(asset) as dest by asset_id | where isnull(lastTime) | addinfo | eval hourDiff=floor((info_max_time-info_min_time)/3600) | fields dest,should_timesync,hourDiff"
"Splunk Enterprise Security - Correlations","Activity from Expired User Identity","Alerts when an event is discovered from a user associated with identity that is now expired (that is, the end date of the identity has been passed).","Identity_Management",Authentication,,"Insider Threat","Insider Threat | Security Monitoring",None,None,,,,," from datamodel:""Identity_Management"".""Expired_Identity_Activity"" | stats max(_time) as ""lastTime"",latest(_raw) as ""orig_raw"",count by ""expired_user"" | rename ""expired_user"" as ""user"""
"Splunk Enterprise Security - Correlations","High Volume Email Activity to Non-corporate Domains by User","Alerts on high volume email activity by a user to non-corporate domains.",Email,Email,,"Endpoint Compromise | Data Exfiltration | Insider Threat","Advanced Threat Detection | Insider Threat",None,None,,,,," tstats `summariesonly` sum(All_Email.size) as bytes, values(All_Email.recipient) as recipient from datamodel=Email.All_Email where NOT `cim_corporate_email_domain_search(""All_Email.recipient"")` by All_Email.src_user, All_Email.src_user_bunit | `drop_dm_object_name(""All_Email"")` | `mltk_apply_upper(""app:email_activity_to_non_corporate_by_user_1h"", ""medium"", ""bytes"")`"
"Splunk Enterprise Security - Correlations","Web Uploads to Non-corporate Sites by Users","Alerts on high volume web uploads by a user to non-corporate domains.",Web,"Web Proxy",,"Data Exfiltration | Insider Threat | GDPR","Compliance | Insider Threat | Advanced Threat Detection",None,None,,,,," tstats `summariesonly` sum(Web.bytes) as bytes from datamodel=Web.Web where (Web.http_method=""POST"" OR Web.http_method=""PUT"")  NOT (`cim_corporate_web_domain_search(""Web.url"")`) by Web.user, Web.user_bunit | `drop_dm_object_name(""Web"")` | `mltk_apply_upper(""app:web_upload_to_non_corporate_by_user_1h"", ""medium"", ""bytes"")`"
"Splunk Enterprise Security - Correlations","Excessive DNS Failures","This search identifies DNS query failures by counting the number of DNS responses that do not indicate success, and trigger on more than 50 occurrences.","Network_Resolution",DNS,,"Command and Control","Advanced Threat Detection","Exfiltration | Command and Control","Command and Control",,,,," tstats summariesonly=true count from datamodel=""Network_Resolution"".""DNS"" where ""DNS.reply_code""!=""No error"" AND ""DNS.reply_code""!=""NoError"" by ""DNS.src""  | rename ""DNS.src"" as ""src"" | where 'count'>100"
"Splunk Enterprise Security - Correlations","Excessive DNS Queries","Alerts when a host starts sending excessive DNS queries","Network_Resolution",DNS,,"Command and Control | Endpoint Compromise","Advanced Threat Detection",None,None,,,,," tstats summariesonly=true count from datamodel=""Network_Resolution"".""DNS"" where    ""DNS.message_type""=""QUERY"" by ""DNS.src"" | rename ""DNS.src"" as ""src"" | where 'count'>100"
"Splunk Enterprise Security - Correlations","Excessive HTTP Failure Responses","Alerts when a host generates a lot of HTTP failures in a short span of time",Web,"Web Server",,"Web Attack","Application Security",None,None,,,,," tstats summariesonly=true count from datamodel=""Web"".""Web"" where    (""Web.status""=400 OR ""Web.status""=403 OR ""Web.status""=404 OR ""Web.status""=411 OR ""Web.status""=500 OR ""Web.status""=501) by ""Web.dest"" | rename ""Web.dest"" as ""dest"" | where 'count'>50"
"Splunk Enterprise Security - Correlations","High Volume of Web Activity from Critical System","Alerts when a system of high or critical severity generates a high volume of outbound web activity. This may indicate that the system has been compromised.",Web,,,,,,,,,,," tstats summariesonly=true sum(Web.bytes_out) as ""bytes_out"" from datamodel=""Web"".""Web"" where    ""Web.bytes_out"">0 AND (""Web.src_priority""=""high"" OR ""Web.src_priority""=""critical"") by ""Web.src"",""Web.dest"" | rename ""Web.src"" as ""src"",""Web.dest"" as ""dest"" | where 'bytes_out'>10485760"
"Splunk Enterprise Security - Correlations","Network Device Rebooted","Increases the risk score of network devices that have been rebooted.",Change,"Configuration Management",,Operations,"Security Monitoring",None,None,,,,," tstats summariesonly=true count from datamodel=""Change"".""All_Changes"" where nodename=""All_Changes.Network_Changes.Device_Restarts"" by ""All_Changes.dvc"",""_time"" span=""1s"" | rename ""All_Changes.dvc"" as ""dvc"""
"Splunk Enterprise Security - Correlations","Network Change Detected","Detects changes to policies of the network protection devices (such as firewall policy changes).",Change,"Configuration Management",,Operations,"Security Monitoring",None,None,,,,," from datamodel:""Change"".""Network_Changes"" | stats max(_time) as ""lastTime"",latest(_raw) as ""orig_raw"",count by ""dvc"",""action"",""command"""
"Splunk Enterprise Security - Correlations","Substantial Increase In Intrusion Events","Alerts when a statistically significant increase in a particular intrusion event is observed.","Intrusion_Detection",,,,,,,,,,," tstats `summariesonly` count as ids_attacks,values(IDS_Attacks.tag) as tag from datamodel=Intrusion_Detection.IDS_Attacks by IDS_Attacks.signature | `drop_dm_object_name(""IDS_Attacks"")` | `mltk_apply_upper(""app:count_by_signature_1h"", ""high"", ""ids_attacks"")`"
"Splunk Enterprise Security - Correlations","Substantial Increase In Port Activity","Alerts when a statistically significant increase in events on a given port is observed.","Network_Traffic","Network Communication",,"Data Exfiltration","Insider Threat | Advanced Threat Detection",None,None,,,,," tstats `summariesonly` count as dest_port_traffic_count,values(All_Traffic.tag) as tag from datamodel=Network_Traffic.All_Traffic by All_Traffic.dest_port | `drop_dm_object_name(""All_Traffic"")` | `mltk_apply_upper(""app:count_by_dest_port_1d"", ""extreme"", ""dest_port_traffic_count"")`"
"Splunk Enterprise Security - Correlations","Prohibited Port Activity Detected","Detects the use of ports that are prohibited. Useful for detecting the installation of new software or a successful compromise of a host (such as the presence of a backdoor or a system communicating with a botnet).","Network_Traffic","Network Communication",,"Lateral Movement | Endpoint Compromise | GDPR","Advanced Threat Detection | Compliance",None,None,,,,," from datamodel:""Network_Traffic"".""Allowed_Traffic"" | `is_traffic_prohibited(dest_port)` | search dest_port>0 NOT is_prohibited=false | stats count by dvc,transport,dest_port,is_prohibited | `get_asset(dvc)` | `get_identity4events(dvc_owner)`"
"Splunk Enterprise Security - Correlations","Unroutable Activity Detected","Alerts when activity to or from a host that is unroutable is detected.",Web,,,,,,,,,,," `tstats` count,values(sourcetype) from datamodel=Network_Traffic.All_Traffic where All_Traffic.action=""allowed"" AND `bogonlist_src_dest_subsearch(All_Traffic)` by All_Traffic.src,All_Traffic.dest | `drop_dm_object_name(""All_Traffic"")` | `tstats` append=true count,values(sourcetype) from datamodel=Intrusion_Detection.IDS_Attacks where `bogonlist_src_dest_subsearch(IDS_Attacks)` by IDS_Attacks.src,IDS_Attacks.dest | `drop_dm_object_name(""IDS_Attacks"")` | `tstats` append=true count,values(sourcetype) from datamodel=Web.Web where `bogonlist_src_dest_subsearch(Web)` by Web.src,Web.dest | `drop_dm_object_name(""Web"")` | stats count,values(sourcetype) as sourcetype by src,dest | `bogonlist_lookup` | eval bogon_ip=if(dest_is_bogon==""true"" AND dest_is_internal!=""true"",dest,src) | fields + sourcetype,src,dest,bogon_ip"
"Splunk Enterprise Security - Correlations","Unusual Volume of Network Activity","Detects unusual network traffic that may be indicative of a DoS attack as indicated by a high number of unique sources or a high volume of firewall packets","Network_Traffic","Network Communication",,"Data Exfiltration | Denial of Service","Insider Threat | Application Security | Advanced Threat Detection",None,None,,,,," tstats `summariesonly` dc(All_Traffic.src) as src_count,count as total_count from datamodel=Network_Traffic.All_Traffic | apply app:network_traffic_src_count_30m [|`get_qualitative_upper_threshold(extreme)`] | apply app:network_traffic_count_30m [|`get_qualitative_upper_threshold(extreme)`] | search ""IsOutlier(src_count)""=1 OR ""IsOutlier(total_count)""=1"
"Splunk Enterprise Security - Correlations","Vulnerability Scanner Detected (by events)","Detects a potential vulnerability scanner by detecting devices that have triggered a large number of unique events. Vulnerability scanners generally trigger a high number unique events when scanning a host since each vulnerability check tends to trigger a unique event.","Intrusion_Detection","IDS or IPS",,Scanning,"Security Monitoring | Compliance",None,None,,,,," from datamodel:""Intrusion_Detection"".""IDS_Attacks"" | stats values(tag) as ""tag"",dc(signature) as ""count"" by ""src"" | where 'count'>25"
"Splunk Enterprise Security - Correlations","Vulnerability Scanner Detected (by targets)","Detects a potential vulnerability scanner by detecting devices that have triggered events against a large number of unique targets. Vulnerability scanners generally trigger events against a high number of unique hosts when they are scanning a network for vulnerable hosts.","Intrusion_Detection","IDS or IPS",,Scanning,"Security Monitoring | Compliance",None,None,,,,," from datamodel:""Intrusion_Detection"".""IDS_Attacks"" | stats values(tag) as ""tag"",dc(dest) as ""count"" by ""src"" | where 'count'>25"
"Splunk Enterprise Security - Correlations","Same Error On Many Servers Detected","Alerts when multiple systems are exhibiting the same errors",,"Any Splunk Logs",,"Endpoint Compromise | Operations | Lateral Movement","Advanced Threat Detection | Security Monitoring",None,None,,,,,"search tag=error NOT tag=authentication | stats first(_raw) as orig_raw,dc(host) as system_count by sourcetype,punct | where 'system_count'>100"
"Splunk Enterprise Security - Correlations","Threat Activity Detected","Alerts when any activity matching threat intelligence is detected.","Threat_Intelligence","Email | Network Communication | Endpoint Detection and Response | Web Proxy | Malware Analysis | DNS",,"Threat Intelligence | GDPR","Security Monitoring | Compliance",None,None,,,,," from datamodel:""Threat_Intelligence"".""Threat_Activity"" | dedup threat_match_field,threat_match_value | `get_event_id` | table _raw,event_id,source,src,dest,threat*,weight | rename weight as record_weight | `per_panel_filter(""ppf_threat_activity"",""threat_match_field,threat_match_value"")` | `get_threat_attribution(threat_key)` | rename source_* as threat_source_*,description as threat_description | eval risk_score=case(isnum(record_weight), record_weight, isnum(weight), weight, 1=1, null())  | fields - *time | eval risk_object_type=case(threat_match_field=""query"" OR threat_match_field==""src"" OR threat_match_field==""dest"",""system"",threat_match_field==""src_user"" OR threat_match_field==""user"",""user"",1=1,""other"") | eval risk_object=threat_match_value"
"Splunk Enterprise Security - Correlations","Watchlisted Event Observed","Alerts when an event is discovered including text has been identified as important. This rule triggers whenever an event is discovered with the tag of &quot;watchlist&quot;.",,"Any Splunk Logs",,Other,Other,None,None,,,,,"search tag=watchlist NOT sourcetype=stash | eval risk_object=case(isnotnull(user),user,isnotnull(src_user),src_user,isnotnull(dest),dest,isnotnull(src),src,1=1,host) | eval risk_object_type=case(isnotnull(user),""user"",isnotnull(src_user),""user"",isnotnull(dest),""system"",isnotnull(src),""system"",1=1,""system"") | eval risk_score=if(eventtype=""website_watchlist"",50,null()) | eval suppression_value=sourcetype.""|"".risk_object  | `get_event_id` | table _raw,event_id,host,source,sourcetype,src,dest,dvc,src_user,user"
"Splunk Enterprise Security - Correlations","Abnormally High Number of HTTP Method Events By Src","Alerts when a host has an abnormally high number of HTTP requests by http method.",Web,"Web Proxy",,"Web Attack","Application Security | Advanced Threat Detection",None,None,,,,," tstats `summariesonly` count as web_event_count from datamodel=Web.Web by Web.src, Web.http_method | `drop_dm_object_name(""Web"")` | `mltk_apply_upper(""app:count_by_http_method_by_src_1d"", ""extreme"", ""web_event_count"")`"
"Splunk Enterprise Security - Dashboards","access_anomalies","",Authentication,,,,,,,,,,,
"Splunk Enterprise Security - Dashboards","access_center",,Authentication,,,,,,,,,,,
"Splunk Enterprise Security - Dashboards","access_search",,Authentication,,,,,,,,,,,
"Splunk Enterprise Security - Dashboards","access_tracker",,Authentication,,,,,,,,,,,
"Splunk Enterprise Security - Dashboards","account_management",,Change,,,,,,,,,,,
"Splunk Enterprise Security - Dashboards","default_accounts",,Authentication,,,,,,,,,,,
"Splunk Enterprise Security - Dashboards","dns_activity","","Network_Resolution",,,,,,,,,,,
"Splunk Enterprise Security - Dashboards","dns_search",,"Network_Resolution",,,,,,,,,,,
"Splunk Enterprise Security - Dashboards","email_activity","",Email,,,,,,,,,,,
"Splunk Enterprise Security - Dashboards","email_search",,Email,,,,,,,,,,,
"Splunk Enterprise Security - Dashboards","endpoint_changes",,Endpoint,,,,,,,,,,,
"Splunk Enterprise Security - Dashboards","ess_modular_action_center",,"Splunk_Audit",,,,,,,,,,,
"Splunk Enterprise Security - Dashboards","generic_protocols","","Network_Traffic",,,,,,,,,,,
"Splunk Enterprise Security - Dashboards","http_category_analysis",,Web,,,,,,,,,,,
"Splunk Enterprise Security - Dashboards","http_user_agent_analysis",,Web,,,,,,,,,,,
"Splunk Enterprise Security - Dashboards","ids_center",,"Intrusion_Detection",,,,,,,,,,,
"Splunk Enterprise Security - Dashboards","ids_search",,"Intrusion_Detection",,,,,,,,,,,
"Splunk Enterprise Security - Dashboards","malware_center",,Malware,,,,,,,,,,,
"Splunk Enterprise Security - Dashboards","malware_operations",,Malware,,,,,,,,,,,
"Splunk Enterprise Security - Dashboards","malware_search",,Malware,,,,,,,,,,,
"Splunk Enterprise Security - Dashboards","network_changes",,Change,,,,,,,,,,,
"Splunk Enterprise Security - Dashboards","new_domain_analysis",,Web,,,,,,,,,,,
"Splunk Enterprise Security - Dashboards","port_protocol_tracker",,"Network_Traffic",,,,,,,,,,,
"Splunk Enterprise Security - Dashboards","ssl_activity",,Certificates,,,,,,,,,,,
"Splunk Enterprise Security - Dashboards","ssl_search",,Certificates,,,,,,,,,,,
"Splunk Enterprise Security - Dashboards","system_center",,Performance,,,,,,,,,,,
"Splunk Enterprise Security - Dashboards","threat_activity",,"Threat_Intelligence",,,,,,,,,,,
"Splunk Enterprise Security - Dashboards","time_center",,Performance,,,,,,,,,,,
"Splunk Enterprise Security - Dashboards","traffic_center",,"Network_Traffic",,,,,,,,,,,
"Splunk Enterprise Security - Dashboards","traffic_search",,"Network_Traffic",,,,,,,,,,,
"Splunk Enterprise Security - Dashboards","traffic_size_analysis",,"Network_Traffic",,,,,,,,,,,
"Splunk Enterprise Security - Dashboards","update_center",,Updates,,,,,,,,,,,
"Splunk Enterprise Security - Dashboards","update_search",,Updates,,,,,,,,,,,
"Splunk Enterprise Security - Dashboards","url_length_analysis",,Web,,,,,,,,,,,
"Splunk Enterprise Security - Dashboards","user_activity","",Risk,,,,,,,,,,,
"Splunk Enterprise Security - Dashboards","vuln_center",,Vulnerabilities,,,,,,,,,,,
"Splunk Enterprise Security - Dashboards","vuln_operations",,Vulnerabilities,,,,,,,,,,,
"Splunk Enterprise Security - Dashboards","vuln_search",,Vulnerabilities,,,,,,,,,,,
"Splunk Enterprise Security - Dashboards","web_center",,Web,,,,,,,,,,,
"Splunk Enterprise Security - Dashboards","web_search",,Web,,,,,,,,,,,
"Splunk Security Essentials","Unusual Child Process for spoolsv.exe or connhost.exe","",,"Endpoint Detection and Response",,"Endpoint Compromise","Advanced Threat Detection","Discovery | Lateral Movement | Execution",Exploitation,,,,,
"Splunk Security Essentials","Significant Increase in Interactively Logged On Users","",,"Windows Security",,"Endpoint Compromise","Advanced Threat Detection","Privilege Escalation | Persistence","Command and Control | Installation",,,,,
"Splunk Security Essentials","Ransomware Extensions","",,"Endpoint Detection and Response | Windows Security",,"Endpoint Compromise","Advanced Threat Detection",Execution,"Actions on Objectives",,,,,
"Splunk Security Essentials","User Has Access to In-Scope Splunk Indexes They Should Not","Alerts the first time a user gains rights to search an index that they're not supposed to according to the output of a GDPR data source and GDPR user mapping exercise.",,"Any Splunk Logs",,"GDPR | IAM Analytics | Operations","Insider Threat | Compliance","Privilege Escalation | Credential Access","Actions on Objectives",,,,,
"Splunk Security Essentials","Increase in # of Hosts Logged into","",,"Windows Security | Authentication",,"Lateral Movement","Advanced Threat Detection","Lateral Movement","Installation | Actions on Objectives",,,,,
"Splunk Security Essentials","Sources Sending a High Volume of DNS Traffic","",,"Network Communication",,"Data Exfiltration","Insider Threat","Exfiltration | Command and Control","Command and Control | Actions on Objectives",,,,,
"Splunk Security Essentials","User Login to Unauthorized Geo","",,"AWS | Audit Trail | Authentication",,Compliance,Compliance,"Credential Access | Privilege Escalation | Initial Access","Actions on Objectives",,,,,
"Splunk Security Essentials","Familiar Filename Launched with New Path on Host","",,"Endpoint Detection and Response | Windows Security",,"Endpoint Compromise","Advanced Threat Detection","Defense Evasion","Installation | Actions on Objectives",,,,,
"Splunk Security Essentials","Detect Lateral Movement With WMI","",,"Endpoint Detection and Response | Windows Security",,"Lateral Movement","Advanced Threat Detection","Lateral Movement | Execution","Installation | Actions on Objectives",,,,,
"Splunk Security Essentials","Unusual Number of Modifications to Cloud ACLs","Looks for a large number of Security Group ACL changes in a short period of time for a user.",,"AWS | Audit Trail | Azure | GCP",,"Account Compromise | IAM Analytics | Data Exfiltration | Network Attack | SaaS","Advanced Threat Detection","Persistence | Credential Access","Actions on Objectives",,,,,
"Splunk Security Essentials","User Finding Project Code Names from Many Departments","",,"Web Server",,"Insider Threat","Insider Threat",Collection,"Actions on Objectives",,,,,
"Splunk Security Essentials","First Time USB Usage","",,"Endpoint Detection and Response | DLP",,"Data Exfiltration","Insider Threat","Lateral Movement | Collection | Exfiltration",Delivery,,,,,
"Splunk Security Essentials","Access to In-scope Resources","Visibility into who is accessing in-scope resources is key to your GDPR efforts. Splunk allows easy analysis of that information.",,"Web Proxy",,GDPR,Compliance,None,None,,,,,
"Splunk Security Essentials","Instance Created by Unusual User","Detects the first time a user creates a new instance.",,"AWS | Audit Trail | Azure | GCP",,"Account Compromise | IAM Analytics | SaaS","Advanced Threat Detection","Credential Access","Actions on Objectives",,,,,
"Splunk Security Essentials","Geographically Improbable Access Detected for Privileged Accounts","Detecting when the same account is logged into twice in a short period of time but from locations very far away, is key to finding account compromise or account credential sharing for your privileged accounts.",,"AWS | Audit Trail | Authentication",,"Insider Threat | Account Sharing","Insider Threat","Credential Access",None,,,,,
"Splunk Security Essentials","New Application Accessing Salesforce.com API","",,"Audit Trail",,"Data Exfiltration | GDPR | SaaS","Compliance | Insider Threat",Collection,"Actions on Objectives",,,,,
"Splunk Security Essentials","Pull List of Privileged Users","To focus detection or response on privileged users, you must first build a list of accounts that have elevated rights or access to privileged information.",,"Windows Security",,"Insider Threat","Insider Threat","Privilege Escalation | Credential Access","Actions on Objectives",,,,,
"Splunk Security Essentials","New Tables Queried by Salesforce.com Peer Group","",,"Audit Trail",,"Data Exfiltration | GDPR | SaaS","Compliance | Insider Threat","Discovery | Collection","Actions on Objectives",,,,,
"Splunk Security Essentials","Connection to New Domain","Detects when users browse to domains never before seen in your organization.",,"Web Proxy",,"Command and Control | Data Exfiltration","Advanced Threat Detection","Exfiltration | Command and Control","Actions on Objectives",,,,,
"Splunk Security Essentials","Monitor Unsuccessful Windows Updates","",,"Patch Management",,Operations,"Security Monitoring",None,None,,,,,
"Splunk Security Essentials","New Data Exfil DLP Alerts for User","",,DLP,,"Insider Threat","Insider Threat",Exfiltration,"Actions on Objectives",,,,,
"Splunk Security Essentials","New Logon Type for User","",,"Windows Security",,"Account Compromise","Advanced Threat Detection | Security Monitoring | Compliance","Privilege Escalation | Persistence | Defense Evasion",Installation,,,,,
"Splunk Security Essentials","Brute Force Access Behavior Detected - Against Category","Monitor your security controls and prove your GDPR compliance by detecting brute force (or password guessing) attacks on GDPR-tagged systems.",,"Windows Security | Authentication",,GDPR,Compliance,"Credential Access | Privilege Escalation",None,,,,,
"Splunk Security Essentials","Brute Force Access Behavior Detected Over One Day - Against Category","Monitor your security controls and prove your GDPR compliance by detecting slow and low brute force (or password guessing) attacks on GDPR-tagged systems that occur gradually over the day.",,"Windows Security | Authentication",,GDPR,Compliance,"Credential Access | Privilege Escalation",None,,,,,
"Splunk Security Essentials","First Time Logon to New Server","",,"Windows Security | Authentication",,"Lateral Movement | GDPR","Advanced Threat Detection | Compliance | Security Monitoring","Lateral Movement","Installation | Actions on Objectives",,,,,
"Splunk Security Essentials","Activity from Expired User Identity - on Category","The GDPR requires that only authorized individuals access personal data. Alert when the account of a past employee is used to log into GDPR-tagged systems",,"Windows Security | Authentication",,GDPR,Compliance,"Credential Access | Privilege Escalation","Actions on Objectives",,,,,
"Splunk Security Essentials","Geographically Improbable Access Detected against Category","To ensure you have a GDPR-mandated audit trail with individual accounts for each person, detect when the same account is logged into twice in a short period of time but from locations very far away, to a GDPR-tagged system.",,"AWS | Audit Trail | Authentication",,GDPR,Compliance,"Credential Access",None,,,,,
"Splunk Security Essentials","New Parent Process for cmd.exe or regedit.exe","",,"Endpoint Detection and Response | Windows Security",,"Endpoint Compromise","Advanced Threat Detection","Discovery | Lateral Movement | Execution",Exploitation,,,,,
"Splunk Security Essentials","Spike in Downloaded Documents Per User from Salesforce.com","",,"Audit Trail",,"Data Exfiltration | SaaS","Insider Threat",Collection,"Actions on Objectives",,,,,
"Splunk Security Essentials","Successful Login of Account for Former Employee","You shouldn't see any successful authentication activity on the accounts of former employees. Track this easily in Splunk.",,"Windows Security | Authentication",,"Account Compromise | Insider Threat","Security Monitoring | Insider Threat","Privilege Escalation | Credential Access","Actions on Objectives",,,,,
"Splunk Security Essentials","Fake Windows Processes","",,"Endpoint Detection and Response | Windows Security",,"Endpoint Compromise","Advanced Threat Detection","Defense Evasion",Installation,,,,,
"Splunk Security Essentials","Authentication Against a New Domain Controller","",,"Windows Security",,"Lateral Movement","Advanced Threat Detection","Lateral Movement",Installation,,,,,
"Splunk Security Essentials","Processes with High Entropy Names","",,"Endpoint Detection and Response | Windows Security",,"Endpoint Compromise","Advanced Threat Detection","Defense Evasion",Installation,,,,,
"Splunk Security Essentials","Unusual Cloud Regions","Looks for activity in IaaS Regions that have not been used before across the organization.",,"AWS | Audit Trail | Azure | GCP",,"Account Compromise | SaaS","Advanced Threat Detection",None,"Actions on Objectives",,,,,
"Splunk Security Essentials","Concentration of Discovery Tools by Filename","",,"Endpoint Detection and Response | Windows Security",,"Scanning | Endpoint Compromise","Advanced Threat Detection | Security Monitoring",Discovery,Exploitation,,,,,
"Splunk Security Essentials","Monitor Successful Backups","",,Backup,,"Operations | GDPR","Security Monitoring | Compliance",None,None,,,,,
"Splunk Security Essentials","Basic Brute Force Detection","Uses a simple threshold for Windows Security Logs to alert if there are a large number of failed logins, and at least one successful login from the same source.",,"Windows Security | Authentication",,"Account Compromise | Scanning","Security Monitoring","Credential Access",None,,,,,
"Splunk Security Essentials","Large Web Upload","Uses a basic threshold to detect a large web upload, which could be exfiltration from malware or a malicious insider.",,"Web Proxy",,"Data Exfiltration","Security Monitoring | Insider Threat",Exfiltration,None,,,,,
"Splunk Security Essentials","Multiple Infections on Host","Finds hosts that have logged multiple different infections in a short period of time.",,"Anti-Virus or Anti-Malware",,"Endpoint Compromise","Security Monitoring","Initial Access | Execution",Delivery,,,,,
"Splunk Security Essentials","First Time Accessing an Internal Git Repository","",,"Web Server",,"Data Exfiltration","Insider Threat | Advanced Threat Detection",Collection,"Actions on Objectives",,,,,
"Splunk Security Essentials","Flight Risk Printing","",,"User Activity Audit",,"Insider Threat","Insider Threat",Exfiltration,"Actions on Objectives",,,,,
"Splunk Security Essentials","Detect Journal Clearing","",,"Endpoint Detection and Response | Windows Security",,"Endpoint Compromise","Advanced Threat Detection","Defense Evasion","Actions on Objectives",,,,,
"Splunk Security Essentials","Cloud Provisioning Activity from Unusual IP","Looks for Cloud Provisioning activities that occur from new IPs (for organizations with strict IP controls).",,"AWS | Audit Trail | Azure | GCP",,"Account Compromise | IAM Analytics | Account Sharing | SaaS","Advanced Threat Detection",None,"Actions on Objectives",,,,,
"Splunk Security Essentials","New Suspicious cmd.exe / regedit.exe / powershell.exe Service Launch","",,"Endpoint Detection and Response | Windows Security",,"Endpoint Compromise","Advanced Threat Detection","Execution | Privilege Escalation",Installation,,,,,
"Splunk Security Essentials","Sources Sending Many DNS Requests","",,"Network Communication",,"Data Exfiltration | Endpoint Compromise","Advanced Threat Detection | Insider Threat","Exfiltration | Command and Control","Command and Control | Actions on Objectives",,,,,
"Splunk Security Essentials","Concentration of Attacker Tools by Filename","",,"Endpoint Detection and Response | Windows Security",,"Endpoint Compromise","Advanced Threat Detection | Security Monitoring","Discovery | Lateral Movement | Execution",Exploitation,,,,,
"Splunk Security Essentials","Endpoint Uncleaned Malware Detection","Detect a system with a malware detection that was not properly cleaned, as they carry a high risk of damage or disclosure of data.",,"Anti-Virus or Anti-Malware",,"GDPR | Endpoint Compromise","Security Monitoring | Compliance",None,None,,,,,
"Splunk Security Essentials","Basic Scanning","Looks for hosts that reach out to more than 500 hosts, or more than 500 ports in a short period of time, indicating scanning.",,"Network Communication",,Scanning,"Security Monitoring",Discovery,Reconnaissance,,,,,
"Splunk Security Essentials","Instance Modified by Unusual User","Detects the first time a user modifies an existing instance.",,"AWS | Audit Trail | Azure | GCP",,"Account Compromise | IAM Analytics | SaaS","Advanced Threat Detection",None,"Actions on Objectives",,,,,
"Splunk Security Essentials","Monitor Unsuccessful Backups","",,Backup,,Operations,"Security Monitoring",None,None,,,,,
"Splunk Security Essentials","Flight Risk Web Browsing","",,"Web Proxy",,"Insider Threat","Insider Threat",Exfiltration,None,,,,,
"Splunk Security Essentials","User with Many DLP Events","",,DLP,,"Insider Threat","Insider Threat","Exfiltration | Credential Access","Actions on Objectives",,,,,
"Splunk Security Essentials","New Cloud API Call Per Peer Group","Looks for users that are using APIs that neither they, nor their team has ever used before.",,"AWS | Audit Trail | Azure | GCP",,"Account Compromise | IAM Analytics | Insider Threat | SaaS","Advanced Threat Detection | Insider Threat","Credential Access","Actions on Objectives",,,,,
"Splunk Security Essentials","Hosts Where Security Sources Go Quiet","",,"Any Splunk Logs",,"Endpoint Compromise","Advanced Threat Detection","Defense Evasion","Actions on Objectives",,,,,
"Splunk Security Essentials","Concentration of Discovery Tools by SHA1 Hash","",,"Endpoint Detection and Response",,"Scanning | Endpoint Compromise","Advanced Threat Detection | Security Monitoring",Discovery,Exploitation,,,,,
"Splunk Security Essentials","User Login with Local Credentials","",,"Windows Security",,"Insider Threat | Privilege Escalation | Endpoint Compromise | Account Compromise","Insider Threat | Security Monitoring","Credential Access | Privilege Escalation",None,,,,,
"Splunk Security Essentials","Ransomware Vulnerabilities","",,"Vulnerability Detection",,Vulnerability,"Security Monitoring | Compliance","Privilege Escalation | Lateral Movement","Actions on Objectives",,,,,
"Splunk Security Essentials","Building a Departmental Peer Group","",,"Windows Security",,"Insider Threat | Compliance","Compliance | Insider Threat",None,None,,,,,
"Splunk Security Essentials","Healthcare Worker Opening More Patient Records Than Usual","",,"Audit Trail",,"Data Exfiltration | Insider Threat","Insider Threat | Advanced Threat Detection | Compliance",Collection,"Actions on Objectives",,,,,
"Splunk Security Essentials","Public Cloud Storage (Bucket)","Detects when new or existing public storage (e.g., an S3 Bucket) is set to public.",,"AWS | Audit Trail | Azure | GCP",,"Data Exfiltration | SaaS","Security Monitoring | Advanced Threat Detection",None,None,,,,,
"Splunk Security Essentials","New User Taking Privileged Actions","Record when a user who hasn't taken privileged actions before suddenly starts.",,"Windows Security | Authentication",,"Insider Threat | Privilege Escalation","Compliance | Insider Threat","Privilege Escalation","Actions on Objectives",,,,,
"Splunk Security Essentials","Old Passwords in Use","Detect active accounts with passwords that haven't been updated in more than 120 days.",,"Windows Security",,"Compliance | GDPR",Compliance,"Credential Access",None,,,,,
"Splunk Security Essentials","Windows Event Log Clearing Events","",,"Windows Security",,"Endpoint Compromise","Advanced Threat Detection","Defense Evasion","Actions on Objectives",,,,,
"Splunk Security Essentials","Ransomware Note Files","",,"Endpoint Detection and Response | Windows Security",,"Endpoint Compromise","Advanced Threat Detection",Execution,"Actions on Objectives",,,,,
"Splunk Security Essentials","Aggregate Risky Events","Detect low and slow activities and complex insider threat patterns by finding users with concentrations of risky activities.",,"Ticket Management",,"Insider Threat | Account Sharing","Insider Threat | Advanced Threat Detection",None,None,,,,,
"Splunk Security Essentials","Hosts with Varied and Future Timestamps","",,"Any Splunk Logs",,"Endpoint Compromise","Advanced Threat Detection","Defense Evasion","Actions on Objectives",,,,,
"Splunk Security Essentials","RFC1918 IP Not in CMDB","",,"Network Communication",,"Best Practices | Compliance | Shadow IT","Security Monitoring | Compliance",None,None,,,,,
"Splunk Security Essentials","User Logged into In-Scope System They Should Not Have","Follow your GDPR requirement and action your data mapping exercise by tracking employee/vendor/supplier access to systems, to ensure that they are authorized to view the data present on any systems they log into.",,"Windows Security | Authentication",,"GDPR | IAM Analytics | Lateral Movement | Operations","Insider Threat | Compliance","Credential Access | Privilege Escalation","Actions on Objectives",,,,,
"Splunk Security Essentials","Risky Events from Privileged Users","When something generally risky occurs to your most privileged users, you likely should respond more quickly. Fortunately, this is easy to do.",,"Ticket Management",,"Insider Threat | IAM Analytics","Insider Threat | Security Monitoring",None,None,,,,,
"Splunk Security Essentials","Short Lived Admin Accounts","",,"Windows Security",,"Endpoint Compromise","Advanced Threat Detection","Defense Evasion | Persistence","Command and Control",,,,,
"Splunk Security Essentials","SMB Traffic Allowed","",,"Network Communication",,Operations,"Security Monitoring","Execution | Lateral Movement","Reconnaissance | Delivery",,,,,
"Splunk Security Essentials","New High Risk Event Types for Salesforce.com User","",,"Audit Trail",,"Data Exfiltration | GDPR | SaaS","Compliance | Insider Threat",Collection,"Actions on Objectives",,,,,
"Splunk Security Essentials","Web Browsing to Unauthorized Sites","",,"Web Proxy",,"Insider Threat","Insider Threat",Exfiltration,"Actions on Objectives",,,,,
"Splunk Security Essentials","Common Filename Launched from New Path","",,"Endpoint Detection and Response | Windows Security",,"Endpoint Compromise","Advanced Threat Detection","Defense Evasion","Installation | Actions on Objectives",,,,,
"Splunk Security Essentials","Concentration of Attacker Tools by SHA1 Hash","",,"Endpoint Detection and Response",,"Endpoint Compromise","Advanced Threat Detection | Security Monitoring","Discovery | Lateral Movement | Execution",Exploitation,,,,,
"Splunk Security Essentials","New RunAs Host / Privileged Account Combination","",,"Windows Security",,"Account Compromise","Security Monitoring","Privilege Escalation",Installation,,,,,
"Splunk Security Essentials","Unauthorized Connection Through Firewall","Any communication through the firewall not explicitly granted by policy could indicate either a misconfiguration or even malicious actions, putting your security and compliance at risk.",,"Network Communication",,"GDPR | Data Exfiltration | Scanning","Security Monitoring | Compliance","Exfiltration | Discovery | Command and Control","Command and Control",,,,,
"Splunk Security Essentials","Spike in Exported Records from Salesforce.com","",,"Audit Trail",,"Data Exfiltration | GDPR | SaaS","Compliance | Insider Threat",Collection,"Actions on Objectives",,,,,
"Splunk Security Essentials","Expected Host Not Reporting - in Category","GDPR requires an audit trail for all activities, which means we should be receiving events constantly. Find GDPR-tagged systems that are no longer reporting events but should be.",,"Any Splunk Logs",,GDPR,Compliance,None,None,,,,,
"Splunk Security Essentials","Outdated Malware Definitions","Looks for Symantec AV systems where we see Symantec AV events, but don't see a malware definition update in the last few days.",,"Anti-Virus or Anti-Malware",,"Operations | Compliance | Endpoint Compromise","Security Monitoring",None,None,,,,,
"Splunk Security Essentials","In-Scope System with Windows Update Disabled","Any GDPR-tagged systems not receiving updates could jeopardize your GDPR status due to Article 32. Detect systems where the Windows Update service is disabled.",,"Patch Management",,"GDPR | Operations","Security Monitoring | Compliance",None,None,,,,,
"Splunk Security Essentials","In-Scope Device with Outdated Anti-Malware Found","Alerts when a GDPR-tagged system has out of date malware definitions, which would conflict with GDPR's requirement to maintain a secure environment.",,"Anti-Virus or Anti-Malware",,"GDPR | Endpoint Compromise","Security Monitoring | Compliance",None,None,,,,,
"Splunk Security Essentials","New Connection to In-Scope Device","Alert Data Protection Officers to new systems that become involved in processing GDPR-scoped data via network communication logs, so DPOs can ensure the systems are authorized and documented.",,"Network Communication",,"GDPR | Operations","Security Monitoring | Compliance",None,None,,,,,
"Splunk Security Essentials","Monitor AutoRun Registry Keys","",,"Endpoint Detection and Response",,"Endpoint Compromise","Advanced Threat Detection",Persistence,Installation,,,,,
"Splunk Security Essentials","New IaaS API Call Per User","Looks for users that are using IaaS APIs that they've never used before.",,"AWS | Audit Trail | Azure | GCP",,"Account Compromise | IAM Analytics | Insider Threat | SaaS","Advanced Threat Detection | Insider Threat","Execution | Credential Access | Collection | Exfiltration","Actions on Objectives",,,,,
"Splunk Security Essentials","New Service Paths for Host","",,"Endpoint Detection and Response | Windows Security",,"Endpoint Compromise","Advanced Threat Detection","Persistence | Defense Evasion | Privilege Escalation","Exploitation | Installation | Command and Control",,,,,
"Splunk Security Essentials","Spike in SMB Traffic","",,"Network Communication",,"Lateral Movement | Scanning","Advanced Threat Detection | Security Monitoring","Discovery | Execution | Lateral Movement","Actions on Objectives",,,,,
"Splunk Security Essentials","Flight Risk Emailing","",,Email,,"Insider Threat","Insider Threat",Exfiltration,None,,,,,
"Splunk Security Essentials","Find Unusually Long CLI Commands","",,"Endpoint Detection and Response | Windows Security",,"Endpoint Compromise","Advanced Threat Detection | Security Monitoring",Execution,"Installation | Exploitation | Actions on Objectives",,,,,
"Splunk Security Essentials","Detect Many Unauthorized Access Attempts","",,"Windows Security | Authentication",,"Insider Threat","Insider Threat","Credential Access | Privilege Escalation",None,,,,,
"Splunk Security Essentials","Stale Account Usage","",,"Windows Security | Authentication",,"Insider Threat | IAM Analytics | Account Compromise","Insider Threat | Security Monitoring","Privilege Escalation | Credential Access | Lateral Movement","Actions on Objectives",,,,,
"Splunk Security Essentials","New Local Admin Account","",,"Windows Security",,"Endpoint Compromise","Advanced Threat Detection | Security Monitoring | Compliance","Defense Evasion | Persistence","Command and Control",,,,,
"Splunk Security Essentials","First Time Access to Jump Server for Peer Group","",,"Windows Security | Authentication",,"Lateral Movement | Insider Threat","Insider Threat | Advanced Threat Detection","Lateral Movement","Installation | Actions on Objectives",,,,,
"Splunk Security Essentials","Increase in Source Code (Git) Downloads","",,"Web Server",,"Data Exfiltration","Insider Threat | Advanced Threat Detection",Collection,"Actions on Objectives",,,,,
"Splunk Security Essentials","First Time Accessing an Internal Git Repository Not Viewed by Peers","",,"Web Server",,"Data Exfiltration","Insider Threat",Collection,"Actions on Objectives",,,,,
"Splunk Security Essentials","Increase in Windows Privilege Escalations","",,"Windows Security",,"Account Compromise","Security Monitoring","Privilege Escalation",Installation,,,,,
"Splunk Security Essentials","Basic Dynamic DNS Detection","",,"DNS | Web Proxy",,"Command and Control","Security Monitoring | Advanced Threat Detection","Command and Control","Command and Control",,,,,
"Splunk Security Essentials","Cloud Provisioning Activity from Unusual Country","Looks for IaaS Provisioning activities that occur from new IPs, using GeoIP to resolve the Country.",,"AWS | Audit Trail | Azure | GCP",,"Account Compromise | IAM Analytics | Account Sharing | SaaS | Insider Threat","Advanced Threat Detection | Insider Threat","Credential Access","Actions on Objectives",,,,,
"Splunk Security Essentials","Detect Log Clearing With wevtutil","",,"Endpoint Detection and Response | Windows Security",,"Endpoint Compromise","Advanced Threat Detection","Defense Evasion","Actions on Objectives",,,,,
"Splunk Security Essentials","Basic Malware Outbreak","Looks for the same malware occurring on multiple systems in a short period of time.",,"Anti-Virus or Anti-Malware",,"Endpoint Compromise","Security Monitoring","Initial Access | Execution | Privilege Escalation",Delivery,,,,,
"Splunk Security Essentials","Recurring Infection on Host","Looks for the same malware occurring multiple times on the same host.",,"Anti-Virus or Anti-Malware",,"Endpoint Compromise","Security Monitoring","Initial Access | Execution",Delivery,,,,,
"Splunk Security Essentials","Cloud APIs Called More Often Than Usual Per User","Builds a per-user baseline for how many API calls is normal, and then alerts for deviations.",,"AWS | Audit Trail | Azure | GCP",,"Account Compromise | IAM Analytics | SaaS","Advanced Threat Detection",Execution,"Actions on Objectives",,,,,
"Splunk Security Essentials","New Cloud Provider for User","",,"Web Proxy",,"Data Exfiltration | Insider Threat | Shadow IT","Insider Threat | Security Monitoring",Exfiltration,"Actions on Objectives",,,,,
"Splunk Security Essentials","Emails with Lookalike Domains","",,Email,,"Endpoint Compromise | SaaS","Advanced Threat Detection","Initial Access",Delivery,,,,,
"Splunk Security Essentials","Remote PowerShell Launches","",,"Endpoint Detection and Response | Windows Security",,"Lateral Movement","Advanced Threat Detection","Lateral Movement",Installation,,,,,
"Splunk Security Essentials","Disabled Update Service","Splunk can detect the status of services, allowing us to find hosts where the Windows Update service is disabled.",,"Endpoint Detection and Response",,"Endpoint Compromise","Security Monitoring","Defense Evasion",None,,,,,
"Splunk Security Essentials","New AD Domain Detected","",,"Windows Security",,"Lateral Movement","Advanced Threat Detection | Compliance","Lateral Movement",Installation,,,,,
"Splunk Security Essentials","Access to In-Scope Unencrypted Resources","Unencrypted communications leaves you vulnerable to a data breach -- when users access PII data, ensure that all connections are encrypted.",,"Web Proxy",,GDPR,Compliance,None,None,,,,,
"Splunk Security Essentials","New Tables Queried by Salesforce.com User","",,"Audit Trail",,"Data Exfiltration | GDPR | SaaS","Compliance | Insider Threat","Discovery | Collection","Actions on Objectives",,,,,
"Splunk Security Essentials","User with Increase in Outgoing Email","",,Email,,"Data Exfiltration | Endpoint Compromise | SaaS","Advanced Threat Detection | Insider Threat",Exfiltration,"Actions on Objectives",,,,,
"Splunk Security Essentials","Monitor Successful Windows Updates","",,"Patch Management",,"Operations | GDPR","Security Monitoring | Compliance",None,None,,,,,
"Splunk Security Essentials","Many USB File Copies for User","",,"Endpoint Detection and Response | DLP",,"Insider Threat","Insider Threat",Exfiltration,"Actions on Objectives",,,,,
"Splunk Security Essentials","Significant Increase in Interactive Logons","",,"Windows Security",,"Lateral Movement","Advanced Threat Detection","Lateral Movement","Installation | Actions on Objectives",,,,,
"Splunk Security Essentials","Find Processes with Renamed Executables","",,"Endpoint Detection and Response | Windows Security",,"Endpoint Compromise","Advanced Threat Detection","Defense Evasion","Installation | Actions on Objectives",,,,,
"Splunk Security Essentials","Non-Privileged Users taking Privileged Actions","Detect users who shouldn't be able admins taking privileged actions.",,"Windows Security | Authentication",,"Compliance | Insider Threat | Privilege Escalation","Compliance | Insider Threat","Privilege Escalation","Actions on Objectives",,,,,
"Splunk Security Essentials","New Interactive Logon from a Service Account","",,"Windows Security | Authentication",,"Endpoint Compromise","Advanced Threat Detection","Privilege Escalation | Persistence | Lateral Movement | Defense Evasion","Command and Control",,,,,
"Splunk Security Essentials","Malicious Command Line Executions","",,"Endpoint Detection and Response | Windows Security",,"Endpoint Compromise","Advanced Threat Detection","Execution | Defense Evasion",Installation,,,,,
"Splunk Security Essentials","Processes with Lookalike (typo) Filenames","",,"Endpoint Detection and Response | Windows Security",,"Endpoint Compromise","Advanced Threat Detection","Defense Evasion",Installation,,,,,
"Splunk Security Essentials","Spike in Password Reset Emails","",,Email,,"Account Compromise | SaaS","Security Monitoring","Initial Access",Delivery,,,,,
"Splunk Security Essentials","Potential Day Trading","",,"Web Proxy",,"Insider Threat","Insider Threat",None,None,,,,,
"Splunk Security Essentials","Emails from Outside the Organization with Company Domains","",,Email,,"Endpoint Compromise | SaaS","Advanced Threat Detection","Initial Access",Delivery,,,,,
"Splunk Security Essentials","Increase in Pages Printed","",,"User Activity Audit",,"Data Exfiltration","Insider Threat",Exfiltration,"Actions on Objectives",,,,,
"Splunk Security Essentials","New Suspicious Executable Launch for User","",,"Endpoint Detection and Response | Windows Security",,"Endpoint Compromise","Advanced Threat Detection","Discovery | Lateral Movement | Execution",Exploitation,,,,,
"Splunk Security Essentials","Basic TOR Traffic Detection","",,"Network Communication",,"Command and Control | Endpoint Compromise","Advanced Threat Detection","Exfiltration | Command and Control","Command and Control",,,,,
"Splunk Security Essentials","Hosts Sending To More Destinations Than Normal","",,"Network Communication",,"Scanning | Endpoint Compromise","Advanced Threat Detection | Security Monitoring",Discovery,Reconnaissance,,,,,
"Splunk User Behavior Analytics","Multiple failed badge attempts and unusual badge access time","This threat is a simple rule to look for unusual badge access time as well as multiple failed badge accesses. UBA has the ability to create simple correlation threat rules based on anomalies. This threat is one such rule.",,"Physical Security",,"Insider Threat","Insider Threat",None,None,,,,,
"Splunk User Behavior Analytics",Malware,"This threat is generated when a device exhibits behavior that could be attributed to malware. Examples of indicators of malware are beaconing, suspicous data movement, and unusual VPN access.",,"Email | Anti-Virus or Anti-Malware | Endpoint Detection and Response | Web Proxy | Network Communication | Windows Security | Host-based IDS | IDS or IPS | Authentication | DLP",,"Adversary Tactics | Endpoint Compromise | Malware","Advanced Threat Detection | Security Monitoring",None,None,,,,,
"Splunk User Behavior Analytics","Exfiltration after Suspicious Internal Activity","This threat is generated when an account (or multiple accounts) exhibit behavior outside of the normal baseline. It further differentiates itself by including data exfiltration associated with that account.",,"Web Server | Email | Network Communication | DNS | Endpoint Detection and Response | Web Proxy | Application Data | Windows Security | Audit Trail | Authentication | DLP",,"Data Exfiltration | Account Compromise","Advanced Threat Detection | Security Monitoring",None,None,,,,,
"Splunk User Behavior Analytics","Exfiltration after Infection","This threat is generated when a device exhibits behavior outside of the normal baseline that indicates a compromise. It further differentiates itself by including data exfiltration associated with that device.",,"Web Server | Email | Network Communication | Endpoint Detection and Response | Web Proxy | Application Data | Physical Security | Windows Security | Authentication | DLP",,"Data Exfiltration | Account Compromise | Malware","Advanced Threat Detection | Security Monitoring",None,None,,,,,
"Splunk User Behavior Analytics","Exfiltration after Account Compromise","This threat is generated when an account (or multiple accounts) exhibit behavior outside of the normal baseline that indicates a compromise. It further differentiates itself by including data exfiltration associated with that account.",,"Web Server | Email | Network Communication | Endpoint Detection and Response | Web Proxy | Application Data | Windows Security | Authentication | DLP",,"Data Exfiltration | Account Compromise","Advanced Threat Detection | Security Monitoring",None,None,,,,,
"Splunk User Behavior Analytics","Malicious URI with Potential Malware","This threat looks detects network communication to malicious domains followed by suspicious activity by the device or user.",,"Email | DLP | Endpoint Detection and Response | Anti-Virus or Anti-Malware | Web Proxy | Windows Security | Host-based IDS | IDS or IPS | Authentication | Network Communication",,"Adversary Tactics | Endpoint Compromise | Malware","Advanced Threat Detection | Security Monitoring",None,None,,,,,
"Splunk User Behavior Analytics","Lateral Movement","This threat is generated when UBA detects activity from a user (or users) that looks like possible lateral movement in the network.",,"Anti-Virus or Anti-Malware | Network Communication | Email | Windows Security | Host-based IDS | IDS or IPS | Authentication | DLP",,"Lateral Movement","Advanced Threat Detection | Security Monitoring",None,None,,,,,
"Splunk User Behavior Analytics","Infection followed by Exfiltration","This threat is generated when a device exhibits behavior outside of the normal baseline that indicates a compromise.",,"Web Server | Email | Network Communication | DNS | Endpoint Detection and Response | Web Proxy | Application Data | Physical Security | Windows Security | Audit Trail | Authentication | DLP",,"Data Exfiltration | Adversary Tactics | Endpoint Compromise | Malware","Advanced Threat Detection | Security Monitoring",None,None,,,,,
"Splunk User Behavior Analytics","Infected Host","This threat looks for a suspicious first step such as a suspicious powershell command or USB insertion.",,"Email | Anti-Virus or Anti-Malware | DNS | Endpoint Detection and Response | Web Proxy | Network Communication | Windows Security | Host-based IDS | IDS or IPS | Authentication | DLP",,"Adversary Tactics | Endpoint Compromise | Malware","Advanced Threat Detection | Security Monitoring",None,None,,,,,
"Splunk User Behavior Analytics","Suspicious New Access","Triggered when a user accesses a box resource for the first time. This anomaly is based on an individual user's baseline. ",,"Audit Trail",,"Account Compromise | Lateral Movement | IAM Analytics","Advanced Threat Detection | Security Monitoring",None,None,,,,,
"Splunk User Behavior Analytics","Data Exfiltration by suspicious user or device","This threat is generated when an account or device exhibits behavior outside of the normal baseline. It further includes data exfiltration activity associated with that account.",,"Anti-Virus or Anti-Malware | Network Communication | Audit Trail | Endpoint Detection and Response | Web Proxy | Email | Application Data | Windows Security | Host-based IDS | IDS or IPS | Authentication | DLP",,"Data Exfiltration | Account Compromise","Advanced Threat Detection | Security Monitoring",None,None,,,,,
"Splunk User Behavior Analytics","Multiple Box logins","Triggered by the total number of  Box logins per user per day based on historical baseline. These are successful logins only.",,"Audit Trail",,"Account Compromise | IAM Analytics","Insider Threat | Security Monitoring | Compliance",None,None,,,,,
"Splunk User Behavior Analytics","Multiple Failed Badge Access Attempts","Triggered when multiple users fail to badge in at a single badge-in access point. This could be used to detect both a physical brute force attack or faulty hardware.",,"Physical Security",,"Insider Threat","Insider Threat | Security Monitoring | Compliance",None,None,,,,,
"Splunk User Behavior Analytics","Multiple External Alarms","Triggered when the number of external alarms from external tools (IDS, IPS, DLP) is higher for a specific user when compared to the enterprise average.",,"Host-based IDS | DLP | IDS or IPS",,"Endpoint Compromise | Network Attack","Advanced Threat Detection | Security Monitoring | Insider Threat",None,None,,,,,
"Splunk User Behavior Analytics","Network Protocol Violation","Triggered when there is more than expected traffic destined for a single device. Most typically this anomaly is seen with DDOS behavior or something similar.",,"Network Communication",,"Network Attack","Security Monitoring",None,None,,,,,
"Splunk User Behavior Analytics","Possible Phishing Attempt","Triggered by external email monitoring tools when a specific user or group is a possible target of a spear phishing campaign.",,Email,,Phishing,"Advanced Threat Detection",None,None,,,,,
"Splunk User Behavior Analytics","Period with Unusual Windows Security Event Sequences","Triggered when Windows events occur outside of the normal baseline for a user. ",,"Windows Security",,"Lateral Movement | Insider Threat | Account Compromise | IAM Analytics","Advanced Threat Detection | Insider Threat | Security Monitoring | Compliance",None,None,,,,,
"Splunk User Behavior Analytics","Scanning Activity","Triggers when a device exhibits either horizontal/vertical scanning patterns or appears to be sending data to a large number of ports per destination device.",,"Network Communication",,"Lateral Movement","Advanced Threat Detection | Security Monitoring",None,None,,,,,
"Splunk User Behavior Analytics","Potential Webshell Activity","Triggered when an internal webserver is accessed from an outside source.",,"Web Server",,"Web Attack","Application Security",None,None,,,,,
"Splunk User Behavior Analytics","Web Site Compromised (Webshell)","This threat is generated when an internal website is accessed from outside the network. ",,"Web Server",,"Web Attack","Application Security",None,None,,,,,
"Splunk User Behavior Analytics","Watering Hole Infection","This threat is generated when there is suspicious activity surrounding a public cloud file share followed by malware activity.",,"Email | Anti-Virus or Anti-Malware | Audit Trail | Endpoint Detection and Response | Web Proxy | Network Communication | Windows Security | Host-based IDS | IDS or IPS | Authentication | DLP",,"Adversary Tactics | Endpoint Compromise | Malware","Advanced Threat Detection",None,None,,,,,
"Splunk User Behavior Analytics","Suspicious External Alarm Activity","This threat is a catch all threat that contains external alarms from third party tools (e.g., IDS, IPS, DLP).",,"Anti-Virus or Anti-Malware | Host-based IDS | DLP | IDS or IPS",,"Adversary Tactics | Endpoint Compromise | Malware | IAM Analytics | Account Compromise | Lateral Movement","Advanced Threat Detection | Security Monitoring | Insider Threat",None,None,,,,,
"Splunk User Behavior Analytics","Suspicious Domain Communication followed by Malware Activity","This threat is generated when a suspicious domain or IP address is visited by a user; after which that user or device starts to display ""malware like"" activity.",,"Email | DLP | Host-based IDS | Endpoint Detection and Response | Anti-Virus or Anti-Malware | Web Proxy | Windows Security | DNS | IDS or IPS | Authentication | Network Communication",,"Adversary Tactics | Endpoint Compromise | Malware | Insider Threat","Advanced Threat Detection | Security Monitoring",None,None,,,,,
"Splunk User Behavior Analytics","Suspicious HTTP Redirects followed by Suspected Infection","This threat is generated when there is suspicious malware activity following strange HTTP redirects.",,"Email | DLP | Endpoint Detection and Response | Anti-Virus or Anti-Malware | Web Proxy | Windows Security | Host-based IDS | IDS or IPS | Authentication | Network Communication",,"Adversary Tactics | Endpoint Compromise | Malware","Advanced Threat Detection | Security Monitoring",None,None,,,,,
"Splunk User Behavior Analytics","Suspicious Behavior","This threat is generated when a user (or group of users) exhibit general suspicious behavior, specifically patterns of behavior that are outside the normal baseline for the user.",,"Web Server | Email | Network Communication | DNS | Host-based IDS | Endpoint Detection and Response | Anti-Virus or Anti-Malware | Web Proxy | Application Data | Windows Security | Audit Trail | IDS or IPS | Authentication | DLP",,"Adversary Tactics | Endpoint Compromise | Malware | IAM Analytics | Account Compromise | Lateral Movement","Advanced Threat Detection | Security Monitoring",None,None,,,,,
"Splunk User Behavior Analytics","Privilege Escalation after Powershell Activity","This threat is a simple rule to look for privilege escalation occurring after a suspicious powershell command. UBA has the ability to create simple correlation threat rules based on anomalies. This threat is one such rule.",,"Windows Security",,"Adversary Tactics | Endpoint Compromise | Malware","Advanced Threat Detection | Security Monitoring",None,None,,,,,
"Splunk User Behavior Analytics","Suspicious Privilege Escalation","Triggered when an account with administrator privledges logs in (event code 4672) and is associated with another user logging in within the same time period.",,"Windows Security",,"Lateral Movement | Endpoint Compromise","Advanced Threat Detection | Security Monitoring",None,None,,,,,
"Splunk User Behavior Analytics","Potential Flight Risk Staging","This threat is generated when a potential flight risk user has staged data but not yet exfiltrated it.",,"Email | DLP | Audit Trail | Anti-Virus or Anti-Malware | Web Proxy | Host-based IDS | IDS or IPS | Network Communication",,"Insider Threat | Data Exfiltration","Insider Threat",None,None,,,,,
"Splunk User Behavior Analytics","Unusual File Extension","Triggered when a user accesses a new file type or extension. This is based on a user's previous history and/or peer group activity.",,"Endpoint Detection and Response",,Malware,"Advanced Threat Detection | Security Monitoring",None,None,,,,,
"Splunk User Behavior Analytics","Unusual External Alarm","This is a catch all anomaly for any external alarm that is created by a third party system (e.g., IDS, IPS, DLP, NGFW). These anomalies are useful for increasing the users risk profile and add context to threats inside of UBA.",,"Anti-Virus or Anti-Malware | Host-based IDS | DLP | IDS or IPS",,"Endpoint Compromise | Network Attack","Advanced Threat Detection | Security Monitoring | Insider Threat",None,None,,,,,
"Splunk User Behavior Analytics","Public facing Website Attack","This threat is generated when a publicly facing website is possibly under attack. Typical indicators in this threat are things like SQL injection.",,"Web Server",,"Web Attack","Application Security",None,None,,,,,
"Splunk User Behavior Analytics","Unusual Cloud Storage Deletions","Triggered on a large number of deletes from a cloud file storage system. This anomaly looks at the enterprise average for a historical baseline.",,"Audit Trail",,"Account Compromise | Ransomware | IAM Analytics","Insider Threat | Security Monitoring",None,None,,,,,
"Splunk User Behavior Analytics","Unusual Printer Usage","This anomaly looks at different aspects of print jobs from a peer group or user baseline, as well as looking at the extensions of the files that are printed.",,"Application Data",,"Insider Threat | Data Exfiltration","Insider Threat",None,None,,,,,
"Splunk User Behavior Analytics","Unusual Time of Badge Access","Triggered by badge access that is outside the normal user's baseline. This can be either failed or successful badge-in attempts outside of the normal baseline.",,"Physical Security",,"Insider Threat","Advanced Threat Detection | Insider Threat",None,None,,,,,
"Splunk User Behavior Analytics","Unusual USB Activity","This anomaly contains a number of detection methods surrounding USB usage in the enterprise.",,"Endpoint Detection and Response",,"Data Exfiltration | Unauthorized Software","Insider Threat | Security Monitoring",None,None,,,,,
"Splunk User Behavior Analytics","Unusual USB Device Plugged In","Triggered when a user uses a USB device (plugging into a computer) for the first time. This anomaly is based on the user's historical information.",,"Endpoint Detection and Response",,"Insider Threat | Data Exfiltration | Malware","Insider Threat | Security Monitoring",None,None,,,,,
"Splunk User Behavior Analytics","Unusual Windows Security Event (Unusual - Event Code, Process, Directory, LoginType, ReturnCode, Domain)","This is a catch all anomaly for unusal Windows Security Events. This can contain things like: rare process, rare resource, or even a rare process name for a given process. This anomaly is based on user baseline and enterprise baseline.",,"Windows Security",,"Malware | Lateral Movement | Endpoint Compromise","Advanced Threat Detection | Security Monitoring | Insider Threat",None,None,,,,,
"Splunk User Behavior Analytics","Suspicious Data Collection","This threat is generated when a user (or group of users) exhibit behavior that indicates the user is involved in data collection.",,"Email | DLP | Audit Trail | Endpoint Detection and Response | Anti-Virus or Anti-Malware | Web Proxy | Application Data | Host-based IDS | IDS or IPS | Network Communication",,"Adversary Tactics | Endpoint Compromise | Malware | Insider Threat","Advanced Threat Detection | Security Monitoring | Insider Threat",None,None,,,,,
"Splunk User Behavior Analytics","Data Exfiltration after Data Staging","This threat combines staging data and data exfiltration.",,"Anti-Virus or Anti-Malware | DLP | Audit Trail | Endpoint Detection and Response | Web Proxy | Application Data | Host-based IDS | IDS or IPS | Network Communication",,"Data Exfiltration | Account Compromise","Advanced Threat Detection | Security Monitoring | Insider Threat",None,None,,,,,
"Splunk User Behavior Analytics","Suspicious URL Communications and Redirects","This threat is generated when there is suspicious malware activity following a blacklisted or malicious domain visit.",,"Email | DLP | Endpoint Detection and Response | Anti-Virus or Anti-Malware | Web Proxy | Windows Security | Host-based IDS | IDS or IPS | Authentication | Network Communication",,"Adversary Tactics | Endpoint Compromise | Malware","Advanced Threat Detection | Security Monitoring",None,None,,,,,
"Splunk User Behavior Analytics","Brute Force","This threat is generated when a single account or multiple accounts have repeated login failures followed by malicious activity such as data movement or scanning activity.",,"Anti-Virus or Anti-Malware | Network Communication | Audit Trail | Endpoint Detection and Response | Web Proxy | Email | Windows Security | Host-based IDS | IDS or IPS | Authentication | DLP",,"Account Compromise | IAM Analytics","Security Monitoring",None,None,,,,,
"Splunk User Behavior Analytics","Multiple Badge Accesses","Triggered by number of badge accesses per user per day based on historical baseline.",,"Physical Security",,"Insider Threat","Insider Threat | Security Monitoring | Compliance",None,None,,,,,
"Splunk User Behavior Analytics","Multiple Box login errors","Triggered by multiple login errors against Box authentication. This is for failed logins only. Similar to the ""Multiple Box Logins"" anomaly.",,"Audit Trail",,"Account Compromise | IAM Analytics","Insider Threat | Security Monitoring | Compliance",None,None,,,,,
"Splunk User Behavior Analytics","Machine Generated Beacon","Triggered by devices that have recurring machine generated traffic. Looking at both web and network traffic.",,"Network Communication",,"Command and Control | Endpoint Compromise","Advanced Threat Detection",None,None,,,,,
"Splunk User Behavior Analytics","Malicious AD Activity","This anomaly contains multiple detection methods that look at Windows Event Logs for malicious activity (e.g., clearning audit logs). Check associated detection methods for an exhastive list of what triggers this anomaly.",,"Windows Security | Authentication",,"Lateral Movement | Insider Threat | Account Compromise | IAM Analytics","Advanced Threat Detection | Insider Threat | Security Monitoring | Compliance",None,None,,,,,
"Splunk User Behavior Analytics","Multiple Authentication Failures","Triggered when a user fails authentication multiple times. This anomaly is only  triggered when the number of authentication failures exceeds the enterprise average.",,"Windows Security | Authentication",,"Lateral Movement | Insider Threat | Account Compromise | IAM Analytics","Advanced Threat Detection | Insider Threat | Security Monitoring | Compliance",None,None,,,,,
"Splunk User Behavior Analytics","Multiple Authentications","Triggered on outliers of number of successes and failures per user authenticating against services or machines.",,"Windows Security | Authentication",,"Lateral Movement | Insider Threat | Account Compromise | IAM Analytics","Advanced Threat Detection | Insider Threat | Security Monitoring | Compliance",None,None,,,,,
"Splunk User Behavior Analytics","Failed Badge Accesses on Multiple Doors","Triggered by multiple failed access attempts at multiple physical locations.",,"Physical Security",,"Insider Threat","Insider Threat | Security Monitoring | Compliance",None,None,,,,,
"Splunk User Behavior Analytics","Flight Risk User","Triggered when a user exhibits behavior that indicates that the user may be a flight risk (risk to leave the company).",,"Email | Web Proxy",,"Insider Threat","Insider Threat",None,None,,,,,
"Splunk User Behavior Analytics","Local Account Creation","Triggered when an account is created on a workstation or endpoint. This is a local Windows account when the machine is joined to a domain.",,"Windows Security",,"Endpoint Compromise | Privilege Escalation","Security Monitoring",None,None,,,,,
"Splunk User Behavior Analytics","Land Speed Violation","Triggered by users logging into VPN session from multiple locations within a short amount of time.",,Authentication,,"Lateral Movement | Account Compromise | Account Sharing","Advanced Threat Detection | Security Monitoring | Security Monitoring",None,None,,,,,
"Splunk User Behavior Analytics","Data Exfiltration after Account Takeover, Medium","This threat is based on the compromised account threat, however looks for data exfiltration after account takeover instead of suspicious behavior.",,"Anti-Virus or Anti-Malware | Network Communication | Audit Trail | Endpoint Detection and Response | Web Proxy | Email | Windows Security | Host-based IDS | IDS or IPS | Authentication | DLP",,"Data Exfiltration | Account Compromise","Advanced Threat Detection | Security Monitoring",None,None,,,,,
"Splunk User Behavior Analytics","Multiple Box operations","Triggered by a high volume of box operations by user. The number of operations  is compared to the enterprise average.",,"Audit Trail",,"Account Compromise","Insider Threat | Security Monitoring | Compliance",None,None,,,,,
"Splunk User Behavior Analytics","Account Compromise with Suspicious Internal Activity","This threat is generated when an account (or multiple accounts) exhibit behavior outside of the normal baseline that indicates a compromise.",,"Web Server | Anti-Virus or Anti-Malware | Network Communication | DNS | Host-based IDS | Endpoint Detection and Response | Web Proxy | Email | Application Data | Physical Security | Windows Security | Audit Trail | IDS or IPS | Authentication | DLP",,"Account Compromise","Advanced Threat Detection | Security Monitoring",None,None,,,,,
"Splunk User Behavior Analytics","Compromised Account","This is a threat that looks for login anomalies such as a land speed violation followed by malicious activity like unusual machine access or unusual access time.",,"Anti-Virus or Anti-Malware | Audit Trail | DLP | Windows Security | Host-based IDS | IDS or IPS | Authentication | Network Communication",,"Account Compromise","Advanced Threat Detection | Security Monitoring",None,None,,,,,
"Splunk User Behavior Analytics","Compromised Web Server","This is a threat rule that looks for potential webshell or external traffic followed up by data movement or unusual data access. Please see the associated anomalies to see what malicious data movement the threat rule is looking for.",,"Web Server | Email | Network Communication | Endpoint Detection and Response | Web Proxy | DLP",,"Endpoint Compromise | Malware","Application Security",None,None,,,,,
"Splunk User Behavior Analytics",Exfiltration,"This threat is created by data exfiltration by excessive data transmissions by a device or user in a traditional network setting or via VPN.",,"Email | Network Communication | Endpoint Detection and Response | Web Proxy | Application Data | DLP",,"Data Exfiltration","Advanced Threat Detection | Security Monitoring",None,None,,,,,
"Splunk User Behavior Analytics","Data Exfiltration after Account Takeover, High","This threat is based on the compromised account threat, however looks for data exfiltration after account takeover instead of suspicious behavior.",,"Anti-Virus or Anti-Malware | Network Communication | Audit Trail | Endpoint Detection and Response | Web Proxy | Email | Host-based IDS | IDS or IPS | Authentication | DLP",,"Data Exfiltration | Account Compromise","Advanced Threat Detection | Security Monitoring",None,None,,,,,
"Splunk User Behavior Analytics","Multiple Logins","Triggered when the number of successful logins by a user is higher than the enterprise average. This anomaly could point to a number of things, including lateral movement, account takeover, or just general suspicious behavior.",,"Windows Security | Authentication",,"Lateral Movement | Insider Threat | Account Compromise | IAM Analytics","Advanced Threat Detection | Insider Threat | Security Monitoring | Compliance",None,None,,,,,
"Splunk User Behavior Analytics","Unusual Network Activity","This anomaly contains a large number of detections for rare or unusual network interaction.",,"Network Communication",,"Lateral Movement | Insider Threat | Account Compromise | Data Exfiltration","Advanced Threat Detection | Insider Threat | Security Monitoring",None,None,,,,,
"Splunk User Behavior Analytics","Unusual Web Browser","Triggered when either a user or device exhibits a rare browser user agent string (e.g., iexplorer.exe instead of iexplore.exe).",,"Web Proxy",,"Endpoint Compromise | Unauthorized Software","Advanced Threat Detection | Security Monitoring",None,None,,,,,
"Splunk User Behavior Analytics","Unusually Long VPN Session","Triggered when a VPN session extends past the normal time period. This time period is determined by both the user's individual baseline as well as the enterprise average.",,"Network Communication",,"Lateral Movement | Account Compromise | Data Exfiltration","Advanced Threat Detection | Security Monitoring | Insider Threat",None,None,,,,,
"Splunk User Behavior Analytics","USB storage attached an unusually high number of times","Triggered when the number of physical USB attach and detach actions exceed the idividual's historical baseline.",,"Endpoint Detection and Response",,"Insider Threat | Data Exfiltration","Insider Threat | Security Monitoring",None,None,,,,,
"Splunk User Behavior Analytics","Suspicious Domain Name","Triggered when a user visits a suspicious domain name that appears to be algorithmically generated. ",,"DNS | Web Proxy",,"Command and Control | Endpoint Compromise | Data Exfiltration","Advanced Threat Detection | Security Monitoring",None,None,,,,,
"Splunk User Behavior Analytics","Suspicious Box Usage","This anomaly contains a number of detection methods surrounding box usage and malicious intent (e.g., file relay through box). Check the associated detection methods for a comprehensive list of what triggers this anomaly.",,"Host-based IDS | Anti-Virus or Anti-Malware | Audit Trail | DLP | IDS or IPS",,"Endpoint Compromise | Threat Intelligence","Advanced Threat Detection",None,None,,,,,
"Splunk User Behavior Analytics","Suspicious Data Movement","This anomaly contains multiple detection methods surrounding suspicious data movement (e.g., sending email to self, external DLP alarms, etc.)",,"Network Communication | Endpoint Detection and Response | Email | DLP | Web Proxy",,"Lateral Movement | Endpoint Compromise | Data Exfiltration","Advanced Threat Detection | Insider Threat",None,None,,,,,
"Splunk User Behavior Analytics","Suspicious Account Lockout","Triggered when an account lockout occurs without any corresponding cause (e.g., password change, password reset, etc.) ",,"Windows Security",,"Lateral Movement | Insider Threat | Account Compromise | IAM Analytics","Advanced Threat Detection | Insider Threat | Security Monitoring | Compliance",None,None,,,,,
"Splunk User Behavior Analytics","Suspicious Network Exploration","Triggered when a user accesses a number of systems and that number increases systematically over time. This is a lead indicator of a possible lateral movement threat.",,"Windows Security | Authentication",,"Lateral Movement | Insider Threat | Account Compromise","Advanced Threat Detection | Insider Threat | Security Monitoring",None,None,,,,,
"Splunk User Behavior Analytics","Unusual Badge Reader Access","Triggered when a badge attempts to access a badge reader that it has historically not accessed. This is based on location and the badge (or user) baseline history.",,"Physical Security",,"Insider Threat","Insider Threat | Security Monitoring | Compliance",None,None,,,,,
"Splunk User Behavior Analytics","Unusual Activity Time","Triggered when a user has an abnormal login time of day or day of week. This is based on the user's rolling baseline.",,"Windows Security | Authentication",,"Insider Threat | Account Compromise | IAM Analytics","Insider Threat | Security Monitoring | Compliance",None,None,,,,,
"Splunk User Behavior Analytics","Suspicious Powershell Activity","Triggered when a possible malicious powershell command is executed. This anomaly contains detection methods that inspect endpoint and Windows event logs looking for suspicious commands (e.g., base64 encoded powershell commands).",,"Windows Security",,"Lateral Movement | Endpoint Compromise","Advanced Threat Detection | Security Monitoring",None,None,,,,,
"Splunk User Behavior Analytics","Suspicious Activity After Intrusion","Threat is generated when a user or device exhibits suspicious behavior after an intrusion.",,"Web Server | Email | Network Communication | DNS | Endpoint Detection and Response | Web Proxy | Application Data | Windows Security | Audit Trail | Authentication | DLP",,"Adversary Tactics | Endpoint Compromise | Malware","Advanced Threat Detection | Security Monitoring",None,None,,,,,
"Splunk User Behavior Analytics","Suspicious Badge Activity","This threat is generated when a user (or a group of users) exhibit suspicious behavior involving badge systems.",,"Physical Security",,"Insider Threat","Insider Threat",None,None,,,,,
"Splunk User Behavior Analytics","Unusual Cloud Storage Downloads","Triggered on a large number of file/directory downloads from a cloud file storage system. This is specifically the number of downloads not the size of the downloads. This anomaly looks at the enterprise afverage for a historical baseline.",,"Audit Trail",,"Lateral Movement | Insider Threat | Account Compromise","Insider Threat | Security Monitoring | Advanced Threat Detection",None,None,,,,,
"Splunk User Behavior Analytics","Remote Account Takeover","This threat is generated when a user (or group of users) exhibit behavior that indicates their account has been compromised or taken over by a remote adversary.",,"Anti-Virus or Anti-Malware | Network Communication | Audit Trail | Email | Physical Security | Windows Security | Host-based IDS | IDS or IPS | Authentication | DLP",,"Account Compromise | IAM Analytics","Advanced Threat Detection | Security Monitoring",None,None,,,,,
"Splunk User Behavior Analytics","Unusual Machine Access","This anomaly contains a large number of detections for rare or unusual machine access.",,"Windows Security",,"Lateral Movement | Insider Threat | Account Compromise | IAM Analytics","Advanced Threat Detection | Insider Threat | Security Monitoring | Compliance",None,None,,,,,
"Splunk User Behavior Analytics","Unusual Geolocation of Communication Destination","Triggered when an organziation, user, device, or peer group generates network traffic destined for a rare or unique Country destination. This anomaly requires destinationCountry (or similar) to be populated.",,"Network Communication",,"Lateral Movement | Account Compromise | Data Exfiltration","Advanced Threat Detection | Security Monitoring | Insider Threat",None,None,,,,,
"Splunk User Behavior Analytics","Excessive Box Downloads","Triggered when a user has a higher than normal number of downloads from a Box data source",,"Audit Trail",,"Account Compromise | Data Exfiltration","Advanced Threat Detection | Security Monitoring | Insider Threat",None,None,,,,,
"Splunk User Behavior Analytics","Suspicious Email - UBA Anomaly","This detection looks for emails that are suspicious because of their sender, domain rareness, or behavior differences. This is an anomaly generated by Splunk User Behavior Analytics (UBA).",,Email,,"Adversary Tactics","Advanced Threat Detection",None,Delivery,,,,,
"Splunk User Behavior Analytics","Excessive Downloads via VPN","This is a subset of the Excessive Data Transmission anomaly that looks only at volume of downloaded data while on VPN.",,"Network Communication",,"Insider Threat | Data Exfiltration | Account Compromise","Advanced Threat Detection | Security Monitoring | Insider Threat",None,None,,,,,
"Splunk User Behavior Analytics","Excessive Data Printed","This is a subset of the Unusual Printer Usage anomaly that looks only at number of print jobs, increased number of print jobs, or volume of data printed. It's based on individual user baseline as well as the enterprise average.",,"DLP | Application Data",,"Insider Threat | Data Exfiltration","Insider Threat",None,None,,,,,
"Splunk User Behavior Analytics","Multiple Login Errors","Triggered when the number of failed logins by a user is higher than the enterprise average. This anomaly could point to a number of things, including a brute force attack, password spraying, or just general suspicious behavior.",,"Windows Security | Authentication",,"Account Compromise | IAM Analytics","Security Monitoring",None,None,,,,,
"Splunk User Behavior Analytics","Data Staging","Triggered when an excessive amount of data is uploaded or stored onto an internal server or cloud storage system. This anomaly is often a pre-cursor to a flight risk threat or data exfiltration threat. ",,"Web Proxy | Network Communication",,"Insider Threat | Account Compromise | Adversary Tactics","Advanced Threat Detection | Security Monitoring | Insider Threat",None,None,,,,,
"Splunk User Behavior Analytics","Suspicious IP Address Communication","Triggered when a user visits a malicious or suspicious site by IP directly.",,"Web Proxy | Network Communication",,"Command and Control | Endpoint Compromise | Data Exfiltration","Advanced Threat Detection | Insider Threat",None,None,,,,,
"Splunk User Behavior Analytics","Unusual VPN Login Geolocation","Triggered when traffic is destined from a rare sourceCountry for an organziation, user, device, or peer group. This anomaly requires sourceCountry (or similar) to be populated.",,"Network Communication",,"Lateral Movement | Account Compromise | Account Sharing","Advanced Threat Detection | Security Monitoring",None,None,,,,,
"Splunk User Behavior Analytics","Potential Phishing Attack","This threat is generated when UBA detects a potential phishing attempt (email inbound or spear phishing) followed up by suspicious activity from the user or device.",,"Email | DLP | Endpoint Detection and Response | Anti-Virus or Anti-Malware | Web Proxy | Windows Security | Host-based IDS | IDS or IPS | Authentication | Network Communication",,Phishing,"Advanced Threat Detection | Security Monitoring",None,None,,,,,
"Splunk User Behavior Analytics","Potential Flight Risk Exfiltration","This threat brings to light users who are possible flight risks.",,"Email | DLP | Audit Trail | Endpoint Detection and Response | Anti-Virus or Anti-Malware | Web Proxy | Application Data | Host-based IDS | IDS or IPS | Network Communication",,"Insider Threat | Data Exfiltration","Insider Threat",None,None,,,,,
"Splunk User Behavior Analytics","Suspicious HTTP Redirects","Triggered by detecting sequences in HTTP requests that signify a possible exploit.",,"Web Proxy",,"Endpoint Compromise | Malware","Advanced Threat Detection | Security Monitoring",None,None,,,,,
"Splunk User Behavior Analytics","Suspicious Network Connection","This anomaly contains multiple detections that inspect network traffic and look for suspicious activity (e.g., DNS data exfiltration). Check the associated detection methods for a comprehensive list of possible triggers for this anomaly.",,"Network Communication",,"Data Exfiltration | Command and Control","Advanced Threat Detection | Security Monitoring",None,None,,,,,
"Splunk User Behavior Analytics","Suspicious Domain Communication","Triggered when a user visits a malicious or suspicious site. This classification is determined by NGFW categories.",,"Web Proxy",,"Command and Control | Endpoint Compromise | Data Exfiltration","Advanced Threat Detection | Security Monitoring | Insider Threat",None,None,,,,,
"Splunk User Behavior Analytics","Failed Access by Disabled Badge","Trigged when acess to a badge panel (door or otherwise) is denied because the badge is disabled. Disabled doe not neceissarly mean terminated.",,"Physical Security",,"Insider Threat","Insider Threat | Security Monitoring",None,None,,,,,
"Splunk User Behavior Analytics","External Website Attack","This anomaly detects malicious incoming traffic on websites (e.g., SQL injection).",,"Web Server",,"Web Attack","Application Security",None,None,,,,,
"Splunk User Behavior Analytics","External Alarm Activity","This is a generic catch all anomaly that can hold alarms generated by 3rd party systems like firewall, IDS/IPS, Enterprise Security, etc.",,"Anti-Virus or Anti-Malware | Host-based IDS | DLP | IDS or IPS",,"Endpoint Compromise | Network Attack","Advanced Threat Detection | Security Monitoring | Insider Threat",None,None,,,,,
"Splunk User Behavior Analytics","Excessive Data Transmission","Triggered when there is more than expected data transfer for a user or device. This anomaly will often be included in a data exfiltration attempt.",,"Network Communication",,"Data Exfiltration | Insider Threat","Insider Threat",None,None,,,,,
"Splunk User Behavior Analytics","Download from Internal Server","Triggered off of accounting information from firewall data (bytes in/out) to determine an unusually high volume of downloaded data per user from UBA defined internal servers.",,"Network Communication",,"Insider Threat | Account Compromise","Insider Threat | Security Monitoring",None,None,,,,,
"Splunk User Behavior Analytics","Brute Force Attack","Triggered off of authentication attempts and/or number of devices a user has access to over time. Identifies possible brute force attacks inside of an environment.",,"Windows Security | Authentication",,"Account Compromise | IAM Analytics","Insider Threat | Security Monitoring",None,None,,,,,
"Splunk User Behavior Analytics","Blacklisted IP Address","Trigerred off of core network traffic, this anomaly compares IP addresses that are visted agains the internal UBA IP Address blacklist. If IPs match, the anomaly is created.",,"Network Communication",,"Endpoint Compromise | Threat Intelligence","Advanced Threat Detection",None,None,,,,,
"Splunk User Behavior Analytics","Blacklisted Domain","Triggered off of DNS and/or HTTP data, this anomaly compares domains that are visted against the internal UBA blacklist. If sites match, the anomaly is created.",,"Web Proxy",,"Endpoint Compromise | Threat Intelligence","Advanced Threat Detection",None,None,,,,,
"Splunk User Behavior Analytics","Blacklisted Application","Triggered when an application is executed on an endpoint or server. Blacklisted applications are pre-defined in UBA and updated on a regular basis.",,"Endpoint Detection and Response | Windows Security",,"Endpoint Compromise | Threat Intelligence | Unauthorized Software | Operations","Advanced Threat Detection | Security Monitoring",None,None,,,,,
"Splunk User Behavior Analytics","Account Compromised followed by Exfiltration","This threat is generated when an account or multiple accounts exhibit behavior outside of the normal baseline that indicates a compromise.",,"Web Server | Email | Network Communication | Endpoint Detection and Response | Web Proxy | Application Data | Physical Security | Windows Security | Audit Trail | Authentication | DLP",,"Account Compromise","Advanced Threat Detection | Security Monitoring",None,None,,,,,
"Splunk User Behavior Analytics","Suspicious Account Activity","This anomaly contains multiple detection methods that look at account events for suspcious activity (e.g., activity by an expired user). Check the associated detection methods for an exhaustive list of what triggers this anomaly.",,"Windows Security | Email | Authentication",,"Account Compromise | IAM Analytics","Advanced Threat Detection | Security Monitoring | Insider Threat",None,None,,,,,
"Splunk User Behavior Analytics","Service Account Login","Triggered when a service account either logs in via VPN or interactively on a device. Does not trigger for normal service account activity.",,"Windows Security | Authentication",,"Account Compromise | Best Practices","Advanced Threat Detection | Security Monitoring",None,None,,,,,
"Splunk User Behavior Analytics","Multiple Outgoing Connections","Triggered when the number of outgoing connections is greater than the user's historical baseline or the enterprise average.",,"Network Communication",,"Lateral Movement | Account Compromise | Data Exfiltration","Advanced Threat Detection | Security Monitoring | Insider Threat",None,None,,,,,
